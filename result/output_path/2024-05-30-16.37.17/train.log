[2024-05-30 16:37:20,069] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-30 16:37:20,716] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-30 16:37:20,716] [INFO] [runner.py:568:main] cmd = /home/chanho/anaconda3/envs/COMEDY/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=12340 --enable_each_rank_log=None training/EPISODE/main.py --model_name gemma --model_name_or_path /home/chanho/Model/SHARE/Refactorizing/result/output_path --train_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json --valid_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json --per_device_train_batch_size 1 --per_device_eval_batch_size 1 --data_output_path /home/chanho/Model/SHARE/Refactorizing/result/output_path/data --max_seq_len 2048 --learning_rate 1e-4 --weight_decay 0.1 --num_train_epochs 50 --num_train_samples 10607 /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json --gradient_accumulation_steps 1 --lr_scheduler_type cosine --num_warmup_steps 1000 --seed 42 --zero_stage 2 --save_interval 1000 --eval_interval 100 --output_dir /home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17
[2024-05-30 16:37:22,066] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-30 16:37:22,859] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-05-30 16:37:22,859] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-05-30 16:37:22,859] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-05-30 16:37:22,859] [INFO] [launch.py:164:main] dist_world_size=2
[2024-05-30 16:37:22,859] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-05-30 16:37:22,859] [INFO] [launch.py:256:main] process 1041098 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=0', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-4', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '10607', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17']
[2024-05-30 16:37:22,860] [INFO] [launch.py:256:main] process 1041099 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-4', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '10607', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17']
[2024-05-30 16:37:25,433] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 16:37:25,433] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.

[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=0.0001, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17', seed=42, local_rank=0, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json', num_train_samples=10607, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json']
[2024-05-30 16:37:25,856] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 16:37:25,856] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=0.0001, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17', seed=42, local_rank=1, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json', num_train_samples=10607, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json']
[2024-05-30 16:37:25,949] [INFO] [comm.py:637:init_distributed] cdb=None
This model is gemma
This model is gemma
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.56it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.34it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.39it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06404829025268555 seconds
[2024-05-30 16:37:30,693] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.2, git-hash=unknown, git-branch=unknown
[2024-05-30 16:37:30,693] [INFO] [comm.py:662:init_distributed] Distributed backend already initialized
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.060613155364990234 seconds
[2024-05-30 16:37:33,876] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-05-30 16:37:33,877] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-05-30 16:37:33,877] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-30 16:37:33,878] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-30 16:37:33,878] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-05-30 16:37:33,878] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-05-30 16:37:33,878] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 500,000,000
[2024-05-30 16:37:33,878] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 500,000,000
[2024-05-30 16:37:33,879] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-05-30 16:37:33,879] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-05-30 16:37:34,246] [INFO] [utils.py:779:see_memory_usage] Before initializing optimizer states
[2024-05-30 16:37:34,246] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-30 16:37:34,246] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 12.73 GB, percent = 10.1%
[2024-05-30 16:37:34,374] [INFO] [utils.py:779:see_memory_usage] After initializing optimizer states
[2024-05-30 16:37:34,375] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-30 16:37:34,375] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 12.76 GB, percent = 10.2%
[2024-05-30 16:37:34,375] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-05-30 16:37:34,509] [INFO] [utils.py:779:see_memory_usage] After initializing ZeRO optimizer
[2024-05-30 16:37:34,509] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-30 16:37:34,510] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 12.77 GB, percent = 10.2%
[2024-05-30 16:37:34,510] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[2024-05-30 16:37:34,510] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-05-30 16:37:34,510] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7fbfb065ae10>
[2024-05-30 16:37:34,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.95)]
[2024-05-30 16:37:34,511] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-30 16:37:34,511] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-30 16:37:34,511] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-30 16:37:34,511] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-30 16:37:34,511] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-30 16:37:34,511] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fbfb0525e90>
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   gradient_clipping ............ 1.0
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-30 16:37:34,512] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   steps_per_print .............. 10
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   train_batch_size ............. 2
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   world_size ................... 2
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='none', nvme_path=None, buffer_count=5, buffer_size=100,000,000, max_in_cpu=1,000,000,000, pin_memory=False) offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='none', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False, ratio=1.0) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=30000000 param_persistence_threshold=10000 model_persistence_threshold=sys.maxsize max_live_parameters=30000000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=False pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-30 16:37:34,513] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-05-30 16:37:34,513] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 2, 
    "train_micro_batch_size_per_gpu": 1, 
    "steps_per_print": 10, 
    "zero_optimization": {
        "stage": 2, 
        "offload_param": {
            "device": "none"
        }, 
        "offload_optimizer": {
            "device": "none"
        }, 
        "stage3_param_persistence_threshold": 1.000000e+04, 
        "stage3_max_live_parameters": 3.000000e+07, 
        "stage3_prefetch_bucket_size": 3.000000e+07, 
        "memory_efficient_linear": false
    }, 
    "bf16": {
        "enabled": true
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": false, 
    "wall_clock_breakdown": false, 
    "hybrid_engine": {
        "enabled": false, 
        "inference_tp_size": 1, 
        "release_inference_cache": false, 
        "pin_parameters": true, 
        "tp_gather_partition_size": 8
    }
}
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240530_163735-mkn39prs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crisp-sound-279
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/mkn39prs
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240530_163735-3v6hmzhk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rosy-silence-280
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/3v6hmzhk
***** Running training *****
***** Evaluating perplexity, Epoch 0/50 *****
Beginning of Epoch 1/50
[2024-05-30 16:37:45,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[1.0000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:37:45,361] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=3.3466405314102317, CurrSamplesPerSec=3.3491895931915927, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:37:51,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[2.0000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:37:51,327] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=3.356212742290554, CurrSamplesPerSec=3.3640619266560927, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:37:57,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[3e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:37:57,319] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=3.3537093801605913, CurrSamplesPerSec=3.3412695346340824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:03,319] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[4.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:03,319] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=3.3508632048992992, CurrSamplesPerSec=3.3475363192140164, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:09,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[5e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:09,327] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=3.3485841555498475, CurrSamplesPerSec=3.327600501087302, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:15,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[6e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:15,352] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=3.345605251635878, CurrSamplesPerSec=3.315533460627732, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:21,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[7.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:21,379] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=3.3431626426707024, CurrSamplesPerSec=3.3200028337502823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:27,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[8.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:27,429] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=3.3399319224216013, CurrSamplesPerSec=3.3112185648478913, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:33,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[9e-06], mom=[(0.9, 0.95)]
[2024-05-30 16:38:33,489] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=3.336854252331114, CurrSamplesPerSec=3.311685240579179, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:38:39,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[1e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:38:39,544] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=3.3344748922391676, CurrSamplesPerSec=3.3033532827548946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 179319.421875, loss: 12.096733093261719
[2024-05-30 16:44:18,939] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[1.1000000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:18,939] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=3.3295781245772424, CurrSamplesPerSec=3.27611406361793, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:25,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[1.2e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:25,044] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=3.325865243173467, CurrSamplesPerSec=3.2809614381991534, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:31,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[1.3000000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:31,163] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=3.3222609559114993, CurrSamplesPerSec=3.2667458240828324, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:37,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[1.4000000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:37,275] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=3.3193394091149386, CurrSamplesPerSec=3.2765670565608227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:43,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[1.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:43,395] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=3.3166277374913933, CurrSamplesPerSec=3.2860728869277995, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:49,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[1.6000000000000003e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:49,508] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=3.314430479205132, CurrSamplesPerSec=3.2840827099783385, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:44:55,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.7000000000000003e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:44:55,614] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=3.3127347920636128, CurrSamplesPerSec=3.2841277099528323, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:45:01,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.8e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:45:01,727] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=3.311068373270475, CurrSamplesPerSec=3.285424238626394, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:45:07,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[1.9e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:45:07,839] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=3.3095517999199795, CurrSamplesPerSec=3.2943449606223143, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:45:13,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[2e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:45:13,950] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=3.3082561194161344, CurrSamplesPerSec=3.284826010427823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 6019.7998046875, loss: 8.702798843383789
[2024-05-30 16:50:53,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[2.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:50:53,171] [INFO] [timer.py:260:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=3.3069968535444723, CurrSamplesPerSec=3.2867256547017574, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:50:59,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[2.2000000000000003e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:50:59,280] [INFO] [timer.py:260:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=3.305970629456428, CurrSamplesPerSec=3.283346171429287, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:05,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[2.3000000000000003e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:05,391] [INFO] [timer.py:260:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=3.3050223244568553, CurrSamplesPerSec=3.2912467734347994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:11,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[2.4e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:11,508] [INFO] [timer.py:260:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=3.3040096375486216, CurrSamplesPerSec=3.289765015327986, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:17,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[2.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:17,620] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=3.3031644425820215, CurrSamplesPerSec=3.281162921321945, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:23,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[2.6000000000000002e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:23,732] [INFO] [timer.py:260:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=3.302447977611076, CurrSamplesPerSec=3.2813913843510725, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:29,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[2.7000000000000002e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:29,843] [INFO] [timer.py:260:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=3.301786993025607, CurrSamplesPerSec=3.296386458759449, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:35,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[2.8000000000000003e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:35,951] [INFO] [timer.py:260:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=3.3012128886427363, CurrSamplesPerSec=3.282929845571027, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:42,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[2.9e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:42,059] [INFO] [timer.py:260:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=3.3006989126520283, CurrSamplesPerSec=3.2951446883195037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:51:48,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[3e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:51:48,166] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=3.300211750958474, CurrSamplesPerSec=3.2769267249006897, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 339.1611328125, loss: 5.826474666595459
[2024-05-30 16:57:27,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[3.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:27,866] [INFO] [timer.py:260:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=3.2995960709640553, CurrSamplesPerSec=3.2840827099783385, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:57:33,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[3.2000000000000005e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:33,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=3.29920925311734, CurrSamplesPerSec=3.286137250923131, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:57:40,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[3.3e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:40,085] [INFO] [timer.py:260:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=3.298787442892153, CurrSamplesPerSec=3.279637655236855, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:57:46,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[3.4000000000000007e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:46,202] [INFO] [timer.py:260:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=3.298252493195369, CurrSamplesPerSec=3.276043694600192, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:57:52,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[3.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:52,318] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=3.2977819153335406, CurrSamplesPerSec=3.2631914718151958, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:57:58,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[3.6e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:57:58,427] [INFO] [timer.py:260:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=3.297431038882165, CurrSamplesPerSec=3.287517821773642, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:58:04,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[3.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:58:04,539] [INFO] [timer.py:260:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=3.2970197026690364, CurrSamplesPerSec=3.2715603915603917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:58:10,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=0, lr=[3.8e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:58:10,654] [INFO] [timer.py:260:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=3.2966112580286984, CurrSamplesPerSec=3.2814080710998454, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:58:16,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=0, lr=[3.9000000000000006e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:58:16,761] [INFO] [timer.py:260:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=3.296311300262519, CurrSamplesPerSec=3.289581824377768, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 16:58:22,872] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[4e-05], mom=[(0.9, 0.95)]
[2024-05-30 16:58:22,872] [INFO] [timer.py:260:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=3.295998743023762, CurrSamplesPerSec=3.2828835936595, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 183.3845672607422, loss: 5.21158504486084
[2024-05-30 17:04:03,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[4.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:03,595] [INFO] [timer.py:260:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=3.2955734064376845, CurrSamplesPerSec=3.280024930762003, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:09,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[4.2e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:09,710] [INFO] [timer.py:260:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=3.2952744216963907, CurrSamplesPerSec=3.275832605683634, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:15,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[4.3e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:15,820] [INFO] [timer.py:260:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=3.2950059604762485, CurrSamplesPerSec=3.275525615815097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:21,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[4.4000000000000006e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:21,922] [INFO] [timer.py:260:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=3.2948577351012727, CurrSamplesPerSec=3.2898398456695346, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:28,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[4.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:28,025] [INFO] [timer.py:260:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=3.294712985178164, CurrSamplesPerSec=3.2875886845856264, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:34,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[4.600000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:34,129] [INFO] [timer.py:260:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=3.2945360842065727, CurrSamplesPerSec=3.2926587823383717, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:40,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[4.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:40,233] [INFO] [timer.py:260:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=3.2943573866903684, CurrSamplesPerSec=3.2824378434365586, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:46,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[4.8e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:46,342] [INFO] [timer.py:260:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=3.2941550619037794, CurrSamplesPerSec=3.290237277631891, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:52,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[4.9e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:52,455] [INFO] [timer.py:260:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=3.2939436281898353, CurrSamplesPerSec=3.2856146881555675, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:04:58,572] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[5e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:04:58,573] [INFO] [timer.py:260:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=3.2936964005645026, CurrSamplesPerSec=3.2681598025220824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 144.64242553710938, loss: 4.974264621734619
[2024-05-30 17:10:39,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[5.1000000000000006e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:10:39,068] [INFO] [timer.py:260:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=3.2934556730046727, CurrSamplesPerSec=3.2816609602974407, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:10:45,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[5.2000000000000004e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:10:45,178] [INFO] [timer.py:260:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=3.293298459704541, CurrSamplesPerSec=3.2675436614714877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:10:51,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[5.300000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:10:51,280] [INFO] [timer.py:260:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=3.293207777704226, CurrSamplesPerSec=3.29777695308753, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:10:57,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[5.4000000000000005e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:10:57,381] [INFO] [timer.py:260:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=3.2931341058429933, CurrSamplesPerSec=3.2875126682337523, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:03,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[5.500000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:03,485] [INFO] [timer.py:260:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=3.2930257383397805, CurrSamplesPerSec=3.2854293856206693, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:09,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[5.6000000000000006e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:09,585] [INFO] [timer.py:260:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=3.2929623019492626, CurrSamplesPerSec=3.2875487433522887, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:15,696] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[5.6999999999999996e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:15,696] [INFO] [timer.py:260:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=3.292819036522481, CurrSamplesPerSec=3.2846896706189983, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:21,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[5.8e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:21,801] [INFO] [timer.py:260:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=3.292728013214284, CurrSamplesPerSec=3.2885991340022698, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:27,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[5.9e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:27,905] [INFO] [timer.py:260:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=3.2926278876441235, CurrSamplesPerSec=3.283461836241186, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:11:34,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[6e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:11:34,005] [INFO] [timer.py:260:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=3.2925720866036423, CurrSamplesPerSec=3.2915851318088554, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 125.72268676757812, loss: 4.834078311920166
[2024-05-30 17:17:14,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=0, lr=[6.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:14,552] [INFO] [timer.py:260:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=3.2923762152058074, CurrSamplesPerSec=3.2865453773278497, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:20,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=0, lr=[6.2e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:20,663] [INFO] [timer.py:260:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=3.2922584695188006, CurrSamplesPerSec=3.2809858201909154, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:26,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=0, lr=[6.3e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:26,769] [INFO] [timer.py:260:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=3.292175587090041, CurrSamplesPerSec=3.278225259653904, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:32,872] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=0, lr=[6.400000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:32,873] [INFO] [timer.py:260:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=3.2921042231232636, CurrSamplesPerSec=3.286943301594765, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:38,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[6.500000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:38,981] [INFO] [timer.py:260:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=3.2920057552946096, CurrSamplesPerSec=3.285383063252748, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:45,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=0, lr=[6.6e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:45,087] [INFO] [timer.py:260:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=3.2919335666622307, CurrSamplesPerSec=3.2762471332962564, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:51,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=0, lr=[6.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:51,198] [INFO] [timer.py:260:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=3.2918333730559715, CurrSamplesPerSec=3.2790235878705247, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:17:57,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=0, lr=[6.800000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:17:57,310] [INFO] [timer.py:260:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=3.291717230379713, CurrSamplesPerSec=3.276961287938391, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:18:03,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=0, lr=[6.9e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:18:03,429] [INFO] [timer.py:260:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=3.2915578493493527, CurrSamplesPerSec=3.2829015803591206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:18:09,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:18:09,539] [INFO] [timer.py:260:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=3.2914545600399694, CurrSamplesPerSec=3.2816750821630727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 112.51367950439453, loss: 4.723073959350586
[2024-05-30 17:23:50,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=0, lr=[7.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:23:50,143] [INFO] [timer.py:260:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=3.291313738778712, CurrSamplesPerSec=3.2849289158914736, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:23:56,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=0, lr=[7.2e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:23:56,249] [INFO] [timer.py:260:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=3.2912518127943318, CurrSamplesPerSec=3.284492898210026, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:02,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=0, lr=[7.3e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:02,348] [INFO] [timer.py:260:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=3.291230245441113, CurrSamplesPerSec=3.283544091732159, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:08,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=0, lr=[7.4e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:08,446] [INFO] [timer.py:260:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=3.291218802257357, CurrSamplesPerSec=3.2862376637906987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:14,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[7.500000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:14,548] [INFO] [timer.py:260:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=3.291196815287734, CurrSamplesPerSec=3.2890981435272826, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:20,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[7.6e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:20,659] [INFO] [timer.py:260:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=3.2911143563094787, CurrSamplesPerSec=3.2811475204646157, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:26,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[7.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:26,762] [INFO] [timer.py:260:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=3.2910939114568754, CurrSamplesPerSec=3.2928526567014194, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:32,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=0, lr=[7.800000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:32,865] [INFO] [timer.py:260:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=3.2910515347466993, CurrSamplesPerSec=3.284433742487422, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:38,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=0, lr=[7.900000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:38,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=3.29100216512106, CurrSamplesPerSec=3.279346617607736, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:24:45,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[8e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:24:45,068] [INFO] [timer.py:260:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=3.291000974967472, CurrSamplesPerSec=3.278431531942068, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 105.55363464355469, loss: 4.659217834472656
[2024-05-30 17:30:25,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=0, lr=[8.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:25,893] [INFO] [timer.py:260:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=3.2909249343503593, CurrSamplesPerSec=3.2859969406561724, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:30:31,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=0, lr=[8.2e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:32,000] [INFO] [timer.py:260:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=3.2908601989427777, CurrSamplesPerSec=3.2882446326864203, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:30:38,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=0, lr=[8.3e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:38,102] [INFO] [timer.py:260:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=3.2908290108055858, CurrSamplesPerSec=3.2939142003040014, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:30:44,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=0, lr=[8.4e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:44,207] [INFO] [timer.py:260:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=3.290778177326236, CurrSamplesPerSec=3.2843784466736334, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:30:50,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[8.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:50,308] [INFO] [timer.py:260:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=3.290742846273649, CurrSamplesPerSec=3.284463320082364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:30:56,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=0, lr=[8.6e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:30:56,407] [INFO] [timer.py:260:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=3.290733221668934, CurrSamplesPerSec=3.2897792070277267, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:31:02,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=0, lr=[8.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:31:02,510] [INFO] [timer.py:260:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=3.290693625757444, CurrSamplesPerSec=3.2866393766337976, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:31:08,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=0, lr=[8.800000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:31:08,612] [INFO] [timer.py:260:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=3.2906783607350887, CurrSamplesPerSec=3.2904011817599153, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:31:14,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=0, lr=[8.900000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:31:14,716] [INFO] [timer.py:260:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=3.2906389848469484, CurrSamplesPerSec=3.2878721663853154, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:31:20,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=0, lr=[9e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:31:20,820] [INFO] [timer.py:260:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=3.2906025366025022, CurrSamplesPerSec=3.2855606394237133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 101.23482513427734, loss: 4.617442607879639
[2024-05-30 17:37:01,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=0, lr=[9.1e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:01,522] [INFO] [timer.py:260:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=3.290488547301912, CurrSamplesPerSec=3.2705489078881653, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:07,633] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=0, lr=[9.200000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:07,634] [INFO] [timer.py:260:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=3.290430965348375, CurrSamplesPerSec=3.2828077947337215, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:13,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=0, lr=[9.300000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:13,741] [INFO] [timer.py:260:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=3.29037721871824, CurrSamplesPerSec=3.2801082967274025, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:19,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=0, lr=[9.4e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:19,845] [INFO] [timer.py:260:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=3.2903391231269166, CurrSamplesPerSec=3.28047515732469, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:25,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=0, lr=[9.5e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:25,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=3.290277341395961, CurrSamplesPerSec=3.2797594704596724, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:32,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=0, lr=[9.6e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:32,060] [INFO] [timer.py:260:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=3.2902474374725506, CurrSamplesPerSec=3.2938676383683423, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:38,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=0, lr=[9.7e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:38,163] [INFO] [timer.py:260:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=3.290222379399487, CurrSamplesPerSec=3.285814169105323, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:44,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=0, lr=[9.8e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:44,267] [INFO] [timer.py:260:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=3.2902009679893776, CurrSamplesPerSec=3.287517821773642, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:50,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=0, lr=[9.900000000000001e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:37:50,371] [INFO] [timer.py:260:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=3.290176801974132, CurrSamplesPerSec=3.2920630846687238, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:37:56,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.0001], mom=[(0.9, 0.95)]
[2024-05-30 17:37:56,474] [INFO] [timer.py:260:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=3.290139733809095, CurrSamplesPerSec=3.28356465624885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 97.70962524414062, loss: 4.581999778747559
saving model ... to step 1000
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-30 17:43:37,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=0, lr=[9.999999964651246e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:43:37,722] [INFO] [timer.py:260:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=3.2901206766791793, CurrSamplesPerSec=3.29156704983098, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:43:43,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=0, lr=[9.999999858604979e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:43:43,819] [INFO] [timer.py:260:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=3.290127421082373, CurrSamplesPerSec=3.2923008210139377, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:43:49,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=0, lr=[9.999999681861206e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:43:49,914] [INFO] [timer.py:260:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=3.2901405329489695, CurrSamplesPerSec=3.29482242123616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:43:56,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=0, lr=[9.999999434419924e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:43:56,019] [INFO] [timer.py:260:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=3.290122296123222, CurrSamplesPerSec=3.2799928680574997, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:02,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=0, lr=[9.999999116281141e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:02,131] [INFO] [timer.py:260:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=3.2900669502034057, CurrSamplesPerSec=3.2724793046680554, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:08,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=0, lr=[9.99999872744486e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:08,233] [INFO] [timer.py:260:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=3.290052986415786, CurrSamplesPerSec=3.287412177435283, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:14,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=0, lr=[9.999998267911084e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:14,330] [INFO] [timer.py:260:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=3.2900581166533907, CurrSamplesPerSec=3.2896811577834457, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:20,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=0, lr=[9.999997737679824e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:20,430] [INFO] [timer.py:260:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=3.290059457739924, CurrSamplesPerSec=3.2907703484950956, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:26,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=0, lr=[9.999997136751084e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:26,529] [INFO] [timer.py:260:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=3.2900590449707594, CurrSamplesPerSec=3.2817495449191143, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:44:32,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=0, lr=[9.999996465124875e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:44:32,628] [INFO] [timer.py:260:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=3.2900543596153593, CurrSamplesPerSec=3.280198080198706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 97.54754638671875, loss: 4.580339431762695
[2024-05-30 17:50:13,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=0, lr=[9.999995722801204e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:13,124] [INFO] [timer.py:260:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=3.2900112041847525, CurrSamplesPerSec=3.2813105202033577, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:19,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=0, lr=[9.999994909780084e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:19,232] [INFO] [timer.py:260:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=3.289974089290301, CurrSamplesPerSec=3.2786865254890802, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:25,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=0, lr=[9.999994026061525e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:25,341] [INFO] [timer.py:260:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=3.289929184681079, CurrSamplesPerSec=3.275675266187899, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:31,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=0, lr=[9.999993071645538e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:31,448] [INFO] [timer.py:260:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=3.289898669079363, CurrSamplesPerSec=3.2716918155520465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:37,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=0, lr=[9.99999204653214e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:37,558] [INFO] [timer.py:260:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=3.2898646666198137, CurrSamplesPerSec=3.278039508689223, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:43,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=0, lr=[9.999990950721343e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:43,667] [INFO] [timer.py:260:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=3.2898366145827396, CurrSamplesPerSec=3.2957622194257508, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:49,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=0, lr=[9.999989784213163e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:49,769] [INFO] [timer.py:260:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=3.2898145255392905, CurrSamplesPerSec=3.286251825073444, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:50:55,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=0, lr=[9.999988547007617e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:50:55,874] [INFO] [timer.py:260:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=3.289794007793315, CurrSamplesPerSec=3.2867617125498727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:51:01,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=0, lr=[9.999987239104722e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:51:01,982] [INFO] [timer.py:260:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=3.2897545323581285, CurrSamplesPerSec=3.2862878725257176, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:51:08,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=0, lr=[9.999985860504497e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:51:08,091] [INFO] [timer.py:260:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=3.289721973592729, CurrSamplesPerSec=3.2897688857794085, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 95.86970520019531, loss: 4.562989234924316
[2024-05-30 17:56:48,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=0, lr=[9.99998441120696e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:56:48,705] [INFO] [timer.py:260:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=3.289684630759393, CurrSamplesPerSec=3.2837574611207496, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:56:54,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=0, lr=[9.999982891212135e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:56:54,812] [INFO] [timer.py:260:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=3.2896585539443155, CurrSamplesPerSec=3.2716458797527177, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:00,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=0, lr=[9.999981300520038e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:00,918] [INFO] [timer.py:260:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=3.2896435167805205, CurrSamplesPerSec=3.286390869604224, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:07,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=0, lr=[9.999979639130698e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:07,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=3.289613667392977, CurrSamplesPerSec=3.283265210909451, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:13,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=0, lr=[9.999977907044134e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:13,127] [INFO] [timer.py:260:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=3.289622445574355, CurrSamplesPerSec=3.283528668513681, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:19,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=0, lr=[9.99997610426037e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:19,239] [INFO] [timer.py:260:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=3.2895835901888, CurrSamplesPerSec=3.288160852633415, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:25,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=0, lr=[9.999974230779434e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:25,350] [INFO] [timer.py:260:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=3.289544093173574, CurrSamplesPerSec=3.284279433240544, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:31,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=0, lr=[9.999972286601352e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:31,458] [INFO] [timer.py:260:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=3.289517309228955, CurrSamplesPerSec=3.285116734984153, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:37,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=0, lr=[9.999970271726151e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:37,562] [INFO] [timer.py:260:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=3.289505757890827, CurrSamplesPerSec=3.2908361876299734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 17:57:43,663] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=0, lr=[9.99996818615386e-05], mom=[(0.9, 0.95)]
[2024-05-30 17:57:43,664] [INFO] [timer.py:260:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=3.2894974872274396, CurrSamplesPerSec=3.2838641562141686, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.86521911621094, loss: 4.531148433685303
[2024-05-30 18:03:24,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=0, lr=[9.999966029884508e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:24,583] [INFO] [timer.py:260:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=3.2894399920461277, CurrSamplesPerSec=3.286671569412975, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:03:30,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=0, lr=[9.999963802918125e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:30,685] [INFO] [timer.py:260:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=3.289431463420333, CurrSamplesPerSec=3.288708722600981, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:03:36,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=0, lr=[9.999961505254743e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:36,790] [INFO] [timer.py:260:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=3.2894089037923564, CurrSamplesPerSec=3.2826048250167386, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:03:42,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=0, lr=[9.999959136894394e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:42,897] [INFO] [timer.py:260:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=3.289386403080736, CurrSamplesPerSec=3.2928371459122006, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:03:49,005] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=0, lr=[9.999956697837114e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:49,005] [INFO] [timer.py:260:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=3.2893583538015165, CurrSamplesPerSec=3.283734323340617, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:03:55,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=0, lr=[9.999954188082934e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:03:55,110] [INFO] [timer.py:260:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=3.2893432249064927, CurrSamplesPerSec=3.283549232837183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:04:01,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=0, lr=[9.999951607631892e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:04:01,221] [INFO] [timer.py:260:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=3.2893023309525176, CurrSamplesPerSec=3.274681690281599, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:04:07,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=0, lr=[9.999948956484022e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:04:07,337] [INFO] [timer.py:260:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=3.2892440218535, CurrSamplesPerSec=3.2705552835055567, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:04:13,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=0, lr=[9.999946234639364e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:04:13,438] [INFO] [timer.py:260:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=3.2892437773626417, CurrSamplesPerSec=3.276947206612797, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:04:19,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=0, lr=[9.999943442097955e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:04:19,548] [INFO] [timer.py:260:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=3.289208857675421, CurrSamplesPerSec=3.2761652429841717, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.51068115234375, loss: 4.5273237228393555
[2024-05-30 18:10:00,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=0, lr=[9.999940578859835e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:00,508] [INFO] [timer.py:260:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=3.289140242842936, CurrSamplesPerSec=3.2846485136554806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:06,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=0, lr=[9.999937644925046e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:06,615] [INFO] [timer.py:260:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=3.2891158618828458, CurrSamplesPerSec=3.2789107988267445, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:12,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=0, lr=[9.999934640293626e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:12,728] [INFO] [timer.py:260:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=3.2890737139666517, CurrSamplesPerSec=3.2739979181879884, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:18,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=0, lr=[9.99993156496562e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:18,840] [INFO] [timer.py:260:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=3.289039940993642, CurrSamplesPerSec=3.271385601252926, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:24,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=0, lr=[9.999928418941071e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:24,951] [INFO] [timer.py:260:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=3.2890118014175114, CurrSamplesPerSec=3.2878863417586173, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:31,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=0, lr=[9.999925202220023e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:31,060] [INFO] [timer.py:260:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=3.288986498259684, CurrSamplesPerSec=3.275030715828129, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:37,169] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=0, lr=[9.999921914802521e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:37,169] [INFO] [timer.py:260:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=3.288956802907033, CurrSamplesPerSec=3.2774273200729827, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:43,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=0, lr=[9.999918556688615e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:43,281] [INFO] [timer.py:260:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=3.2889213730568927, CurrSamplesPerSec=3.2822773002447834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:49,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=0, lr=[9.999915127878348e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:49,396] [INFO] [timer.py:260:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=3.2888825214572055, CurrSamplesPerSec=3.283108441571911, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:10:55,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=0, lr=[9.99991162837177e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:10:55,503] [INFO] [timer.py:260:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=3.288866410283235, CurrSamplesPerSec=3.283826876417584, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.449951171875, loss: 4.526666641235352
[2024-05-30 18:16:36,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=0, lr=[9.999908058168931e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:16:36,489] [INFO] [timer.py:260:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=3.2887876363868647, CurrSamplesPerSec=3.2667229254132857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:16:42,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=0, lr=[9.999904417269881e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:16:42,603] [INFO] [timer.py:260:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=3.288750065465884, CurrSamplesPerSec=3.2709314889341115, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:16:48,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=0, lr=[9.999900705674672e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:16:48,711] [INFO] [timer.py:260:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=3.2887294691490583, CurrSamplesPerSec=3.284283290795003, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:16:54,822] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=0, lr=[9.999896923383357e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:16:54,823] [INFO] [timer.py:260:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=3.2886930068807603, CurrSamplesPerSec=3.283312758667388, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:00,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=0, lr=[9.999893070395989e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:00,931] [INFO] [timer.py:260:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=3.288673374107933, CurrSamplesPerSec=3.284499328308273, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:07,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=0, lr=[9.99988914671262e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:07,049] [INFO] [timer.py:260:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=3.2886190700933837, CurrSamplesPerSec=3.27502304413738, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:13,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=0, lr=[9.99988515233331e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:13,165] [INFO] [timer.py:260:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=3.2885684878313284, CurrSamplesPerSec=3.2776360532588975, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:19,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=0, lr=[9.999881087258112e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:19,282] [INFO] [timer.py:260:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=3.2885236991643683, CurrSamplesPerSec=3.279712025560195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:25,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=0, lr=[9.999876951487085e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:25,398] [INFO] [timer.py:260:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=3.288480302197623, CurrSamplesPerSec=3.276014268452801, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:17:31,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=0, lr=[9.999872745020287e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:17:31,507] [INFO] [timer.py:260:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=3.2884617160421152, CurrSamplesPerSec=3.278872349789828, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.88836669921875, loss: 4.498567581176758
[2024-05-30 18:23:12,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=0, lr=[9.999868467857776e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:12,531] [INFO] [timer.py:260:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=3.2884074324545933, CurrSamplesPerSec=3.279873600299656, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:18,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=0, lr=[9.999864119999616e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:18,641] [INFO] [timer.py:260:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=3.2883827870888913, CurrSamplesPerSec=3.2842820049425097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:24,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=0, lr=[9.999859701445866e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:24,765] [INFO] [timer.py:260:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=3.2883193590384217, CurrSamplesPerSec=3.282033304667834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:30,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=0, lr=[9.999855212196589e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:30,877] [INFO] [timer.py:260:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=3.2882886883698985, CurrSamplesPerSec=3.284582921876603, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:36,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=0, lr=[9.999850652251848e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:36,991] [INFO] [timer.py:260:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=3.288253839992944, CurrSamplesPerSec=3.2857665488712557, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:43,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=0, lr=[9.99984602161171e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:43,107] [INFO] [timer.py:260:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=3.2882111372557223, CurrSamplesPerSec=3.278367469446329, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:49,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=0, lr=[9.999841320276236e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:49,225] [INFO] [timer.py:260:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=3.2881686578608873, CurrSamplesPerSec=3.280750998174755, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:23:55,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=0, lr=[9.999836548245496e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:23:55,349] [INFO] [timer.py:260:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=3.2881352593583277, CurrSamplesPerSec=3.2842755756951467, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:24:01,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=0, lr=[9.999831705519556e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:24:01,464] [INFO] [timer.py:260:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=3.288099803243155, CurrSamplesPerSec=3.2902424397175807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:24:07,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=0, lr=[9.999826792098485e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:24:07,584] [INFO] [timer.py:260:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=3.2880504276785887, CurrSamplesPerSec=3.2811770389015034, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.46324157714844, loss: 4.493826866149902
[2024-05-30 18:29:48,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=0, lr=[9.999821807982353e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:29:48,227] [INFO] [timer.py:260:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=3.287992544755048, CurrSamplesPerSec=3.2860342697408265, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:29:54,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=0, lr=[9.999816753171227e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:29:54,340] [INFO] [timer.py:260:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=3.2879681026987817, CurrSamplesPerSec=3.2815223157074476, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:00,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=0, lr=[9.999811627665183e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:00,451] [INFO] [timer.py:260:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=3.2879451841390717, CurrSamplesPerSec=3.2858952553826724, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:06,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=0, lr=[9.999806431464294e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:06,567] [INFO] [timer.py:260:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=3.287908700955803, CurrSamplesPerSec=3.278189388862076, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:12,685] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=0, lr=[9.999801164568627e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:12,686] [INFO] [timer.py:260:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=3.28786416975346, CurrSamplesPerSec=3.2886042909490354, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:18,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=0, lr=[9.999795826978264e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:18,799] [INFO] [timer.py:260:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=3.2878345023276516, CurrSamplesPerSec=3.2820885215435025, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:24,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=0, lr=[9.999790418693275e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:24,927] [INFO] [timer.py:260:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=3.2877654082053613, CurrSamplesPerSec=3.276477471748875, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:31,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=0, lr=[9.999784939713741e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:31,040] [INFO] [timer.py:260:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=3.287739887879615, CurrSamplesPerSec=3.282128330211077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:37,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=0, lr=[9.999779390039735e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:37,154] [INFO] [timer.py:260:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=3.287714020665744, CurrSamplesPerSec=3.286604609140628, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:30:43,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=0, lr=[9.999773769671339e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:30:43,264] [INFO] [timer.py:260:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=3.2876957183753364, CurrSamplesPerSec=3.287119758397751, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.30767822265625, loss: 4.480825424194336
[2024-05-30 18:36:23,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=0, lr=[9.99976807860863e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:23,978] [INFO] [timer.py:260:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=3.28763830605014, CurrSamplesPerSec=3.277006092961315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:36:30,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=0, lr=[9.99976231685169e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:30,092] [INFO] [timer.py:260:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=3.287605966673846, CurrSamplesPerSec=3.2841238527638392, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:36:36,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=0, lr=[9.9997564844006e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:36,201] [INFO] [timer.py:260:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=3.2875817088259356, CurrSamplesPerSec=3.2797787052694343, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:36:42,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=0, lr=[9.999750581255442e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:42,308] [INFO] [timer.py:260:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=3.2875717785960545, CurrSamplesPerSec=3.275598520698853, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:36:48,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=0, lr=[9.9997446074163e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:48,419] [INFO] [timer.py:260:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=3.287552121949275, CurrSamplesPerSec=3.2849880894526553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:36:54,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=0, lr=[9.999738562883259e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:36:54,523] [INFO] [timer.py:260:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=3.2875505518443946, CurrSamplesPerSec=3.2859827815700595, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:37:00,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=0, lr=[9.999732447656402e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:37:00,633] [INFO] [timer.py:260:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=3.287533624591982, CurrSamplesPerSec=3.2827230068627733, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:37:06,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=0, lr=[9.99972626173582e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:37:06,739] [INFO] [timer.py:260:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=3.2875252605445495, CurrSamplesPerSec=3.2859930790751313, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:37:12,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=0, lr=[9.999720005121596e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:37:12,846] [INFO] [timer.py:260:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=3.287518822184609, CurrSamplesPerSec=3.282707591356789, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:37:18,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=0, lr=[9.99971367781382e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:37:18,965] [INFO] [timer.py:260:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=3.2874782583153968, CurrSamplesPerSec=3.2770329765631776, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.84699249267578, loss: 4.486913681030273
[2024-05-30 18:42:59,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=0, lr=[9.999707279812583e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:42:59,757] [INFO] [timer.py:260:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=3.2874173671216704, CurrSamplesPerSec=3.2668107053899247, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:05,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=0, lr=[9.999700811117974e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:05,871] [INFO] [timer.py:260:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=3.2873904812731554, CurrSamplesPerSec=3.277999799145234, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:11,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=0, lr=[9.999694271730084e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:11,982] [INFO] [timer.py:260:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=3.2873691013307313, CurrSamplesPerSec=3.2844157389947943, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:18,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=0, lr=[9.999687661649006e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:18,091] [INFO] [timer.py:260:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=3.287353718182315, CurrSamplesPerSec=3.2910014425530796, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:24,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=0, lr=[9.999680980874832e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:24,204] [INFO] [timer.py:260:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=3.28733167031532, CurrSamplesPerSec=3.28163528448949, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:30,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=0, lr=[9.999674229407661e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:30,321] [INFO] [timer.py:260:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=3.2873013087158833, CurrSamplesPerSec=3.27573538599955, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:36,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=0, lr=[9.999667407247584e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:36,443] [INFO] [timer.py:260:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=3.2872550687854605, CurrSamplesPerSec=3.2771968480558193, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:42,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=0, lr=[9.999660514394699e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:42,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=3.28722756235009, CurrSamplesPerSec=3.266013225849781, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:48,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=0, lr=[9.999653550849104e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:48,672] [INFO] [timer.py:260:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=3.2871992244390786, CurrSamplesPerSec=3.2765824144490403, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:43:54,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=0, lr=[9.999646516610897e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:43:54,786] [INFO] [timer.py:260:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=3.2871821306486315, CurrSamplesPerSec=3.2799646533960503, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.1559829711914, loss: 4.4791059494018555
saving model ... to step 2000
[2024-05-30 18:49:36,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=0, lr=[9.999639411680176e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:49:36,274] [INFO] [timer.py:260:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=3.28717090757449, CurrSamplesPerSec=3.2902179199548156, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:49:42,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=0, lr=[9.999632236057044e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:49:42,385] [INFO] [timer.py:260:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=3.287153218050451, CurrSamplesPerSec=3.268248933064973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:49:48,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=0, lr=[9.9996249897416e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:49:48,497] [INFO] [timer.py:260:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=3.287134921930575, CurrSamplesPerSec=3.2886120263995093, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:49:54,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=0, lr=[9.999617672733949e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:49:54,608] [INFO] [timer.py:260:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=3.2871181764300426, CurrSamplesPerSec=3.2752110109079893, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:00,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=0, lr=[9.999610285034193e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:00,720] [INFO] [timer.py:260:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=3.2871023946345974, CurrSamplesPerSec=3.2703002781970834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:06,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=0, lr=[9.999602826642435e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:06,834] [INFO] [timer.py:260:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=3.287081716187363, CurrSamplesPerSec=3.284629221683873, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:12,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=0, lr=[9.999595297558784e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:12,939] [INFO] [timer.py:260:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=3.287076199243068, CurrSamplesPerSec=3.284766842705609, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:19,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=0, lr=[9.999587697783343e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:19,044] [INFO] [timer.py:260:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=3.2870715994788946, CurrSamplesPerSec=3.274341685656316, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:25,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=0, lr=[9.999580027316223e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:25,154] [INFO] [timer.py:260:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=3.287053073491867, CurrSamplesPerSec=3.2877201109779866, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:50:31,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=0, lr=[9.999572286157529e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:50:31,263] [INFO] [timer.py:260:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=3.287040498263451, CurrSamplesPerSec=3.284531479177157, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.38900756835938, loss: 4.481745719909668
[2024-05-30 18:56:12,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=0, lr=[9.999564474307373e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:12,152] [INFO] [timer.py:260:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=3.286997386662274, CurrSamplesPerSec=3.284895470908579, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:18,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=0, lr=[9.999556591765864e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:18,268] [INFO] [timer.py:260:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=3.28696815567769, CurrSamplesPerSec=3.2758786591271205, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:24,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=0, lr=[9.999548638533112e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:24,382] [INFO] [timer.py:260:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=3.2869512283559934, CurrSamplesPerSec=3.2826472153523465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:30,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=0, lr=[9.999540614609232e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:30,496] [INFO] [timer.py:260:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=3.286926402482028, CurrSamplesPerSec=3.278604513187141, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:36,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=0, lr=[9.999532519994338e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:36,614] [INFO] [timer.py:260:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=3.2868920319601207, CurrSamplesPerSec=3.271630568106254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:42,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=0, lr=[9.999524354688543e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:42,732] [INFO] [timer.py:260:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=3.2868655229195443, CurrSamplesPerSec=3.2805713756087567, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:48,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=0, lr=[9.999516118691963e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:48,849] [INFO] [timer.py:260:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=3.2868386761065174, CurrSamplesPerSec=3.276130696736565, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:56:54,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=0, lr=[9.999507812004713e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:56:54,963] [INFO] [timer.py:260:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=3.2868158516567254, CurrSamplesPerSec=3.2819768056019614, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:57:01,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=0, lr=[9.99949943462691e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:57:01,076] [INFO] [timer.py:260:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=3.2867960360432558, CurrSamplesPerSec=3.2869368619237846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 18:57:07,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=0, lr=[9.999490986558677e-05], mom=[(0.9, 0.95)]
[2024-05-30 18:57:07,186] [INFO] [timer.py:260:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=3.2867832284661542, CurrSamplesPerSec=3.268819483682416, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 87.20964050292969, loss: 4.468313217163086
[2024-05-30 19:02:48,205] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=0, lr=[9.99948246780013e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:02:48,206] [INFO] [timer.py:260:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=3.2867376715636296, CurrSamplesPerSec=3.267088070228734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:02:54,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=0, lr=[9.999473878351389e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:02:54,319] [INFO] [timer.py:260:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=3.2867161369877973, CurrSamplesPerSec=3.276509465762216, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:00,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=0, lr=[9.999465218212576e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:00,437] [INFO] [timer.py:260:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=3.286686941254017, CurrSamplesPerSec=3.283130285581888, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:06,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=0, lr=[9.999456487383814e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:06,561] [INFO] [timer.py:260:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=3.2866545540552963, CurrSamplesPerSec=3.2779536860434084, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:12,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=0, lr=[9.999447685865226e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:12,687] [INFO] [timer.py:260:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=3.2866107628233636, CurrSamplesPerSec=3.2663972901926015, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:18,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=0, lr=[9.999438813656939e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:18,806] [INFO] [timer.py:260:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=3.286582500463383, CurrSamplesPerSec=3.2831662645849216, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:24,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=0, lr=[9.999429870759074e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:24,915] [INFO] [timer.py:260:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=3.2865714008418583, CurrSamplesPerSec=3.2797299775228885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:31,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=0, lr=[9.99942085717176e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:31,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=3.2865538610907894, CurrSamplesPerSec=3.277095706682908, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:37,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=0, lr=[9.999411772895123e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:37,137] [INFO] [timer.py:260:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=3.2865452366345758, CurrSamplesPerSec=3.2816275818254512, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:03:43,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=0, lr=[9.999402617929294e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:03:43,249] [INFO] [timer.py:260:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=3.286529879955575, CurrSamplesPerSec=3.286653541378939, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.56664276123047, loss: 4.4837541580200195
[2024-05-30 19:09:24,107] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=0, lr=[9.999393392274399e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:24,108] [INFO] [timer.py:260:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=3.286491746506035, CurrSamplesPerSec=3.2746714635486933, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:09:30,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=0, lr=[9.999384095930574e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:30,220] [INFO] [timer.py:260:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=3.2864795425745026, CurrSamplesPerSec=3.2864024571795714, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:09:36,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=0, lr=[9.999374728897944e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:36,339] [INFO] [timer.py:260:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=3.2864532428271738, CurrSamplesPerSec=3.2804636115098855, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:09:42,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=0, lr=[9.999365291176643e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:42,456] [INFO] [timer.py:260:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=3.2864297495960866, CurrSamplesPerSec=3.281984509905491, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:09:48,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=0, lr=[9.999355782766808e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:48,564] [INFO] [timer.py:260:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=3.286418001723292, CurrSamplesPerSec=3.283592932879895, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:09:54,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=0, lr=[9.999346203668572e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:09:54,680] [INFO] [timer.py:260:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=3.2863977106428557, CurrSamplesPerSec=3.2744976188617376, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:10:00,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=0, lr=[9.999336553882068e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:10:00,791] [INFO] [timer.py:260:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=3.286384059114535, CurrSamplesPerSec=3.284302578703225, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:10:06,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=0, lr=[9.999326833407434e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:10:06,905] [INFO] [timer.py:260:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=3.286363556666449, CurrSamplesPerSec=3.2795581596553665, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:10:13,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=0, lr=[9.999317042244806e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:10:13,022] [INFO] [timer.py:260:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=3.286341589354809, CurrSamplesPerSec=3.278831338477666, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:10:19,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=0, lr=[9.999307180394327e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:10:19,142] [INFO] [timer.py:260:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=3.2863139717741503, CurrSamplesPerSec=3.276405807426294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 86.58660125732422, loss: 4.461143493652344
[2024-05-30 19:16:00,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=0, lr=[9.999297247856132e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:00,523] [INFO] [timer.py:260:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=3.286266341477269, CurrSamplesPerSec=3.275736665168455, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:06,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=0, lr=[9.999287244630364e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:06,642] [INFO] [timer.py:260:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=3.2862404211795564, CurrSamplesPerSec=3.266773811781575, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:12,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=0, lr=[9.999277170717162e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:12,763] [INFO] [timer.py:260:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=3.2862074402420807, CurrSamplesPerSec=3.2738471433382936, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:18,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=0, lr=[9.999267026116669e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:18,886] [INFO] [timer.py:260:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=3.2861725196602305, CurrSamplesPerSec=3.2802853031345807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:25,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=0, lr=[9.99925681082903e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:25,002] [INFO] [timer.py:260:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=3.2861513513919265, CurrSamplesPerSec=3.2692169491234786, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:31,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=0, lr=[9.999246524854389e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:31,124] [INFO] [timer.py:260:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=3.2861242050959354, CurrSamplesPerSec=3.2728061537405133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:37,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=0, lr=[9.99923616819289e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:37,250] [INFO] [timer.py:260:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=3.2860846073505643, CurrSamplesPerSec=3.275579334888483, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:43,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=0, lr=[9.999225740844683e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:43,363] [INFO] [timer.py:260:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=3.286069787233889, CurrSamplesPerSec=3.2901533960095857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:49,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=0, lr=[9.99921524280991e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:49,486] [INFO] [timer.py:260:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=3.286038355959177, CurrSamplesPerSec=3.270327051885974, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:16:55,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=0, lr=[9.999204674088723e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:16:55,617] [INFO] [timer.py:260:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=3.2859943075248013, CurrSamplesPerSec=3.2763277480706883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 87.79684448242188, loss: 4.475024223327637
[2024-05-30 19:22:37,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=0, lr=[9.99919403468127e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:22:37,010] [INFO] [timer.py:260:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=3.285954699846238, CurrSamplesPerSec=3.275272392485692, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:22:43,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=0, lr=[9.999183324587704e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:22:43,132] [INFO] [timer.py:260:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=3.2859252805148444, CurrSamplesPerSec=3.2791158755871335, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:22:49,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=0, lr=[9.999172543808173e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:22:49,251] [INFO] [timer.py:260:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=3.2858983810194418, CurrSamplesPerSec=3.2774350030318375, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:22:55,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=0, lr=[9.999161692342832e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:22:55,372] [INFO] [timer.py:260:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=3.285869223195543, CurrSamplesPerSec=3.280009540585612, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:01,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=0, lr=[9.999150770191835e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:01,497] [INFO] [timer.py:260:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=3.285832904708994, CurrSamplesPerSec=3.272702729590493, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:07,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=0, lr=[9.999139777355332e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:07,619] [INFO] [timer.py:260:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=3.2857972282071146, CurrSamplesPerSec=3.2908542615788443, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:13,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=0, lr=[9.999128713833484e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:13,739] [INFO] [timer.py:260:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=3.285769761399409, CurrSamplesPerSec=3.2791748399035865, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:19,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=0, lr=[9.999117579626443e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:19,865] [INFO] [timer.py:260:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=3.28573180433481, CurrSamplesPerSec=3.280667599537267, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:25,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=0, lr=[9.999106374734368e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:25,997] [INFO] [timer.py:260:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=3.2856859159973997, CurrSamplesPerSec=3.2694577684722863, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:23:32,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=0, lr=[9.999095099157418e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:23:32,120] [INFO] [timer.py:260:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=3.2856541806766235, CurrSamplesPerSec=3.280774093931751, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 86.64459228515625, loss: 4.461812973022461
[2024-05-30 19:29:13,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=0, lr=[9.999083752895752e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:13,670] [INFO] [timer.py:260:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=3.285605479573917, CurrSamplesPerSec=3.272058072090837, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:19,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=0, lr=[9.99907233594953e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:19,788] [INFO] [timer.py:260:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=3.285581528067606, CurrSamplesPerSec=3.2764966680819003, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:25,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=0, lr=[9.999060848318917e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:25,912] [INFO] [timer.py:260:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=3.2855499313497374, CurrSamplesPerSec=3.2709761292199278, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:32,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=0, lr=[9.99904929000407e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:32,035] [INFO] [timer.py:260:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=3.2855197474585474, CurrSamplesPerSec=3.2723605826938686, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:38,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=0, lr=[9.999037661005154e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:38,163] [INFO] [timer.py:260:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=3.285478507864305, CurrSamplesPerSec=3.272873829870495, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:44,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=0, lr=[9.999025961322336e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:44,290] [INFO] [timer.py:260:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=3.2854377780830912, CurrSamplesPerSec=3.26287923165308, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:50,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=0, lr=[9.999014190955779e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:50,409] [INFO] [timer.py:260:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=3.2854156939377184, CurrSamplesPerSec=3.2781996375796383, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:29:56,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=0, lr=[9.999002349905651e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:29:56,537] [INFO] [timer.py:260:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=3.285376575400289, CurrSamplesPerSec=3.277630930653904, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:30:02,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=0, lr=[9.998990438172117e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:30:02,658] [INFO] [timer.py:260:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=3.28534765026991, CurrSamplesPerSec=3.2685609282538977, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:30:08,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=0, lr=[9.998978455755347e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:30:08,778] [INFO] [timer.py:260:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=3.2853285352278467, CurrSamplesPerSec=3.266766178725267, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 86.53111267089844, loss: 4.460502624511719
[2024-05-30 19:35:50,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=0, lr=[9.99896640265551e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:35:50,513] [INFO] [timer.py:260:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=3.2852784013116088, CurrSamplesPerSec=3.2680363010910196, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:35:56,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=0, lr=[9.998954278872779e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:35:56,646] [INFO] [timer.py:260:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=3.2852310907665667, CurrSamplesPerSec=3.2646570062447413, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:02,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=0, lr=[9.998942084407321e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:02,771] [INFO] [timer.py:260:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=3.2851983348608105, CurrSamplesPerSec=3.2643521073157746, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:08,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=0, lr=[9.998929819259313e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:08,902] [INFO] [timer.py:260:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=3.2851547512444768, CurrSamplesPerSec=3.2634479088292667, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:15,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=0, lr=[9.998917483428924e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:15,029] [INFO] [timer.py:260:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=3.285120857144581, CurrSamplesPerSec=3.277624527420179, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:21,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=0, lr=[9.998905076916331e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:21,161] [INFO] [timer.py:260:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=3.285074923148323, CurrSamplesPerSec=3.264626513788817, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:27,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=0, lr=[9.998892599721709e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:27,289] [INFO] [timer.py:260:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=3.2850389557511104, CurrSamplesPerSec=3.283261355746191, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:33,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=0, lr=[9.998880051845234e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:33,420] [INFO] [timer.py:260:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=3.284997103573325, CurrSamplesPerSec=3.262484574521251, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:39,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=0, lr=[9.998867433287085e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:39,553] [INFO] [timer.py:260:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=3.2849510060652545, CurrSamplesPerSec=3.264742134032314, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:36:45,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=0, lr=[9.998854744047437e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:36:45,682] [INFO] [timer.py:260:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=3.2849136074680243, CurrSamplesPerSec=3.2677065852681833, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 85.50300598144531, loss: 4.448550224304199
[2024-05-30 19:42:27,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=0, lr=[9.998841984126473e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:27,300] [INFO] [timer.py:260:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=3.2848549432342073, CurrSamplesPerSec=3.2700606094626856, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:42:33,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=0, lr=[9.998829153524372e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:33,433] [INFO] [timer.py:260:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=3.284810134237208, CurrSamplesPerSec=3.272449942517817, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:42:39,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=0, lr=[9.998816252241315e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:39,564] [INFO] [timer.py:260:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=3.284770421690042, CurrSamplesPerSec=3.2736682759344675, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:42:45,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=0, lr=[9.998803280277485e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:45,695] [INFO] [timer.py:260:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=3.2847335079800497, CurrSamplesPerSec=3.2692844768958857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:42:51,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=0, lr=[9.998790237633067e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:51,827] [INFO] [timer.py:260:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=3.2846969767019933, CurrSamplesPerSec=3.2677816884262767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:42:57,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=0, lr=[9.998777124308241e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:42:57,952] [INFO] [timer.py:260:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=3.284665696166319, CurrSamplesPerSec=3.269493448430285, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:43:04,087] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=0, lr=[9.998763940303196e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:43:04,088] [INFO] [timer.py:260:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=3.284617661408077, CurrSamplesPerSec=3.2643559182008897, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:43:10,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=0, lr=[9.998750685618119e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:43:10,220] [INFO] [timer.py:260:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=3.284573585032083, CurrSamplesPerSec=3.268608051072001, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:43:16,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=0, lr=[9.998737360253194e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:43:16,345] [INFO] [timer.py:260:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=3.284545753117846, CurrSamplesPerSec=3.270617765871464, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:43:22,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=0, lr=[9.998723964208611e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:43:22,475] [INFO] [timer.py:260:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=3.284507692798803, CurrSamplesPerSec=3.2750972053202028, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 87.05958557128906, loss: 4.466590881347656
[2024-05-30 19:49:04,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=0, lr=[9.998710497484562e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:04,200] [INFO] [timer.py:260:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=3.2844680129941604, CurrSamplesPerSec=3.2732416283391923, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:10,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=0, lr=[9.998696960081233e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:10,326] [INFO] [timer.py:260:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=3.2844423573686052, CurrSamplesPerSec=3.27269379200784, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:16,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=0, lr=[9.99868335199882e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:16,449] [INFO] [timer.py:260:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=3.284419577105731, CurrSamplesPerSec=3.283594218192878, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:22,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=0, lr=[9.998669673237511e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:22,569] [INFO] [timer.py:260:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=3.2843975168529527, CurrSamplesPerSec=3.2773479316073155, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:28,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=0, lr=[9.998655923797502e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:28,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=3.2843707367973276, CurrSamplesPerSec=3.274178099568705, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:34,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=0, lr=[9.998642103678985e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:34,818] [INFO] [timer.py:260:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=3.284341675123127, CurrSamplesPerSec=3.284231857480619, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:40,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=0, lr=[9.99862821288216e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:40,947] [INFO] [timer.py:260:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=3.2843092524068833, CurrSamplesPerSec=3.269671859902299, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:47,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=0, lr=[9.998614251407219e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:47,075] [INFO] [timer.py:260:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=3.2842784600017976, CurrSamplesPerSec=3.2887590068730397, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:53,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=0, lr=[9.998600219254362e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:53,201] [INFO] [timer.py:260:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=3.2842495542836123, CurrSamplesPerSec=3.268437396505036, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:49:59,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=0, lr=[9.998586116423786e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:49:59,323] [INFO] [timer.py:260:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=3.2842266417555726, CurrSamplesPerSec=3.2765836942795574, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.39058685302734, loss: 4.48176383972168
saving model ... to step 3000
[2024-05-30 19:55:41,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=0, lr=[9.998571942915691e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:55:41,220] [INFO] [timer.py:260:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=3.2841345788834135, CurrSamplesPerSec=3.2784674080333045, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:55:47,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=0, lr=[9.998557698730277e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:55:47,346] [INFO] [timer.py:260:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=3.2841083942773577, CurrSamplesPerSec=3.272930015953792, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:55:53,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=0, lr=[9.998543383867747e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:55:53,469] [INFO] [timer.py:260:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=3.284084729812998, CurrSamplesPerSec=3.2685813055220136, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:55:59,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=0, lr=[9.9985289983283e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:55:59,589] [INFO] [timer.py:260:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=3.284069777739426, CurrSamplesPerSec=3.272872552936476, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:05,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=0, lr=[9.998514542112143e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:05,709] [INFO] [timer.py:260:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=3.284053596478637, CurrSamplesPerSec=3.2695507928514744, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:11,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=0, lr=[9.998500015219477e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:11,832] [INFO] [timer.py:260:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=3.2840315095544708, CurrSamplesPerSec=3.2771123497708374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:17,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=0, lr=[9.998485417650512e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:17,953] [INFO] [timer.py:260:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=3.284013881009887, CurrSamplesPerSec=3.27899923503381, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:24,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=0, lr=[9.998470749405448e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:24,084] [INFO] [timer.py:260:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=3.283980580526636, CurrSamplesPerSec=3.2562070344190452, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:30,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=0, lr=[9.998456010484499e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:30,213] [INFO] [timer.py:260:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=3.2839555325954497, CurrSamplesPerSec=3.275448877338098, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 19:56:36,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=0, lr=[9.99844120088787e-05], mom=[(0.9, 0.95)]
[2024-05-30 19:56:36,334] [INFO] [timer.py:260:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=3.2839371617875535, CurrSamplesPerSec=3.2710628624014912, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.10440063476562, loss: 4.48980712890625
[2024-05-30 20:02:17,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=0, lr=[9.99842632061577e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:17,230] [INFO] [timer.py:260:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=3.2839044675080786, CurrSamplesPerSec=3.268432302612764, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:23,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=0, lr=[9.998411369668412e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:23,353] [INFO] [timer.py:260:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=3.2838830157714476, CurrSamplesPerSec=3.268311327337708, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:29,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=0, lr=[9.998396348046004e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:29,474] [INFO] [timer.py:260:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=3.2838646974662367, CurrSamplesPerSec=3.264846326321636, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:35,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=0, lr=[9.998381255748761e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:35,594] [INFO] [timer.py:260:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=3.283848495663343, CurrSamplesPerSec=3.266771267425509, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:41,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=0, lr=[9.998366092776896e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:41,716] [INFO] [timer.py:260:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=3.283830521789966, CurrSamplesPerSec=3.2709289380974385, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:47,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=0, lr=[9.99835085913062e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:47,839] [INFO] [timer.py:260:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=3.283814798583305, CurrSamplesPerSec=3.2773837839865227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:02:53,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=0, lr=[9.998335554810155e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:02:53,961] [INFO] [timer.py:260:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=3.2837958389707267, CurrSamplesPerSec=3.269495997028513, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:03:00,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=0, lr=[9.998320179815712e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:03:00,087] [INFO] [timer.py:260:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=3.2837707948979955, CurrSamplesPerSec=3.2698209758546604, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:03:06,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=0, lr=[9.99830473414751e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:03:06,212] [INFO] [timer.py:260:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=3.283745927672371, CurrSamplesPerSec=3.283008219840722, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:03:12,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=0, lr=[9.998289217805768e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:03:12,336] [INFO] [timer.py:260:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=3.2837247534372036, CurrSamplesPerSec=3.2715106318339218, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.4569091796875, loss: 4.493755340576172
[2024-05-30 20:08:53,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=0, lr=[9.998273630790704e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:08:53,833] [INFO] [timer.py:260:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=3.283688499124839, CurrSamplesPerSec=3.2753081994685234, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:08:59,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=0, lr=[9.99825797310254e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:08:59,955] [INFO] [timer.py:260:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=3.2836739067669947, CurrSamplesPerSec=3.279927462083964, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:06,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=0, lr=[9.998242244741496e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:06,079] [INFO] [timer.py:260:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=3.2836601901840456, CurrSamplesPerSec=3.268238746471158, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:12,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=0, lr=[9.998226445707795e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:12,204] [INFO] [timer.py:260:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=3.2836358231029075, CurrSamplesPerSec=3.235484381086825, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:18,319] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=0, lr=[9.998210576001661e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:18,320] [INFO] [timer.py:260:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=3.2836274000355123, CurrSamplesPerSec=3.272909584427573, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:24,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=0, lr=[9.998194635623317e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:24,440] [INFO] [timer.py:260:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=3.2836174411865686, CurrSamplesPerSec=3.283969572633378, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:30,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=0, lr=[9.998178624572989e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:30,558] [INFO] [timer.py:260:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=3.283608548242214, CurrSamplesPerSec=3.2805598291166516, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:36,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=0, lr=[9.998162542850905e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:36,676] [INFO] [timer.py:260:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=3.2835959552098863, CurrSamplesPerSec=3.288942106189687, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:42,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=0, lr=[9.998146390457291e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:42,797] [INFO] [timer.py:260:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=3.2835831034743133, CurrSamplesPerSec=3.279267136134451, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:09:48,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=0, lr=[9.998130167392375e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:09:48,925] [INFO] [timer.py:260:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=3.2835566623703394, CurrSamplesPerSec=3.2671236984836316, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 93.62489318847656, loss: 4.539294242858887
[2024-05-30 20:15:30,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=0, lr=[9.998113873656385e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:15:30,307] [INFO] [timer.py:260:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=3.283529847707177, CurrSamplesPerSec=3.273967250991818, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:15:36,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=0, lr=[9.998097509249556e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:15:36,424] [INFO] [timer.py:260:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=3.283520282954793, CurrSamplesPerSec=3.2739570287207633, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:15:42,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=0, lr=[9.998081074172114e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:15:42,542] [INFO] [timer.py:260:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=3.2835081492459994, CurrSamplesPerSec=3.2803584200517513, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:15:48,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=0, lr=[9.998064568424294e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:15:48,669] [INFO] [timer.py:260:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=3.2834875271633637, CurrSamplesPerSec=3.2802121894767877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:15:54,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=0, lr=[9.998047992006331e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:15:54,792] [INFO] [timer.py:260:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=3.283467268065996, CurrSamplesPerSec=3.2780779381962186, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:16:00,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=0, lr=[9.998031344918456e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:16:00,913] [INFO] [timer.py:260:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=3.2834546435980045, CurrSamplesPerSec=3.275650963060614, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:16:07,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=0, lr=[9.998014627160907e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:16:07,034] [INFO] [timer.py:260:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=3.2834402564580025, CurrSamplesPerSec=3.2742739488090242, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:16:13,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=0, lr=[9.99799783873392e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:16:13,161] [INFO] [timer.py:260:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=3.2834190581054727, CurrSamplesPerSec=3.276696323280396, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:16:19,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=0, lr=[9.99798097963773e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:16:19,286] [INFO] [timer.py:260:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=3.2834031648804087, CurrSamplesPerSec=3.270100126888465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:16:25,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=0, lr=[9.997964049872579e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:16:25,411] [INFO] [timer.py:260:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=3.2833864111333577, CurrSamplesPerSec=3.269887253977139, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.25027465820312, loss: 4.502584934234619
[2024-05-30 20:22:06,670] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=0, lr=[9.997947049438705e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:06,670] [INFO] [timer.py:260:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=3.283345022439512, CurrSamplesPerSec=3.2683406152668915, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:12,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=0, lr=[9.997929978336347e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:12,800] [INFO] [timer.py:260:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=3.2833212674498413, CurrSamplesPerSec=3.2651729232934597, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:18,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=0, lr=[9.997912836565746e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:18,924] [INFO] [timer.py:260:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=3.283301303833879, CurrSamplesPerSec=3.279835128679626, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:25,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=0, lr=[9.997895624127147e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:25,053] [INFO] [timer.py:260:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=3.283278921593967, CurrSamplesPerSec=3.27111260850763, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:31,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=0, lr=[9.997878341020792e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:31,175] [INFO] [timer.py:260:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=3.2832647837998503, CurrSamplesPerSec=3.2790466593126695, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:37,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=0, lr=[9.997860987246926e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:37,298] [INFO] [timer.py:260:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=3.2832469630680334, CurrSamplesPerSec=3.28146583423305, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:43,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=0, lr=[9.997843562805793e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:43,420] [INFO] [timer.py:260:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=3.2832308841933155, CurrSamplesPerSec=3.2766566462717255, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:49,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=0, lr=[9.99782606769764e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:49,546] [INFO] [timer.py:260:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=3.2832090514528467, CurrSamplesPerSec=3.277030416201139, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:22:55,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=0, lr=[9.997808501922716e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:22:55,666] [INFO] [timer.py:260:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=3.283197375136979, CurrSamplesPerSec=3.281580082862889, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:23:01,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=0, lr=[9.997790865481267e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:23:01,789] [INFO] [timer.py:260:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=3.2831805305528854, CurrSamplesPerSec=3.273930195562952, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.47038269042969, loss: 4.5160136222839355
[2024-05-30 20:28:43,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=0, lr=[9.997773158373543e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:28:43,341] [INFO] [timer.py:260:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=3.2831518254903473, CurrSamplesPerSec=3.2816455547644567, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:28:49,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=0, lr=[9.997755380599794e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:28:49,457] [INFO] [timer.py:260:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=3.2831456360251168, CurrSamplesPerSec=3.2766233695214866, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:28:55,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=0, lr=[9.997737532160273e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:28:55,581] [INFO] [timer.py:260:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=3.2831302422403104, CurrSamplesPerSec=3.276030900558111, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:01,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=0, lr=[9.997719613055232e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:01,715] [INFO] [timer.py:260:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=3.283103739115318, CurrSamplesPerSec=3.258781231122446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:07,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=0, lr=[9.997701623284923e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:07,843] [INFO] [timer.py:260:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=3.2830863881664785, CurrSamplesPerSec=3.2715068042253512, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:13,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=0, lr=[9.9976835628496e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:13,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=3.2830668749781866, CurrSamplesPerSec=3.2683584429590447, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:20,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=0, lr=[9.997665431749521e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:20,092] [INFO] [timer.py:260:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=3.28305155833362, CurrSamplesPerSec=3.2908929921378154, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:26,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=0, lr=[9.997647229984941e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:26,213] [INFO] [timer.py:260:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=3.2830389916466913, CurrSamplesPerSec=3.281325922590886, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:32,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=0, lr=[9.997628957556118e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:32,334] [INFO] [timer.py:260:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=3.2830277989525674, CurrSamplesPerSec=3.280331481860941, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:29:38,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=0, lr=[9.997610614463307e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:29:38,449] [INFO] [timer.py:260:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=3.2830220426221826, CurrSamplesPerSec=3.28647327191558, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.95018005371094, loss: 4.53206205368042
[2024-05-30 20:35:19,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=0, lr=[9.997592200706772e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:19,544] [INFO] [timer.py:260:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=3.283009861521275, CurrSamplesPerSec=3.2761690815011018, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:25,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=0, lr=[9.99757371628677e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:25,655] [INFO] [timer.py:260:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=3.2830084787293896, CurrSamplesPerSec=3.2834746883899926, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:31,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=0, lr=[9.997555161203565e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:31,774] [INFO] [timer.py:260:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=3.2829997262927235, CurrSamplesPerSec=3.282417293031551, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:37,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=0, lr=[9.997536535457417e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:37,889] [INFO] [timer.py:260:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=3.2829954695255426, CurrSamplesPerSec=3.2723363287265963, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:44,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=0, lr=[9.997517839048591e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:44,007] [INFO] [timer.py:260:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=3.2829877218155965, CurrSamplesPerSec=3.2872047735468946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:50,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=0, lr=[9.997499071977351e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:50,124] [INFO] [timer.py:260:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=3.2829835478641627, CurrSamplesPerSec=3.279164585087528, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:35:56,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=0, lr=[9.997480234243963e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:35:56,238] [INFO] [timer.py:260:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=3.2829810338981056, CurrSamplesPerSec=3.277960090563301, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:36:02,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=0, lr=[9.997461325848691e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:36:02,354] [INFO] [timer.py:260:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=3.2829755681561825, CurrSamplesPerSec=3.2779126977087145, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:36:08,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=0, lr=[9.997442346791803e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:36:08,473] [INFO] [timer.py:260:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=3.282967971770852, CurrSamplesPerSec=3.27449634066034, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:36:14,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=0, lr=[9.99742329707357e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:36:14,592] [INFO] [timer.py:260:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=3.282961511274508, CurrSamplesPerSec=3.2810333019516977, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.25492095947266, loss: 4.502636909484863
[2024-05-30 20:41:55,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=0, lr=[9.997404176694258e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:41:55,969] [INFO] [timer.py:260:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=3.2829478563392094, CurrSamplesPerSec=3.278428969394168, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:02,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=0, lr=[9.99738498565414e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:02,084] [INFO] [timer.py:260:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=3.282947039707948, CurrSamplesPerSec=3.2856185488473164, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:08,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=0, lr=[9.997365723953486e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:08,205] [INFO] [timer.py:260:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=3.282937546767684, CurrSamplesPerSec=3.273001528304456, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:14,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=0, lr=[9.997346391592568e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:14,321] [INFO] [timer.py:260:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=3.282931650057161, CurrSamplesPerSec=3.2761102252299223, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:20,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=0, lr=[9.997326988571661e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:20,434] [INFO] [timer.py:260:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=3.2829286097976706, CurrSamplesPerSec=3.294038371901706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:26,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=0, lr=[9.997307514891038e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:26,554] [INFO] [timer.py:260:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=3.282918289650441, CurrSamplesPerSec=3.2886300759254676, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:32,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=0, lr=[9.997287970550974e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:32,668] [INFO] [timer.py:260:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=3.282916135709524, CurrSamplesPerSec=3.2819883620708206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:38,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=0, lr=[9.997268355551747e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:38,780] [INFO] [timer.py:260:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=3.2829165715798054, CurrSamplesPerSec=3.2749182012991755, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:44,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=0, lr=[9.997248669893633e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:44,892] [INFO] [timer.py:260:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=3.2829166870056157, CurrSamplesPerSec=3.286078035954641, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:42:51,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=0, lr=[9.99722891357691e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:42:51,009] [INFO] [timer.py:260:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=3.2829083157813934, CurrSamplesPerSec=3.2731075255727133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.6275634765625, loss: 4.495661735534668
[2024-05-30 20:48:32,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=0, lr=[9.997209086601859e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:48:32,425] [INFO] [timer.py:260:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=3.2828933494762436, CurrSamplesPerSec=3.2653661164578405, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:48:38,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=0, lr=[9.997189188968759e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:48:38,538] [INFO] [timer.py:260:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=3.282893200427754, CurrSamplesPerSec=3.2807060906892267, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:48:44,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=0, lr=[9.997169220677891e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:48:44,662] [INFO] [timer.py:260:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=3.282881549057592, CurrSamplesPerSec=3.269130313802852, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:48:50,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=0, lr=[9.99714918172954e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:48:50,782] [INFO] [timer.py:260:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=3.282873238977447, CurrSamplesPerSec=3.2665346596340794, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:48:56,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=0, lr=[9.997129072123986e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:48:56,909] [INFO] [timer.py:260:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=3.2828558724520103, CurrSamplesPerSec=3.2767667203379967, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:49:03,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=0, lr=[9.997108891861513e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:49:03,033] [INFO] [timer.py:260:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=3.2828449471653656, CurrSamplesPerSec=3.2626723737254895, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:49:09,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=0, lr=[9.99708864094241e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:49:09,161] [INFO] [timer.py:260:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=3.282828785795242, CurrSamplesPerSec=3.2675296609657836, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:49:15,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=0, lr=[9.997068319366961e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:49:15,285] [INFO] [timer.py:260:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=3.2828164500690313, CurrSamplesPerSec=3.284411881129195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:49:21,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=0, lr=[9.997047927135454e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:49:21,409] [INFO] [timer.py:260:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=3.2828049970156705, CurrSamplesPerSec=3.272964494732735, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:49:27,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=0, lr=[9.997027464248178e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:49:27,525] [INFO] [timer.py:260:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=3.2828022828682832, CurrSamplesPerSec=3.2696820554316717, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 93.56769561767578, loss: 4.538683891296387
[2024-05-30 20:55:08,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=0, lr=[9.997006930705419e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:08,529] [INFO] [timer.py:260:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=3.282787228848017, CurrSamplesPerSec=3.2821886871296897, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:14,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=0, lr=[9.996986326507472e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:14,651] [INFO] [timer.py:260:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=3.282777990537845, CurrSamplesPerSec=3.2761665224888157, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:20,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=0, lr=[9.996965651654626e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:20,773] [INFO] [timer.py:260:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=3.2827688464132607, CurrSamplesPerSec=3.269481979787429, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:26,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=0, lr=[9.996944906147171e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:26,886] [INFO] [timer.py:260:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=3.282767770259875, CurrSamplesPerSec=3.27269889919195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:32,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=0, lr=[9.996924089985405e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:32,999] [INFO] [timer.py:260:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=3.28276955361478, CurrSamplesPerSec=3.296228433921658, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:39,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=0, lr=[9.99690320316962e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:39,114] [INFO] [timer.py:260:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=3.282767163338807, CurrSamplesPerSec=3.2827551229652543, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:45,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=0, lr=[9.99688224570011e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:45,223] [INFO] [timer.py:260:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=3.2827705253198523, CurrSamplesPerSec=3.2755294528333345, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:51,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=0, lr=[9.996861217577175e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:51,337] [INFO] [timer.py:260:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=3.2827681633479324, CurrSamplesPerSec=3.2760539299058067, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:55:57,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=0, lr=[9.996840118801109e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:55:57,456] [INFO] [timer.py:260:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=3.282760307664782, CurrSamplesPerSec=3.276444198637804, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 20:56:03,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=0, lr=[9.996818949372211e-05], mom=[(0.9, 0.95)]
[2024-05-30 20:56:03,571] [INFO] [timer.py:260:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=3.282757667217224, CurrSamplesPerSec=3.2882923247772586, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.13128662109375, loss: 4.490108966827393
saving model ... to step 4000
[2024-05-30 21:01:46,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=0, lr=[9.99679770929078e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:01:46,756] [INFO] [timer.py:260:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=3.2822577874664876, CurrSamplesPerSec=3.27050555434911, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:01:52,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=0, lr=[9.996776398557118e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:01:52,870] [INFO] [timer.py:260:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=3.282257323025879, CurrSamplesPerSec=3.263470761608057, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:01:58,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=0, lr=[9.996755017171526e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:01:58,980] [INFO] [timer.py:260:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=3.282261947909165, CurrSamplesPerSec=3.284455604136673, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:05,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=0, lr=[9.996733565134304e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:05,091] [INFO] [timer.py:260:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=3.2822694924732563, CurrSamplesPerSec=3.2822297824721756, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:11,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=0, lr=[9.99671204244576e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:11,202] [INFO] [timer.py:260:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=3.2822739569252457, CurrSamplesPerSec=3.277560496458944, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:17,319] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=0, lr=[9.996690449106192e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:17,320] [INFO] [timer.py:260:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=3.2822710703144473, CurrSamplesPerSec=3.2775886697736643, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:23,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=0, lr=[9.99666878511591e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:23,436] [INFO] [timer.py:260:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=3.282265659027243, CurrSamplesPerSec=3.26590514455683, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:29,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=0, lr=[9.996647050475218e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:29,546] [INFO] [timer.py:260:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=3.282272329089318, CurrSamplesPerSec=3.286398594645376, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:35,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=0, lr=[9.996625245184426e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:35,663] [INFO] [timer.py:260:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=3.282269350780212, CurrSamplesPerSec=3.276981770082559, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:02:41,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=0, lr=[9.99660336924384e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:02:41,780] [INFO] [timer.py:260:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=3.282267176756092, CurrSamplesPerSec=3.2776142822982584, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.01355743408203, loss: 4.511007308959961
[2024-05-30 21:08:22,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=0, lr=[9.99658142265377e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:22,991] [INFO] [timer.py:260:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=3.2822541701884256, CurrSamplesPerSec=3.2850060992205137, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:29,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=0, lr=[9.996559405414525e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:29,114] [INFO] [timer.py:260:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=3.2822467815052043, CurrSamplesPerSec=3.273342531950627, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:35,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=0, lr=[9.996537317526419e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:35,230] [INFO] [timer.py:260:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=3.282242716443626, CurrSamplesPerSec=3.2739059183229826, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:41,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=0, lr=[9.996515158989763e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:41,342] [INFO] [timer.py:260:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=3.2822426467027084, CurrSamplesPerSec=3.2693277980677755, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:47,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=0, lr=[9.996492929804868e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:47,461] [INFO] [timer.py:260:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=3.282237978072071, CurrSamplesPerSec=3.2717517892314594, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:53,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=0, lr=[9.996470629972053e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:53,575] [INFO] [timer.py:260:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=3.2822377285676043, CurrSamplesPerSec=3.2710411786748876, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:08:59,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=0, lr=[9.996448259491629e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:08:59,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=3.2822331477658615, CurrSamplesPerSec=3.280164731478462, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:09:05,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=0, lr=[9.996425818363915e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:09:05,808] [INFO] [timer.py:260:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=3.2822311663103334, CurrSamplesPerSec=3.2708422120177194, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:09:11,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=0, lr=[9.996403306589228e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:09:11,927] [INFO] [timer.py:260:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=3.282226944745844, CurrSamplesPerSec=3.285749817765343, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:09:18,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=0, lr=[9.996380724167885e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:09:18,046] [INFO] [timer.py:260:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=3.282220152494449, CurrSamplesPerSec=3.284769415170948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 96.94459533691406, loss: 4.5741376876831055
[2024-05-30 21:14:59,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=0, lr=[9.996358071100205e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:14:59,565] [INFO] [timer.py:260:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=3.282214450641988, CurrSamplesPerSec=3.273778149309836, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:05,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=0, lr=[9.996335347386509e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:05,678] [INFO] [timer.py:260:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=3.2822185951423997, CurrSamplesPerSec=3.2796556063854037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:11,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=0, lr=[9.99631255302712e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:11,791] [INFO] [timer.py:260:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=3.2822210558222134, CurrSamplesPerSec=3.2762765636271394, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:17,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=0, lr=[9.99628968802236e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:17,904] [INFO] [timer.py:260:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=3.2822216388363095, CurrSamplesPerSec=3.280055711548064, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:24,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=0, lr=[9.996266752372549e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:24,020] [INFO] [timer.py:260:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=3.28221779320116, CurrSamplesPerSec=3.277568180042197, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:30,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=0, lr=[9.996243746078015e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:30,138] [INFO] [timer.py:260:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=3.282213827804685, CurrSamplesPerSec=3.279126130098539, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:36,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=0, lr=[9.996220669139081e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:36,252] [INFO] [timer.py:260:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=3.282213372315565, CurrSamplesPerSec=3.2731471166748674, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:42,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=0, lr=[9.996197521556074e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:42,373] [INFO] [timer.py:260:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=3.2822080233904067, CurrSamplesPerSec=3.281387533586995, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:48,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=0, lr=[9.996174303329322e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:48,491] [INFO] [timer.py:260:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=3.282205161561551, CurrSamplesPerSec=3.272684854474003, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:15:54,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=0, lr=[9.996151014459153e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:15:54,611] [INFO] [timer.py:260:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=3.282199978266524, CurrSamplesPerSec=3.2736146195245173, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.48258972167969, loss: 4.527019023895264
[2024-05-30 21:21:35,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=0, lr=[9.996127654945895e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:21:35,947] [INFO] [timer.py:260:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=3.282178184813862, CurrSamplesPerSec=3.2770867450901955, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:21:42,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=0, lr=[9.99610422478988e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:21:42,068] [INFO] [timer.py:260:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=3.282169049013457, CurrSamplesPerSec=3.2702097608764213, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:21:48,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=0, lr=[9.996080723991438e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:21:48,191] [INFO] [timer.py:260:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=3.282158830033806, CurrSamplesPerSec=3.2756970113969435, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:21:54,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=0, lr=[9.996057152550902e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:21:54,315] [INFO] [timer.py:260:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=3.282144905747718, CurrSamplesPerSec=3.272815091936888, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:00,441] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=0, lr=[9.996033510468605e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:00,442] [INFO] [timer.py:260:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=3.2821315172971626, CurrSamplesPerSec=3.269804406743853, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:06,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=0, lr=[9.996009797744883e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:06,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=3.2821304703911536, CurrSamplesPerSec=3.277852497950514, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:12,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=0, lr=[9.995986014380068e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:12,680] [INFO] [timer.py:260:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=3.2821224926750023, CurrSamplesPerSec=3.2799851731016916, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:18,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=0, lr=[9.995962160374498e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:18,794] [INFO] [timer.py:260:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=3.2821204612657806, CurrSamplesPerSec=3.2790120522712, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:24,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=0, lr=[9.99593823572851e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:24,914] [INFO] [timer.py:260:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=3.2821134145779083, CurrSamplesPerSec=3.2771507575420182, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:22:31,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=0, lr=[9.995914240442443e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:22:31,037] [INFO] [timer.py:260:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=3.2821028360029234, CurrSamplesPerSec=3.282902865130921, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.29960632324219, loss: 4.503131866455078
[2024-05-30 21:28:12,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=0, lr=[9.995890174516638e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:12,599] [INFO] [timer.py:260:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=3.282092154589148, CurrSamplesPerSec=3.2819357165940137, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:18,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=0, lr=[9.99586603795143e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:18,719] [INFO] [timer.py:260:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=3.2820843139576477, CurrSamplesPerSec=3.273771761120963, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:24,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=0, lr=[9.995841830747165e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:24,837] [INFO] [timer.py:260:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=3.282080529939664, CurrSamplesPerSec=3.280271193227521, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:30,957] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=0, lr=[9.995817552904183e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:30,958] [INFO] [timer.py:260:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=3.2820716499251343, CurrSamplesPerSec=3.2726503815864727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:37,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=0, lr=[9.995793204422829e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:37,077] [INFO] [timer.py:260:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=3.2820664716965298, CurrSamplesPerSec=3.2855567788680533, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:43,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=0, lr=[9.995768785303445e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:43,195] [INFO] [timer.py:260:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=3.2820619913216342, CurrSamplesPerSec=3.2800454512218535, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:49,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=0, lr=[9.995744295546379e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:49,312] [INFO] [timer.py:260:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=3.2820575798725704, CurrSamplesPerSec=3.2703665757517633, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:28:55,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=0, lr=[9.995719735151973e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:28:55,439] [INFO] [timer.py:260:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=3.2820457782990986, CurrSamplesPerSec=3.2777948619561483, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:29:01,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=0, lr=[9.995695104120579e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:29:01,556] [INFO] [timer.py:260:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=3.2820415448497036, CurrSamplesPerSec=3.273227578962648, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:29:07,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=0, lr=[9.995670402452543e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:29:07,677] [INFO] [timer.py:260:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=3.282035189697385, CurrSamplesPerSec=3.260576086643879, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.69877624511719, loss: 4.518507480621338
[2024-05-30 21:34:49,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=0, lr=[9.995645630148216e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:34:49,351] [INFO] [timer.py:260:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=3.282023166127974, CurrSamplesPerSec=3.268638617950804, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:34:55,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=0, lr=[9.995620787207946e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:34:55,468] [INFO] [timer.py:260:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=3.2820215716692664, CurrSamplesPerSec=3.2791120301618917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:01,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=0, lr=[9.995595873632084e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:01,592] [INFO] [timer.py:260:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=3.2820100028779464, CurrSamplesPerSec=3.2815544083204924, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:07,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=0, lr=[9.995570889420984e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:07,717] [INFO] [timer.py:260:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=3.28199755676819, CurrSamplesPerSec=3.274644618678721, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:13,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=0, lr=[9.995545834575e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:13,836] [INFO] [timer.py:260:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=3.281993077061214, CurrSamplesPerSec=3.2757699239106453, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:19,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=0, lr=[9.995520709094483e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:19,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=3.28198814486863, CurrSamplesPerSec=3.276453156716613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:26,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=0, lr=[9.995495512979791e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:26,072] [INFO] [timer.py:260:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=3.281983488397317, CurrSamplesPerSec=3.2813952351241875, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:32,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=0, lr=[9.99547024623128e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:32,179] [INFO] [timer.py:260:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=3.281991342218034, CurrSamplesPerSec=3.2752736712930264, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:38,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=0, lr=[9.995444908849305e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:38,288] [INFO] [timer.py:260:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=3.281995221488736, CurrSamplesPerSec=3.27732104283767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:35:44,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=0, lr=[9.995419500834228e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:35:44,396] [INFO] [timer.py:260:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=3.2820021454906865, CurrSamplesPerSec=3.2914960154125645, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.24617004394531, loss: 4.513559341430664
[2024-05-30 21:41:25,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=0, lr=[9.995394022186404e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:25,849] [INFO] [timer.py:260:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=3.2819948099537264, CurrSamplesPerSec=3.281180889171558, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:41:31,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=0, lr=[9.995368472906197e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:31,974] [INFO] [timer.py:260:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=3.2819850123492365, CurrSamplesPerSec=3.2732441827842487, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:41:38,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=0, lr=[9.995342852993968e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:38,094] [INFO] [timer.py:260:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=3.2819808555729133, CurrSamplesPerSec=3.2781202116946315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:41:44,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=0, lr=[9.995317162450075e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:44,215] [INFO] [timer.py:260:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=3.281976131740134, CurrSamplesPerSec=3.2805316047003465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:41:50,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=0, lr=[9.995291401274886e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:50,336] [INFO] [timer.py:260:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=3.2819705362129805, CurrSamplesPerSec=3.2726095257712977, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:41:56,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=0, lr=[9.995265569468764e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:41:56,458] [INFO] [timer.py:260:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=3.281963343832525, CurrSamplesPerSec=3.2852363843714287, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:42:02,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=0, lr=[9.995239667032073e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:42:02,577] [INFO] [timer.py:260:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=3.281956769025626, CurrSamplesPerSec=3.2755511961064845, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:42:08,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=0, lr=[9.995213693965179e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:42:08,694] [INFO] [timer.py:260:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=3.2819525570998906, CurrSamplesPerSec=3.277199408677933, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:42:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=0, lr=[9.995187650268451e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:42:14,804] [INFO] [timer.py:260:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=3.281956001862364, CurrSamplesPerSec=3.277573302451047, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:42:20,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=0, lr=[9.995161535942256e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:42:20,920] [INFO] [timer.py:260:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=3.2819554464923892, CurrSamplesPerSec=3.277006092961315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.61363220214844, loss: 4.528434753417969
[2024-05-30 21:48:02,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=0, lr=[9.995135350986966e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:02,392] [INFO] [timer.py:260:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=3.281943201973723, CurrSamplesPerSec=3.2777423509258914, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:08,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=0, lr=[9.995109095402947e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:08,512] [INFO] [timer.py:260:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=3.2819377122893982, CurrSamplesPerSec=3.27490541604642, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:14,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=0, lr=[9.995082769190573e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:14,633] [INFO] [timer.py:260:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=3.2819301919151274, CurrSamplesPerSec=3.2709518957707258, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:20,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=0, lr=[9.995056372350214e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:20,755] [INFO] [timer.py:260:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=3.2819244252646484, CurrSamplesPerSec=3.281028168722115, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:26,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=0, lr=[9.995029904882247e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:26,876] [INFO] [timer.py:260:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=3.281916448362809, CurrSamplesPerSec=3.2848928982457952, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:32,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=0, lr=[9.995003366787042e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:32,998] [INFO] [timer.py:260:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=3.28190922042914, CurrSamplesPerSec=3.2712848182517287, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:39,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=0, lr=[9.994976758064976e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:39,110] [INFO] [timer.py:260:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=3.2819100766113527, CurrSamplesPerSec=3.293683990235885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:45,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=0, lr=[9.994950078716426e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:45,229] [INFO] [timer.py:260:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=3.2819030986804436, CurrSamplesPerSec=3.274155096586039, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:51,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=0, lr=[9.994923328741769e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:51,344] [INFO] [timer.py:260:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=3.2819011343575677, CurrSamplesPerSec=3.274776290589175, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:48:57,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=0, lr=[9.994896508141383e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:48:57,471] [INFO] [timer.py:260:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=3.2818919338043555, CurrSamplesPerSec=3.2800236482417877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.67889404296875, loss: 4.529139518737793
[2024-05-30 21:54:38,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=0, lr=[9.994869616915645e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:54:38,915] [INFO] [timer.py:260:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=3.281883196450069, CurrSamplesPerSec=3.2806483542999856, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:54:45,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=0, lr=[9.99484265506494e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:54:45,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=3.2818852868503545, CurrSamplesPerSec=3.27878648352967, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:54:51,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=0, lr=[9.994815622589646e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:54:51,142] [INFO] [timer.py:260:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=3.2818841514724846, CurrSamplesPerSec=3.293565017870261, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:54:57,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=0, lr=[9.994788519490145e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:54:57,259] [INFO] [timer.py:260:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=3.281879568022001, CurrSamplesPerSec=3.28766341595138, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:03,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=0, lr=[9.99476134576682e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:03,377] [INFO] [timer.py:260:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=3.2818773367778054, CurrSamplesPerSec=3.2896114947667283, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:09,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=0, lr=[9.994734101420059e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:09,491] [INFO] [timer.py:260:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=3.2818798385580426, CurrSamplesPerSec=3.277020174792994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:15,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=0, lr=[9.994706786450243e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:15,612] [INFO] [timer.py:260:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=3.2818735973252156, CurrSamplesPerSec=3.274075866564148, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:21,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=0, lr=[9.994679400857758e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:21,731] [INFO] [timer.py:260:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=3.2818679144521985, CurrSamplesPerSec=3.277735947256814, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:27,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=0, lr=[9.994651944642994e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:27,844] [INFO] [timer.py:260:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=3.281870224445715, CurrSamplesPerSec=3.283672624187655, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 21:55:33,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=0, lr=[9.99462441780634e-05], mom=[(0.9, 0.95)]
[2024-05-30 21:55:33,961] [INFO] [timer.py:260:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=3.2818678382001605, CurrSamplesPerSec=3.282033304667834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.23249816894531, loss: 4.524311065673828
[2024-05-30 22:01:15,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=0, lr=[9.99459682034818e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:15,430] [INFO] [timer.py:260:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=3.2818614340065624, CurrSamplesPerSec=3.2674507512683437, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:21,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=0, lr=[9.99456915226891e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:21,542] [INFO] [timer.py:260:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=3.2818649124252226, CurrSamplesPerSec=3.2818342825107107, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=0, lr=[9.994541413568918e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:27,660] [INFO] [timer.py:260:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=3.281862841478119, CurrSamplesPerSec=3.283067324224017, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:33,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=0, lr=[9.994513604248597e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:33,782] [INFO] [timer.py:260:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=3.281856794707972, CurrSamplesPerSec=3.2765056264476238, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:39,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=0, lr=[9.994485724308341e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:39,893] [INFO] [timer.py:260:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=3.2818613455525663, CurrSamplesPerSec=3.281383682831956, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:46,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=0, lr=[9.994457773748542e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:46,009] [INFO] [timer.py:260:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=3.281860676698487, CurrSamplesPerSec=3.2751419593830624, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:52,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=0, lr=[9.994429752569597e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:52,133] [INFO] [timer.py:260:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=3.28185168655264, CurrSamplesPerSec=3.2815415711999485, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:01:58,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=0, lr=[9.994401660771902e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:01:58,250] [INFO] [timer.py:260:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=3.2818491259928595, CurrSamplesPerSec=3.2916613366127225, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:02:04,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=0, lr=[9.994373498355854e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:02:04,367] [INFO] [timer.py:260:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=3.281846275567499, CurrSamplesPerSec=3.2822195085400776, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:02:10,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=0, lr=[9.99434526532185e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:02:10,496] [INFO] [timer.py:260:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=3.2818334021490303, CurrSamplesPerSec=3.263125464848868, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.54022216796875, loss: 4.505792617797852
saving model ... to step 5000
[2024-05-30 22:07:52,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=0, lr=[9.994316961670291e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:07:52,390] [INFO] [timer.py:260:stop] epoch=0/micro_step=5010/global_step=5010, RunningAvgSamplesPerSec=3.281838171754526, CurrSamplesPerSec=3.2697037211427076, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:07:58,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=0, lr=[9.994288587401577e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:07:58,505] [INFO] [timer.py:260:stop] epoch=0/micro_step=5020/global_step=5020, RunningAvgSamplesPerSec=3.2818395702479073, CurrSamplesPerSec=3.2836996172817807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:04,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=0, lr=[9.994260142516108e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:04,623] [INFO] [timer.py:260:stop] epoch=0/micro_step=5030/global_step=5030, RunningAvgSamplesPerSec=3.2818376008810164, CurrSamplesPerSec=3.2868467091794256, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:10,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=0, lr=[9.994231627014287e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:10,741] [INFO] [timer.py:260:stop] epoch=0/micro_step=5040/global_step=5040, RunningAvgSamplesPerSec=3.2818337542060236, CurrSamplesPerSec=3.26744947856252, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:16,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=0, lr=[9.99420304089652e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:16,857] [INFO] [timer.py:260:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=3.2818322871715226, CurrSamplesPerSec=3.2863561073684573, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:22,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=0, lr=[9.994174384163206e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:22,968] [INFO] [timer.py:260:stop] epoch=0/micro_step=5060/global_step=5060, RunningAvgSamplesPerSec=3.2818323317312106, CurrSamplesPerSec=3.283549232837183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:29,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=0, lr=[9.994145656814752e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:29,075] [INFO] [timer.py:260:stop] epoch=0/micro_step=5070/global_step=5070, RunningAvgSamplesPerSec=3.281838740825111, CurrSamplesPerSec=3.277536165349639, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:35,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=0, lr=[9.994116858851565e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:35,187] [INFO] [timer.py:260:stop] epoch=0/micro_step=5080/global_step=5080, RunningAvgSamplesPerSec=3.281839449615579, CurrSamplesPerSec=3.2787493189310206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:41,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=0, lr=[9.994087990274052e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:41,303] [INFO] [timer.py:260:stop] epoch=0/micro_step=5090/global_step=5090, RunningAvgSamplesPerSec=3.281836078205279, CurrSamplesPerSec=3.2850575567882547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:08:47,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=0, lr=[9.994059051082621e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:08:47,422] [INFO] [timer.py:260:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=3.281831989661422, CurrSamplesPerSec=3.2781573620327165, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.15827941894531, loss: 4.523506164550781
[2024-05-30 22:14:29,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=0, lr=[9.994030041277682e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:29,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=5110/global_step=5110, RunningAvgSamplesPerSec=3.2818239906945617, CurrSamplesPerSec=3.2773005564521767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:14:35,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=0, lr=[9.994000960859644e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:35,142] [INFO] [timer.py:260:stop] epoch=0/micro_step=5120/global_step=5120, RunningAvgSamplesPerSec=3.2818250406054656, CurrSamplesPerSec=3.284055710585575, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:14:41,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=0, lr=[9.99397180982892e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:41,251] [INFO] [timer.py:260:stop] epoch=0/micro_step=5130/global_step=5130, RunningAvgSamplesPerSec=3.2818312664655664, CurrSamplesPerSec=3.2738381995038863, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:14:47,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=0, lr=[9.993942588185919e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:47,366] [INFO] [timer.py:260:stop] epoch=0/micro_step=5140/global_step=5140, RunningAvgSamplesPerSec=3.2818300061446015, CurrSamplesPerSec=3.279615857677803, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:14:53,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=0, lr=[9.993913295931056e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:53,488] [INFO] [timer.py:260:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=3.281823871388599, CurrSamplesPerSec=3.272704006392, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:14:59,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=0, lr=[9.993883933064747e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:14:59,599] [INFO] [timer.py:260:stop] epoch=0/micro_step=5160/global_step=5160, RunningAvgSamplesPerSec=3.2818269144568357, CurrSamplesPerSec=3.2683291547103503, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:15:05,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=0, lr=[9.993854499587405e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:15:05,715] [INFO] [timer.py:260:stop] epoch=0/micro_step=5170/global_step=5170, RunningAvgSamplesPerSec=3.281826277059751, CurrSamplesPerSec=3.274910530135543, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:15:11,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=0, lr=[9.993824995499445e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:15:11,831] [INFO] [timer.py:260:stop] epoch=0/micro_step=5180/global_step=5180, RunningAvgSamplesPerSec=3.281826206974494, CurrSamplesPerSec=3.2733910700809234, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:15:17,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=0, lr=[9.993795420801287e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:15:17,947] [INFO] [timer.py:260:stop] epoch=0/micro_step=5190/global_step=5190, RunningAvgSamplesPerSec=3.281826471258353, CurrSamplesPerSec=3.2780664092495106, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:15:24,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=0, lr=[9.993765775493348e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:15:24,064] [INFO] [timer.py:260:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=3.2818258374047584, CurrSamplesPerSec=3.280579073315315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.51811981201172, loss: 4.527402877807617
[2024-05-30 22:21:05,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=0, lr=[9.993736059576046e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:05,684] [INFO] [timer.py:260:stop] epoch=0/micro_step=5210/global_step=5210, RunningAvgSamplesPerSec=3.281820355512288, CurrSamplesPerSec=3.268685743009054, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:11,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=0, lr=[9.993706273049803e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:11,800] [INFO] [timer.py:260:stop] epoch=0/micro_step=5220/global_step=5220, RunningAvgSamplesPerSec=3.2818183478048524, CurrSamplesPerSec=3.275005143665405, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:17,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=0, lr=[9.99367641591504e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:17,916] [INFO] [timer.py:260:stop] epoch=0/micro_step=5230/global_step=5230, RunningAvgSamplesPerSec=3.281816886349975, CurrSamplesPerSec=3.2765107455357456, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:24,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=0, lr=[9.993646488172177e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:24,025] [INFO] [timer.py:260:stop] epoch=0/micro_step=5240/global_step=5240, RunningAvgSamplesPerSec=3.2818209713490774, CurrSamplesPerSec=3.2858682261788883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:30,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=0, lr=[9.99361648982164e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:30,140] [INFO] [timer.py:260:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=3.2818235586949376, CurrSamplesPerSec=3.2849507841331302, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:36,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=0, lr=[9.993586420863851e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:36,256] [INFO] [timer.py:260:stop] epoch=0/micro_step=5260/global_step=5260, RunningAvgSamplesPerSec=3.2818207040518326, CurrSamplesPerSec=3.272873829870495, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:42,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=0, lr=[9.993556281299236e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:42,378] [INFO] [timer.py:260:stop] epoch=0/micro_step=5270/global_step=5270, RunningAvgSamplesPerSec=3.2818157306170015, CurrSamplesPerSec=3.279320978001839, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:48,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=0, lr=[9.993526071128223e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:48,497] [INFO] [timer.py:260:stop] epoch=0/micro_step=5280/global_step=5280, RunningAvgSamplesPerSec=3.281812658377391, CurrSamplesPerSec=3.2843771607466286, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:21:54,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=0, lr=[9.993495790351237e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:21:54,608] [INFO] [timer.py:260:stop] epoch=0/micro_step=5290/global_step=5290, RunningAvgSamplesPerSec=3.281813692559466, CurrSamplesPerSec=3.2707146820193524, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:22:00,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=0, lr=[9.993465438968706e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:22:00,720] [INFO] [timer.py:260:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=3.2818151512964624, CurrSamplesPerSec=3.277952405142433, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.39952850341797, loss: 4.5152387619018555
Beginning of Epoch 2/50
[2024-05-30 22:27:42,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=0, lr=[9.993435016981058e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:27:42,321] [INFO] [timer.py:260:stop] epoch=1/micro_step=6/global_step=5310, RunningAvgSamplesPerSec=3.2818070854485915, CurrSamplesPerSec=3.2793581555611935, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:27:48,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=0, lr=[9.993404524388726e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:27:48,426] [INFO] [timer.py:260:stop] epoch=1/micro_step=16/global_step=5320, RunningAvgSamplesPerSec=3.2818124760229805, CurrSamplesPerSec=3.2824956428302547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:27:54,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=0, lr=[9.993373961192141e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:27:54,535] [INFO] [timer.py:260:stop] epoch=1/micro_step=26/global_step=5330, RunningAvgSamplesPerSec=3.281813977987684, CurrSamplesPerSec=3.2661302160169727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:00,648] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=0, lr=[9.993343327391733e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:00,649] [INFO] [timer.py:260:stop] epoch=1/micro_step=36/global_step=5340, RunningAvgSamplesPerSec=3.2818121372887434, CurrSamplesPerSec=3.276944646384782, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:06,760] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=0, lr=[9.993312622987935e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:06,760] [INFO] [timer.py:260:stop] epoch=1/micro_step=46/global_step=5350, RunningAvgSamplesPerSec=3.2818113588424573, CurrSamplesPerSec=3.279981325637327, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:12,870] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=0, lr=[9.993281847981186e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:12,871] [INFO] [timer.py:260:stop] epoch=1/micro_step=56/global_step=5360, RunningAvgSamplesPerSec=3.2818127722896353, CurrSamplesPerSec=3.2774811015414143, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:18,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=0, lr=[9.993251002371914e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:18,986] [INFO] [timer.py:260:stop] epoch=1/micro_step=66/global_step=5370, RunningAvgSamplesPerSec=3.2818097432032576, CurrSamplesPerSec=3.2839515742290337, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:25,099] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=0, lr=[9.993220086160562e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:25,100] [INFO] [timer.py:260:stop] epoch=1/micro_step=76/global_step=5380, RunningAvgSamplesPerSec=3.281807468568043, CurrSamplesPerSec=3.268520174479882, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:31,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=0, lr=[9.993189099347562e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:31,214] [INFO] [timer.py:260:stop] epoch=1/micro_step=86/global_step=5390, RunningAvgSamplesPerSec=3.2818060216248535, CurrSamplesPerSec=3.272398879163687, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:28:37,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=0, lr=[9.993158041933354e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:28:37,321] [INFO] [timer.py:260:stop] epoch=1/micro_step=96/global_step=5400, RunningAvgSamplesPerSec=3.2818083697080067, CurrSamplesPerSec=3.2850408329019127, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.62010192871094, loss: 4.506674766540527
[2024-05-30 22:34:18,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=0, lr=[9.993126913918377e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:18,843] [INFO] [timer.py:260:stop] epoch=1/micro_step=106/global_step=5410, RunningAvgSamplesPerSec=3.2818021708909435, CurrSamplesPerSec=3.277385064443145, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:24,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=0, lr=[9.993095715303072e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:24,956] [INFO] [timer.py:260:stop] epoch=1/micro_step=116/global_step=5420, RunningAvgSamplesPerSec=3.28180204792778, CurrSamplesPerSec=3.2735775720774862, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:31,064] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=0, lr=[9.993064446087879e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:31,065] [INFO] [timer.py:260:stop] epoch=1/micro_step=126/global_step=5430, RunningAvgSamplesPerSec=3.281802241191644, CurrSamplesPerSec=3.2774798210097487, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:37,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=0, lr=[9.993033106273239e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:37,172] [INFO] [timer.py:260:stop] epoch=1/micro_step=136/global_step=5440, RunningAvgSamplesPerSec=3.2818057960465428, CurrSamplesPerSec=3.298404549801198, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:43,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=0, lr=[9.993001695859599e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:43,282] [INFO] [timer.py:260:stop] epoch=1/micro_step=146/global_step=5450, RunningAvgSamplesPerSec=3.2818066375829864, CurrSamplesPerSec=3.2794158465463465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:49,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=0, lr=[9.9929702148474e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:49,399] [INFO] [timer.py:260:stop] epoch=1/micro_step=156/global_step=5460, RunningAvgSamplesPerSec=3.2818012376039336, CurrSamplesPerSec=3.2738931409728784, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:34:55,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=0, lr=[9.992938663237088e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:34:55,504] [INFO] [timer.py:260:stop] epoch=1/micro_step=166/global_step=5470, RunningAvgSamplesPerSec=3.2818072987078084, CurrSamplesPerSec=3.2847526942182674, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:35:01,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=0, lr=[9.99290704102911e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:35:01,617] [INFO] [timer.py:260:stop] epoch=1/micro_step=176/global_step=5480, RunningAvgSamplesPerSec=3.28180544811033, CurrSamplesPerSec=3.2674596602368697, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:35:07,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=0, lr=[9.99287534822391e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:35:07,734] [INFO] [timer.py:260:stop] epoch=1/micro_step=186/global_step=5490, RunningAvgSamplesPerSec=3.2818019008773844, CurrSamplesPerSec=3.2765619372967434, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:35:13,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=0, lr=[9.992843584821938e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:35:13,849] [INFO] [timer.py:260:stop] epoch=1/micro_step=196/global_step=5500, RunningAvgSamplesPerSec=3.2817983934109005, CurrSamplesPerSec=3.2742611685860767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 94.13241577148438, loss: 4.544701099395752
[2024-05-30 22:40:55,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=0, lr=[9.992811750823645e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:40:55,424] [INFO] [timer.py:260:stop] epoch=1/micro_step=206/global_step=5510, RunningAvgSamplesPerSec=3.2817929779591988, CurrSamplesPerSec=3.277281350698384, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:01,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=0, lr=[9.99277984622948e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:01,533] [INFO] [timer.py:260:stop] epoch=1/micro_step=216/global_step=5520, RunningAvgSamplesPerSec=3.281795196919243, CurrSamplesPerSec=3.280848515805246, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:07,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=0, lr=[9.992747871039892e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:07,641] [INFO] [timer.py:260:stop] epoch=1/micro_step=226/global_step=5530, RunningAvgSamplesPerSec=3.2817991973821234, CurrSamplesPerSec=3.2783110965210525, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:13,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=0, lr=[9.992715825255336e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:13,741] [INFO] [timer.py:260:stop] epoch=1/micro_step=236/global_step=5540, RunningAvgSamplesPerSec=3.281808675628326, CurrSamplesPerSec=3.2717377526413234, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:19,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=0, lr=[9.992683708876262e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:19,847] [INFO] [timer.py:260:stop] epoch=1/micro_step=246/global_step=5550, RunningAvgSamplesPerSec=3.2818138750433272, CurrSamplesPerSec=3.2873967178577197, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:25,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=0, lr=[9.992651521903129e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:25,953] [INFO] [timer.py:260:stop] epoch=1/micro_step=256/global_step=5560, RunningAvgSamplesPerSec=3.281819189054772, CurrSamplesPerSec=3.2843668733668427, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:32,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=0, lr=[9.992619264336387e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:32,056] [INFO] [timer.py:260:stop] epoch=1/micro_step=266/global_step=5570, RunningAvgSamplesPerSec=3.2818276513910063, CurrSamplesPerSec=3.280427691716895, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:38,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=0, lr=[9.992586936176494e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:38,162] [INFO] [timer.py:260:stop] epoch=1/micro_step=276/global_step=5580, RunningAvgSamplesPerSec=3.281832942641811, CurrSamplesPerSec=3.2824275682018897, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:44,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=0, lr=[9.992554537423909e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:44,269] [INFO] [timer.py:260:stop] epoch=1/micro_step=286/global_step=5590, RunningAvgSamplesPerSec=3.2818374289382675, CurrSamplesPerSec=3.2741372056007574, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:41:50,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=0, lr=[9.992522068079086e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:41:50,375] [INFO] [timer.py:260:stop] epoch=1/micro_step=296/global_step=5600, RunningAvgSamplesPerSec=3.2818414966967473, CurrSamplesPerSec=3.293371059616767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 98.48114013671875, loss: 4.5898637771606445
[2024-05-30 22:47:31,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=0, lr=[9.992489528142488e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:47:31,967] [INFO] [timer.py:260:stop] epoch=1/micro_step=306/global_step=5610, RunningAvgSamplesPerSec=3.2818407168562205, CurrSamplesPerSec=3.2910608350951995, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:47:38,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=0, lr=[9.992456917614574e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:47:38,072] [INFO] [timer.py:260:stop] epoch=1/micro_step=316/global_step=5620, RunningAvgSamplesPerSec=3.2818455774388116, CurrSamplesPerSec=3.279010770542952, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:47:44,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=0, lr=[9.992424236495803e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:47:44,181] [INFO] [timer.py:260:stop] epoch=1/micro_step=326/global_step=5630, RunningAvgSamplesPerSec=3.281848493700294, CurrSamplesPerSec=3.273844587952048, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:47:50,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=0, lr=[9.99239148478664e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:47:50,289] [INFO] [timer.py:260:stop] epoch=1/micro_step=336/global_step=5640, RunningAvgSamplesPerSec=3.28185210240106, CurrSamplesPerSec=3.2790799853022805, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:47:56,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=0, lr=[9.992358662487546e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:47:56,396] [INFO] [timer.py:260:stop] epoch=1/micro_step=346/global_step=5650, RunningAvgSamplesPerSec=3.281856990468189, CurrSamplesPerSec=3.2842498589574083, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:48:02,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=0, lr=[9.992325769598987e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:48:02,503] [INFO] [timer.py:260:stop] epoch=1/micro_step=356/global_step=5660, RunningAvgSamplesPerSec=3.2818614348740476, CurrSamplesPerSec=3.27517904224745, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:48:08,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=0, lr=[9.992292806121426e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:48:08,618] [INFO] [timer.py:260:stop] epoch=1/micro_step=366/global_step=5670, RunningAvgSamplesPerSec=3.2818577421472863, CurrSamplesPerSec=3.2835106749419127, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:48:14,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=0, lr=[9.99225977205533e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:48:14,731] [INFO] [timer.py:260:stop] epoch=1/micro_step=376/global_step=5680, RunningAvgSamplesPerSec=3.2818566344113016, CurrSamplesPerSec=3.2757775991009055, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:48:20,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=0, lr=[9.992226667401167e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:48:20,834] [INFO] [timer.py:260:stop] epoch=1/micro_step=386/global_step=5690, RunningAvgSamplesPerSec=3.2818637902811023, CurrSamplesPerSec=3.281551840888349, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:48:26,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=0, lr=[9.992193492159405e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:48:26,943] [INFO] [timer.py:260:stop] epoch=1/micro_step=396/global_step=5700, RunningAvgSamplesPerSec=3.281865914105778, CurrSamplesPerSec=3.275147074210984, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 93.26837158203125, loss: 4.535479545593262
[2024-05-30 22:54:08,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=0, lr=[9.992160246330512e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:08,738] [INFO] [timer.py:260:stop] epoch=1/micro_step=406/global_step=5710, RunningAvgSamplesPerSec=3.281862467263558, CurrSamplesPerSec=3.2925902855216207, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:14,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=0, lr=[9.992126929914958e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:14,853] [INFO] [timer.py:260:stop] epoch=1/micro_step=416/global_step=5720, RunningAvgSamplesPerSec=3.2818597764065256, CurrSamplesPerSec=3.2790787035209235, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:20,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=0, lr=[9.992093542913215e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:20,963] [INFO] [timer.py:260:stop] epoch=1/micro_step=426/global_step=5730, RunningAvgSamplesPerSec=3.2818620940386465, CurrSamplesPerSec=3.2759439037220353, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:27,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=0, lr=[9.992060085325753e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:27,075] [INFO] [timer.py:260:stop] epoch=1/micro_step=436/global_step=5740, RunningAvgSamplesPerSec=3.281862219210075, CurrSamplesPerSec=3.2818933446321186, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:33,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=0, lr=[9.99202655715305e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:33,190] [INFO] [timer.py:260:stop] epoch=1/micro_step=446/global_step=5750, RunningAvgSamplesPerSec=3.281859944903018, CurrSamplesPerSec=3.272619739629458, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:39,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=0, lr=[9.991992958395573e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:39,302] [INFO] [timer.py:260:stop] epoch=1/micro_step=456/global_step=5760, RunningAvgSamplesPerSec=3.2818589421618447, CurrSamplesPerSec=3.2793773856640454, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:45,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=0, lr=[9.991959289053803e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:45,411] [INFO] [timer.py:260:stop] epoch=1/micro_step=466/global_step=5770, RunningAvgSamplesPerSec=3.281859887084364, CurrSamplesPerSec=3.280620128360407, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:51,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=0, lr=[9.991925549128213e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:51,516] [INFO] [timer.py:260:stop] epoch=1/micro_step=476/global_step=5780, RunningAvgSamplesPerSec=3.281863773529174, CurrSamplesPerSec=3.272954278722501, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:54:57,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=0, lr=[9.991891738619281e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:54:57,614] [INFO] [timer.py:260:stop] epoch=1/micro_step=486/global_step=5790, RunningAvgSamplesPerSec=3.281875175762472, CurrSamplesPerSec=3.2816031902945446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 22:55:03,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=0, lr=[9.991857857527486e-05], mom=[(0.9, 0.95)]
[2024-05-30 22:55:03,721] [INFO] [timer.py:260:stop] epoch=1/micro_step=496/global_step=5800, RunningAvgSamplesPerSec=3.281878045649455, CurrSamplesPerSec=3.2912144909659022, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 93.88990783691406, loss: 4.542121410369873
[2024-05-30 23:00:45,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=0, lr=[9.991823905853305e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:00:45,411] [INFO] [timer.py:260:stop] epoch=1/micro_step=506/global_step=5810, RunningAvgSamplesPerSec=3.281875328744283, CurrSamplesPerSec=3.293790038067453, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:00:51,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=0, lr=[9.99178988359722e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:00:51,518] [INFO] [timer.py:260:stop] epoch=1/micro_step=516/global_step=5820, RunningAvgSamplesPerSec=3.281879907011594, CurrSamplesPerSec=3.273466434767407, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:00:57,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=0, lr=[9.99175579075971e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:00:57,628] [INFO] [timer.py:260:stop] epoch=1/micro_step=526/global_step=5830, RunningAvgSamplesPerSec=3.2818813805959346, CurrSamplesPerSec=3.2835158159422946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:03,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=0, lr=[9.991721627341259e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:03,743] [INFO] [timer.py:260:stop] epoch=1/micro_step=536/global_step=5840, RunningAvgSamplesPerSec=3.281879859354751, CurrSamplesPerSec=3.2754066727083675, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:09,855] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=0, lr=[9.99168739334235e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:09,855] [INFO] [timer.py:260:stop] epoch=1/micro_step=546/global_step=5850, RunningAvgSamplesPerSec=3.281878735885901, CurrSamplesPerSec=3.274077144437302, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:15,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=0, lr=[9.991653088763466e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:15,966] [INFO] [timer.py:260:stop] epoch=1/micro_step=556/global_step=5860, RunningAvgSamplesPerSec=3.281878849592801, CurrSamplesPerSec=3.276381493457672, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:22,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=0, lr=[9.991618713605091e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:22,069] [INFO] [timer.py:260:stop] epoch=1/micro_step=566/global_step=5870, RunningAvgSamplesPerSec=3.281885354990946, CurrSamplesPerSec=3.2844067373224943, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:28,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=0, lr=[9.991584267867714e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:28,185] [INFO] [timer.py:260:stop] epoch=1/micro_step=576/global_step=5880, RunningAvgSamplesPerSec=3.28188287533885, CurrSamplesPerSec=3.276192112791572, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:34,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=0, lr=[9.99154975155182e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:34,295] [INFO] [timer.py:260:stop] epoch=1/micro_step=586/global_step=5890, RunningAvgSamplesPerSec=3.2818842636664867, CurrSamplesPerSec=3.2861411128430307, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:01:40,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=0, lr=[9.991515164657897e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:01:40,405] [INFO] [timer.py:260:stop] epoch=1/micro_step=596/global_step=5900, RunningAvgSamplesPerSec=3.281886307997689, CurrSamplesPerSec=3.2814722524844946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 97.31346130371094, loss: 4.577935695648193
[2024-05-30 23:07:21,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=0, lr=[9.991480507186435e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:21,916] [INFO] [timer.py:260:stop] epoch=1/micro_step=606/global_step=5910, RunningAvgSamplesPerSec=3.2818830384682887, CurrSamplesPerSec=3.2781112444977993, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:28,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=0, lr=[9.991445779137925e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:28,027] [INFO] [timer.py:260:stop] epoch=1/micro_step=616/global_step=5920, RunningAvgSamplesPerSec=3.2818841823442164, CurrSamplesPerSec=3.284773273876511, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:34,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=0, lr=[9.991410980512854e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:34,132] [INFO] [timer.py:260:stop] epoch=1/micro_step=626/global_step=5930, RunningAvgSamplesPerSec=3.2818907816512968, CurrSamplesPerSec=3.2794991815529424, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:40,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=0, lr=[9.991376111311718e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:40,242] [INFO] [timer.py:260:stop] epoch=1/micro_step=636/global_step=5940, RunningAvgSamplesPerSec=3.2818923034780836, CurrSamplesPerSec=3.2833101884831017, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:46,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=0, lr=[9.99134117153501e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:46,355] [INFO] [timer.py:260:stop] epoch=1/micro_step=646/global_step=5950, RunningAvgSamplesPerSec=3.2818919367422796, CurrSamplesPerSec=3.2798723178977807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:52,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=0, lr=[9.991306161183222e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:52,468] [INFO] [timer.py:260:stop] epoch=1/micro_step=656/global_step=5960, RunningAvgSamplesPerSec=3.2818902702323407, CurrSamplesPerSec=3.2694348317676547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:07:58,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=0, lr=[9.99127108025685e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:07:58,575] [INFO] [timer.py:260:stop] epoch=1/micro_step=666/global_step=5970, RunningAvgSamplesPerSec=3.2818946314117694, CurrSamplesPerSec=3.2897572744524624, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:08:04,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=0, lr=[9.991235928756388e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:08:04,684] [INFO] [timer.py:260:stop] epoch=1/micro_step=676/global_step=5980, RunningAvgSamplesPerSec=3.2818975913584905, CurrSamplesPerSec=3.2766425675641364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:08:10,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=0, lr=[9.991200706682337e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:08:10,789] [INFO] [timer.py:260:stop] epoch=1/micro_step=686/global_step=5990, RunningAvgSamplesPerSec=3.2819026288708484, CurrSamplesPerSec=3.278604513187141, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:08:16,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=0, lr=[9.991165414035192e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:08:16,900] [INFO] [timer.py:260:stop] epoch=1/micro_step=696/global_step=6000, RunningAvgSamplesPerSec=3.2819029385636833, CurrSamplesPerSec=3.2773364077948695, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.98548889160156, loss: 4.510699272155762
saving model ... to step 6000
[2024-05-30 23:13:59,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=6010, skipped=0, lr=[9.991130050815452e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:13:59,062] [INFO] [timer.py:260:stop] epoch=1/micro_step=706/global_step=6010, RunningAvgSamplesPerSec=3.2819085744678347, CurrSamplesPerSec=3.2823710555610988, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:05,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=6020, skipped=0, lr=[9.991094617023619e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:05,169] [INFO] [timer.py:260:stop] epoch=1/micro_step=716/global_step=6020, RunningAvgSamplesPerSec=3.2819126458709045, CurrSamplesPerSec=3.280124970429009, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:11,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=6030, skipped=0, lr=[9.991059112660193e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:11,274] [INFO] [timer.py:260:stop] epoch=1/micro_step=726/global_step=6030, RunningAvgSamplesPerSec=3.2819177357904192, CurrSamplesPerSec=3.278168891619196, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:17,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=6040, skipped=0, lr=[9.991023537725677e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:17,383] [INFO] [timer.py:260:stop] epoch=1/micro_step=736/global_step=6040, RunningAvgSamplesPerSec=3.281919675198522, CurrSamplesPerSec=3.2802788895254147, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:23,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=0, lr=[9.990987892220571e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:23,495] [INFO] [timer.py:260:stop] epoch=1/micro_step=746/global_step=6050, RunningAvgSamplesPerSec=3.281919623807008, CurrSamplesPerSec=3.278235508595756, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:29,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=6060, skipped=0, lr=[9.990952176145381e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:29,605] [INFO] [timer.py:260:stop] epoch=1/micro_step=756/global_step=6060, RunningAvgSamplesPerSec=3.2819237522760276, CurrSamplesPerSec=3.2772634255312667, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:35,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=6070, skipped=0, lr=[9.990916389500614e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:35,721] [INFO] [timer.py:260:stop] epoch=1/micro_step=766/global_step=6070, RunningAvgSamplesPerSec=3.2819242495807215, CurrSamplesPerSec=3.2767936000125, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:41,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=6080, skipped=0, lr=[9.990880532286771e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:41,832] [INFO] [timer.py:260:stop] epoch=1/micro_step=776/global_step=6080, RunningAvgSamplesPerSec=3.2819276890878095, CurrSamplesPerSec=3.2851823480850357, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:47,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=6090, skipped=0, lr=[9.990844604504364e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:47,950] [INFO] [timer.py:260:stop] epoch=1/micro_step=786/global_step=6090, RunningAvgSamplesPerSec=3.2819263140763453, CurrSamplesPerSec=3.280920374611084, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:14:54,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=0, lr=[9.990808606153899e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:14:54,062] [INFO] [timer.py:260:stop] epoch=1/micro_step=796/global_step=6100, RunningAvgSamplesPerSec=3.281930073294871, CurrSamplesPerSec=3.2899688714946116, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 93.31383514404297, loss: 4.535966873168945
[2024-05-30 23:20:35,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=6110, skipped=0, lr=[9.990772537235884e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:20:35,728] [INFO] [timer.py:260:stop] epoch=1/micro_step=806/global_step=6110, RunningAvgSamplesPerSec=3.281927091976739, CurrSamplesPerSec=3.2744912278647282, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:20:41,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=6120, skipped=0, lr=[9.990736397750831e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:20:41,834] [INFO] [timer.py:260:stop] epoch=1/micro_step=816/global_step=6120, RunningAvgSamplesPerSec=3.2819325330027986, CurrSamplesPerSec=3.2875745117788377, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:20:47,947] [INFO] [logging.py:96:log_dist] [Rank 0] step=6130, skipped=0, lr=[9.990700187699249e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:20:47,948] [INFO] [timer.py:260:stop] epoch=1/micro_step=826/global_step=6130, RunningAvgSamplesPerSec=3.2819327192337253, CurrSamplesPerSec=3.28746242206657, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:20:54,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=6140, skipped=0, lr=[9.99066390708165e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:20:54,063] [INFO] [timer.py:260:stop] epoch=1/micro_step=836/global_step=6140, RunningAvgSamplesPerSec=3.281933795801783, CurrSamplesPerSec=3.279744082774303, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:00,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=0, lr=[9.99062755589855e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:00,176] [INFO] [timer.py:260:stop] epoch=1/micro_step=846/global_step=6150, RunningAvgSamplesPerSec=3.281935311632141, CurrSamplesPerSec=3.2765299422586653, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:06,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=6160, skipped=0, lr=[9.99059113415046e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:06,288] [INFO] [timer.py:260:stop] epoch=1/micro_step=856/global_step=6160, RunningAvgSamplesPerSec=3.2819377591764938, CurrSamplesPerSec=3.279868470698173, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:12,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=6170, skipped=0, lr=[9.990554641837897e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:12,398] [INFO] [timer.py:260:stop] epoch=1/micro_step=866/global_step=6170, RunningAvgSamplesPerSec=3.2819405895313754, CurrSamplesPerSec=3.2834348470561805, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:18,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=6180, skipped=0, lr=[9.990518078961375e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:18,511] [INFO] [timer.py:260:stop] epoch=1/micro_step=876/global_step=6180, RunningAvgSamplesPerSec=3.2819445299349366, CurrSamplesPerSec=3.2811667715588677, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:24,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=6190, skipped=0, lr=[9.990481445521411e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:24,620] [INFO] [timer.py:260:stop] epoch=1/micro_step=886/global_step=6190, RunningAvgSamplesPerSec=3.2819486304618666, CurrSamplesPerSec=3.287007699692404, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:21:30,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=0, lr=[9.990444741518525e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:21:30,731] [INFO] [timer.py:260:stop] epoch=1/micro_step=896/global_step=6200, RunningAvgSamplesPerSec=3.2819493243550246, CurrSamplesPerSec=3.2754808512665408, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 95.60262298583984, loss: 4.560198783874512
[2024-05-30 23:27:12,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=6210, skipped=0, lr=[9.990407966953235e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:12,335] [INFO] [timer.py:260:stop] epoch=1/micro_step=906/global_step=6210, RunningAvgSamplesPerSec=3.28195093311602, CurrSamplesPerSec=3.284613788269751, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:18,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=6220, skipped=0, lr=[9.99037112182606e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:18,436] [INFO] [timer.py:260:stop] epoch=1/micro_step=916/global_step=6220, RunningAvgSamplesPerSec=3.281962582017929, CurrSamplesPerSec=3.2805957518034536, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:24,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=6230, skipped=0, lr=[9.990334206137523e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:24,551] [INFO] [timer.py:260:stop] epoch=1/micro_step=926/global_step=6230, RunningAvgSamplesPerSec=3.2819621088072615, CurrSamplesPerSec=3.277030416201139, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:30,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=6240, skipped=0, lr=[9.990297219888144e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:30,658] [INFO] [timer.py:260:stop] epoch=1/micro_step=936/global_step=6240, RunningAvgSamplesPerSec=3.2819677170486528, CurrSamplesPerSec=3.280446934365314, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:36,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=0, lr=[9.990260163078446e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:36,765] [INFO] [timer.py:260:stop] epoch=1/micro_step=946/global_step=6250, RunningAvgSamplesPerSec=3.2819733422942012, CurrSamplesPerSec=3.2635799515244885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:42,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=6260, skipped=0, lr=[9.990223035708956e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:42,875] [INFO] [timer.py:260:stop] epoch=1/micro_step=956/global_step=6260, RunningAvgSamplesPerSec=3.2819773191800343, CurrSamplesPerSec=3.2803879242921945, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:48,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=6270, skipped=0, lr=[9.990185837780195e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:48,983] [INFO] [timer.py:260:stop] epoch=1/micro_step=966/global_step=6270, RunningAvgSamplesPerSec=3.281981211685608, CurrSamplesPerSec=3.284792567540316, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:27:55,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=6280, skipped=0, lr=[9.99014856929269e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:27:55,092] [INFO] [timer.py:260:stop] epoch=1/micro_step=976/global_step=6280, RunningAvgSamplesPerSec=3.2819868530288705, CurrSamplesPerSec=3.295523982942146, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:28:01,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=6290, skipped=0, lr=[9.99011123024697e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:28:01,207] [INFO] [timer.py:260:stop] epoch=1/micro_step=986/global_step=6290, RunningAvgSamplesPerSec=3.2819872117705042, CurrSamplesPerSec=3.2758697041894744, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:28:07,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=0, lr=[9.99007382064356e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:28:07,312] [INFO] [timer.py:260:stop] epoch=1/micro_step=996/global_step=6300, RunningAvgSamplesPerSec=3.28199253026498, CurrSamplesPerSec=3.2840852813722314, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 92.46922302246094, loss: 4.526874542236328
[2024-05-30 23:33:48,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=6310, skipped=0, lr=[9.990036340482991e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:33:48,731] [INFO] [timer.py:260:stop] epoch=1/micro_step=1006/global_step=6310, RunningAvgSamplesPerSec=3.281991189725518, CurrSamplesPerSec=3.2770701022623347, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:33:54,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=6320, skipped=0, lr=[9.989998789765794e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:33:54,838] [INFO] [timer.py:260:stop] epoch=1/micro_step=1016/global_step=6320, RunningAvgSamplesPerSec=3.2819974872715703, CurrSamplesPerSec=3.285191354009323, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:00,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=6330, skipped=0, lr=[9.989961168492496e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:00,954] [INFO] [timer.py:260:stop] epoch=1/micro_step=1026/global_step=6330, RunningAvgSamplesPerSec=3.2819963202785587, CurrSamplesPerSec=3.272748695072389, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:07,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=6340, skipped=0, lr=[9.989923476663633e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:07,068] [INFO] [timer.py:260:stop] epoch=1/micro_step=1036/global_step=6340, RunningAvgSamplesPerSec=3.2819982240928804, CurrSamplesPerSec=3.2906167340917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:13,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=0, lr=[9.989885714279736e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:13,177] [INFO] [timer.py:260:stop] epoch=1/micro_step=1046/global_step=6350, RunningAvgSamplesPerSec=3.2820048657605074, CurrSamplesPerSec=3.278108682450572, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:19,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=6360, skipped=0, lr=[9.989847881341338e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:19,285] [INFO] [timer.py:260:stop] epoch=1/micro_step=1056/global_step=6360, RunningAvgSamplesPerSec=3.2820111882646508, CurrSamplesPerSec=3.279737671281347, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:25,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=6370, skipped=0, lr=[9.989809977848976e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:25,386] [INFO] [timer.py:260:stop] epoch=1/micro_step=1066/global_step=6370, RunningAvgSamplesPerSec=3.282021333499666, CurrSamplesPerSec=3.2924403779045694, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:31,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=6380, skipped=0, lr=[9.989772003803187e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:31,502] [INFO] [timer.py:260:stop] epoch=1/micro_step=1076/global_step=6380, RunningAvgSamplesPerSec=3.2820207094226586, CurrSamplesPerSec=3.2750895333179506, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:37,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=6390, skipped=0, lr=[9.989733959204502e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:37,614] [INFO] [timer.py:260:stop] epoch=1/micro_step=1086/global_step=6390, RunningAvgSamplesPerSec=3.2820227167742426, CurrSamplesPerSec=3.2754194618752486, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:34:43,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=0, lr=[9.989695844053465e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:34:43,721] [INFO] [timer.py:260:stop] epoch=1/micro_step=1096/global_step=6400, RunningAvgSamplesPerSec=3.2820277773423916, CurrSamplesPerSec=3.2953556844497434, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 92.45760345458984, loss: 4.5267486572265625
[2024-05-30 23:40:24,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=6410, skipped=0, lr=[9.989657658350613e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:24,962] [INFO] [timer.py:260:stop] epoch=1/micro_step=1106/global_step=6410, RunningAvgSamplesPerSec=3.282021964100537, CurrSamplesPerSec=3.286450095847847, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:40:31,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=6420, skipped=0, lr=[9.989619402096486e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:31,060] [INFO] [timer.py:260:stop] epoch=1/micro_step=1116/global_step=6420, RunningAvgSamplesPerSec=3.2820340729622566, CurrSamplesPerSec=3.2855387630615964, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:40:37,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=6430, skipped=0, lr=[9.989581075291625e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:37,173] [INFO] [timer.py:260:stop] epoch=1/micro_step=1126/global_step=6430, RunningAvgSamplesPerSec=3.2820356013718746, CurrSamplesPerSec=3.2792261149459794, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:40:43,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=6440, skipped=0, lr=[9.98954267793657e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:43,284] [INFO] [timer.py:260:stop] epoch=1/micro_step=1136/global_step=6440, RunningAvgSamplesPerSec=3.282037984688428, CurrSamplesPerSec=3.278969755768075, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:40:49,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=0, lr=[9.989504210031868e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:49,397] [INFO] [timer.py:260:stop] epoch=1/micro_step=1146/global_step=6450, RunningAvgSamplesPerSec=3.2820402030910496, CurrSamplesPerSec=3.2723005866932966, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:40:55,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=6460, skipped=0, lr=[9.989465671578058e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:40:55,503] [INFO] [timer.py:260:stop] epoch=1/micro_step=1156/global_step=6460, RunningAvgSamplesPerSec=3.2820482529322845, CurrSamplesPerSec=3.2897895283408083, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:41:01,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=6470, skipped=0, lr=[9.989427062575689e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:41:01,612] [INFO] [timer.py:260:stop] epoch=1/micro_step=1166/global_step=6470, RunningAvgSamplesPerSec=3.2820520432236657, CurrSamplesPerSec=3.2710934752108236, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:41:07,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=6480, skipped=0, lr=[9.989388383025306e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:41:07,720] [INFO] [timer.py:260:stop] epoch=1/micro_step=1176/global_step=6480, RunningAvgSamplesPerSec=3.2820578708873547, CurrSamplesPerSec=3.2926574899192245, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:41:13,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=6490, skipped=0, lr=[9.989349632927454e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:41:13,828] [INFO] [timer.py:260:stop] epoch=1/micro_step=1186/global_step=6490, RunningAvgSamplesPerSec=3.282061835978626, CurrSamplesPerSec=3.279444051766737, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:41:19,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=0, lr=[9.989310812282681e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:41:19,934] [INFO] [timer.py:260:stop] epoch=1/micro_step=1196/global_step=6500, RunningAvgSamplesPerSec=3.282066692381933, CurrSamplesPerSec=3.279324823917164, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 92.46644592285156, loss: 4.5268449783325195
[2024-05-30 23:47:01,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=6510, skipped=0, lr=[9.989271921091539e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:01,374] [INFO] [timer.py:260:stop] epoch=1/micro_step=1206/global_step=6510, RunningAvgSamplesPerSec=3.2820622920922897, CurrSamplesPerSec=3.2740311416321743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:07,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=6520, skipped=0, lr=[9.989232959354575e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:07,490] [INFO] [timer.py:260:stop] epoch=1/micro_step=1216/global_step=6520, RunningAvgSamplesPerSec=3.2820612696591906, CurrSamplesPerSec=3.2753542381683087, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:13,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=6530, skipped=0, lr=[9.989193927072342e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:13,601] [INFO] [timer.py:260:stop] epoch=1/micro_step=1226/global_step=6530, RunningAvgSamplesPerSec=3.2820641385033342, CurrSamplesPerSec=3.274077144437302, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:19,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=6540, skipped=0, lr=[9.98915482424539e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:19,717] [INFO] [timer.py:260:stop] epoch=1/micro_step=1236/global_step=6540, RunningAvgSamplesPerSec=3.28206540825848, CurrSamplesPerSec=3.268829673896694, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:25,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=0, lr=[9.989115650874272e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:25,831] [INFO] [timer.py:260:stop] epoch=1/micro_step=1246/global_step=6550, RunningAvgSamplesPerSec=3.282066295254893, CurrSamplesPerSec=3.2824982117394415, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:31,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=6560, skipped=0, lr=[9.989076406959543e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:31,946] [INFO] [timer.py:260:stop] epoch=1/micro_step=1256/global_step=6560, RunningAvgSamplesPerSec=3.282065487362414, CurrSamplesPerSec=3.278240633090714, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:38,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=6570, skipped=0, lr=[9.989037092501757e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:38,060] [INFO] [timer.py:260:stop] epoch=1/micro_step=1266/global_step=6570, RunningAvgSamplesPerSec=3.282067138723654, CurrSamplesPerSec=3.2826998836580903, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:44,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=6580, skipped=0, lr=[9.98899770750147e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:44,173] [INFO] [timer.py:260:stop] epoch=1/micro_step=1276/global_step=6580, RunningAvgSamplesPerSec=3.2820687751097575, CurrSamplesPerSec=3.287475305552758, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:50,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=6590, skipped=0, lr=[9.988958251959241e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:50,288] [INFO] [timer.py:260:stop] epoch=1/micro_step=1286/global_step=6590, RunningAvgSamplesPerSec=3.282069129816278, CurrSamplesPerSec=3.285147611411027, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:47:56,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=0, lr=[9.988918725875625e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:47:56,401] [INFO] [timer.py:260:stop] epoch=1/micro_step=1296/global_step=6600, RunningAvgSamplesPerSec=3.282069400538443, CurrSamplesPerSec=3.272370794998176, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 93.52449035644531, loss: 4.538222312927246
[2024-05-30 23:53:37,822] [INFO] [logging.py:96:log_dist] [Rank 0] step=6610, skipped=0, lr=[9.988879129251182e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:53:37,823] [INFO] [timer.py:260:stop] epoch=1/micro_step=1306/global_step=6610, RunningAvgSamplesPerSec=3.2820664105902413, CurrSamplesPerSec=3.285205506275823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:53:43,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=6620, skipped=0, lr=[9.988839462086472e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:53:43,937] [INFO] [timer.py:260:stop] epoch=1/micro_step=1316/global_step=6620, RunningAvgSamplesPerSec=3.282067050163002, CurrSamplesPerSec=3.2911395980769336, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:53:50,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=6630, skipped=0, lr=[9.988799724382054e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:53:50,048] [INFO] [timer.py:260:stop] epoch=1/micro_step=1326/global_step=6630, RunningAvgSamplesPerSec=3.2820687340105543, CurrSamplesPerSec=3.278783920426852, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:53:56,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=6640, skipped=0, lr=[9.988759916138494e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:53:56,154] [INFO] [timer.py:260:stop] epoch=1/micro_step=1336/global_step=6640, RunningAvgSamplesPerSec=3.2820744988415687, CurrSamplesPerSec=3.286368982184846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:02,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=0, lr=[9.988720037356351e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:02,265] [INFO] [timer.py:260:stop] epoch=1/micro_step=1346/global_step=6650, RunningAvgSamplesPerSec=3.282076912216146, CurrSamplesPerSec=3.2725112206463796, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:08,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=6660, skipped=0, lr=[9.98868008803619e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:08,376] [INFO] [timer.py:260:stop] epoch=1/micro_step=1356/global_step=6660, RunningAvgSamplesPerSec=3.2820788633646787, CurrSamplesPerSec=3.275775040700156, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:14,481] [INFO] [logging.py:96:log_dist] [Rank 0] step=6670, skipped=0, lr=[9.988640068178578e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:14,482] [INFO] [timer.py:260:stop] epoch=1/micro_step=1366/global_step=6670, RunningAvgSamplesPerSec=3.282084520855471, CurrSamplesPerSec=3.2821578662981485, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:20,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=6680, skipped=0, lr=[9.988599977784078e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:20,593] [INFO] [timer.py:260:stop] epoch=1/micro_step=1376/global_step=6680, RunningAvgSamplesPerSec=3.2820868591683334, CurrSamplesPerSec=3.284882607634958, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:26,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=6690, skipped=0, lr=[9.988559816853258e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:26,704] [INFO] [timer.py:260:stop] epoch=1/micro_step=1386/global_step=6690, RunningAvgSamplesPerSec=3.282088808976255, CurrSamplesPerSec=3.277662947197817, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-30 23:54:32,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=0, lr=[9.988519585386684e-05], mom=[(0.9, 0.95)]
[2024-05-30 23:54:32,817] [INFO] [timer.py:260:stop] epoch=1/micro_step=1396/global_step=6700, RunningAvgSamplesPerSec=3.282090044369566, CurrSamplesPerSec=3.281875368978823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 99.08788299560547, loss: 4.596005916595459
[2024-05-31 00:00:14,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=6710, skipped=0, lr=[9.988479283384928e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:14,269] [INFO] [timer.py:260:stop] epoch=1/micro_step=1406/global_step=6710, RunningAvgSamplesPerSec=3.282089262007913, CurrSamplesPerSec=3.2808074550437194, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:20,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=6720, skipped=0, lr=[9.988438910848559e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:20,379] [INFO] [timer.py:260:stop] epoch=1/micro_step=1416/global_step=6720, RunningAvgSamplesPerSec=3.282093239475242, CurrSamplesPerSec=3.277730824339568, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:26,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=6730, skipped=0, lr=[9.988398467778147e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:26,483] [INFO] [timer.py:260:stop] epoch=1/micro_step=1426/global_step=6730, RunningAvgSamplesPerSec=3.2820998073882035, CurrSamplesPerSec=3.2873310162751848, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:32,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=6740, skipped=0, lr=[9.988357954174263e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:32,594] [INFO] [timer.py:260:stop] epoch=1/micro_step=1436/global_step=6740, RunningAvgSamplesPerSec=3.2821022312378654, CurrSamplesPerSec=3.2842614314395515, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:38,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=0, lr=[9.988317370037484e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:38,706] [INFO] [timer.py:260:stop] epoch=1/micro_step=1446/global_step=6750, RunningAvgSamplesPerSec=3.2821035323661762, CurrSamplesPerSec=3.283321754344078, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:44,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=6760, skipped=0, lr=[9.988276715368378e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:44,821] [INFO] [timer.py:260:stop] epoch=1/micro_step=1456/global_step=6760, RunningAvgSamplesPerSec=3.2821028460387436, CurrSamplesPerSec=3.2789518121267083, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:50,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=6770, skipped=0, lr=[9.988235990167522e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:50,924] [INFO] [timer.py:260:stop] epoch=1/micro_step=1466/global_step=6770, RunningAvgSamplesPerSec=3.2821108100130436, CurrSamplesPerSec=3.2847629840151553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:00:57,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=6780, skipped=0, lr=[9.988195194435494e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:00:57,036] [INFO] [timer.py:260:stop] epoch=1/micro_step=1476/global_step=6780, RunningAvgSamplesPerSec=3.282112251499074, CurrSamplesPerSec=3.2819588290343886, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:01:03,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=6790, skipped=0, lr=[9.98815432817287e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:01:03,142] [INFO] [timer.py:260:stop] epoch=1/micro_step=1486/global_step=6790, RunningAvgSamplesPerSec=3.2821180035651576, CurrSamplesPerSec=3.2800403210828195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:01:09,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=0, lr=[9.988113391380228e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:01:09,247] [INFO] [timer.py:260:stop] epoch=1/micro_step=1496/global_step=6800, RunningAvgSamplesPerSec=3.282124796963405, CurrSamplesPerSec=3.2746714635486933, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 93.10282897949219, loss: 4.533702850341797
[2024-05-31 00:06:50,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=6810, skipped=0, lr=[9.988072384058143e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:06:50,429] [INFO] [timer.py:260:stop] epoch=1/micro_step=1506/global_step=6810, RunningAvgSamplesPerSec=3.28212327239999, CurrSamplesPerSec=3.2829504023944858, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:06:56,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=6820, skipped=0, lr=[9.988031306207199e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:06:56,539] [INFO] [timer.py:260:stop] epoch=1/micro_step=1516/global_step=6820, RunningAvgSamplesPerSec=3.282126774069153, CurrSamplesPerSec=3.277420917634786, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:02,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=6830, skipped=0, lr=[9.987990157827975e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:02,642] [INFO] [timer.py:260:stop] epoch=1/micro_step=1526/global_step=6830, RunningAvgSamplesPerSec=3.2821351177992324, CurrSamplesPerSec=3.2910453411818894, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:08,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=6840, skipped=0, lr=[9.987948938921055e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:08,747] [INFO] [timer.py:260:stop] epoch=1/micro_step=1536/global_step=6840, RunningAvgSamplesPerSec=3.282140858109027, CurrSamplesPerSec=3.276951046962321, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:14,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=0, lr=[9.98790764948702e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:14,858] [INFO] [timer.py:260:stop] epoch=1/micro_step=1546/global_step=6850, RunningAvgSamplesPerSec=3.282142812773694, CurrSamplesPerSec=3.2721384808438914, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:20,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=6860, skipped=0, lr=[9.987866289526453e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:20,969] [INFO] [timer.py:260:stop] epoch=1/micro_step=1556/global_step=6860, RunningAvgSamplesPerSec=3.2821449686545305, CurrSamplesPerSec=3.2761626839778826, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:27,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=6870, skipped=0, lr=[9.98782485903994e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:27,084] [INFO] [timer.py:260:stop] epoch=1/micro_step=1566/global_step=6870, RunningAvgSamplesPerSec=3.2821439695145562, CurrSamplesPerSec=3.2801480573726227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:33,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=6880, skipped=0, lr=[9.987783358028067e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:33,195] [INFO] [timer.py:260:stop] epoch=1/micro_step=1576/global_step=6880, RunningAvgSamplesPerSec=3.2821468131216602, CurrSamplesPerSec=3.2826215241091625, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:39,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=6890, skipped=0, lr=[9.98774178649142e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:39,310] [INFO] [timer.py:260:stop] epoch=1/micro_step=1586/global_step=6890, RunningAvgSamplesPerSec=3.2821473735658273, CurrSamplesPerSec=3.272338881758852, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:07:45,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=0, lr=[9.987700144430589e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:07:45,422] [INFO] [timer.py:260:stop] epoch=1/micro_step=1596/global_step=6900, RunningAvgSamplesPerSec=3.2821499275405444, CurrSamplesPerSec=3.272158902743804, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 95.54203796386719, loss: 4.559564590454102
[2024-05-31 00:13:27,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=6910, skipped=0, lr=[9.987658431846158e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:27,051] [INFO] [timer.py:260:stop] epoch=1/micro_step=1606/global_step=6910, RunningAvgSamplesPerSec=3.282151255004768, CurrSamplesPerSec=3.274077144437302, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:13:33,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=6920, skipped=0, lr=[9.987616648738722e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:33,160] [INFO] [timer.py:260:stop] epoch=1/micro_step=1616/global_step=6920, RunningAvgSamplesPerSec=3.282154135507991, CurrSamplesPerSec=3.2814748197921024, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:13:39,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=6930, skipped=0, lr=[9.98757479510887e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:39,268] [INFO] [timer.py:260:stop] epoch=1/micro_step=1626/global_step=6930, RunningAvgSamplesPerSec=3.2821574006683925, CurrSamplesPerSec=3.273981306718747, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:13:45,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=6940, skipped=0, lr=[9.987532870957192e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:45,377] [INFO] [timer.py:260:stop] epoch=1/micro_step=1636/global_step=6940, RunningAvgSamplesPerSec=3.28216094813314, CurrSamplesPerSec=3.280048016297388, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:13:51,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=0, lr=[9.987490876284285e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:51,483] [INFO] [timer.py:260:stop] epoch=1/micro_step=1646/global_step=6950, RunningAvgSamplesPerSec=3.282165465729304, CurrSamplesPerSec=3.2796992028500194, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:13:57,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=6960, skipped=0, lr=[9.987448811090738e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:13:57,594] [INFO] [timer.py:260:stop] epoch=1/micro_step=1656/global_step=6960, RunningAvgSamplesPerSec=3.282168200196822, CurrSamplesPerSec=3.279795375620391, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:14:03,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=6970, skipped=0, lr=[9.987406675377147e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:14:03,703] [INFO] [timer.py:260:stop] epoch=1/micro_step=1666/global_step=6970, RunningAvgSamplesPerSec=3.282170859550888, CurrSamplesPerSec=3.2845083304881144, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:14:09,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=6980, skipped=0, lr=[9.98736446914411e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:14:09,818] [INFO] [timer.py:260:stop] epoch=1/micro_step=1676/global_step=6980, RunningAvgSamplesPerSec=3.282172515101896, CurrSamplesPerSec=3.278787765082581, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:14:15,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=6990, skipped=0, lr=[9.987322192392222e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:14:15,930] [INFO] [timer.py:260:stop] epoch=1/micro_step=1686/global_step=6990, RunningAvgSamplesPerSec=3.282174182455821, CurrSamplesPerSec=3.282265741741032, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:14:22,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=0, lr=[9.987279845122081e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:14:22,042] [INFO] [timer.py:260:stop] epoch=1/micro_step=1696/global_step=7000, RunningAvgSamplesPerSec=3.2821764098902313, CurrSamplesPerSec=3.2716369479415297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.56231689453125, loss: 4.506036758422852
saving model ... to step 7000
[2024-05-31 00:20:04,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=7010, skipped=0, lr=[9.987237427334285e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:04,165] [INFO] [timer.py:260:stop] epoch=1/micro_step=1706/global_step=7010, RunningAvgSamplesPerSec=3.2820621031707438, CurrSamplesPerSec=3.285581229207123, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:10,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=7020, skipped=0, lr=[9.987194939029436e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:10,278] [INFO] [timer.py:260:stop] epoch=1/micro_step=1716/global_step=7020, RunningAvgSamplesPerSec=3.282062643444933, CurrSamplesPerSec=3.2781509567419387, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:16,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=7030, skipped=0, lr=[9.987152380208133e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:16,381] [INFO] [timer.py:260:stop] epoch=1/micro_step=1726/global_step=7030, RunningAvgSamplesPerSec=3.282070001271391, CurrSamplesPerSec=3.2814414451065352, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:22,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=7040, skipped=0, lr=[9.987109750870977e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:22,488] [INFO] [timer.py:260:stop] epoch=1/micro_step=1736/global_step=7040, RunningAvgSamplesPerSec=3.2820745468278885, CurrSamplesPerSec=3.2891497293745107, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:28,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=0, lr=[9.987067051018575e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:28,606] [INFO] [timer.py:260:stop] epoch=1/micro_step=1746/global_step=7050, RunningAvgSamplesPerSec=3.282073570038732, CurrSamplesPerSec=3.2777692466092514, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:34,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=7060, skipped=0, lr=[9.987024280651524e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:34,714] [INFO] [timer.py:260:stop] epoch=1/micro_step=1756/global_step=7060, RunningAvgSamplesPerSec=3.2820763457765576, CurrSamplesPerSec=3.274913087186094, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:40,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=7070, skipped=0, lr=[9.986981439770436e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:40,832] [INFO] [timer.py:260:stop] epoch=1/micro_step=1766/global_step=7070, RunningAvgSamplesPerSec=3.2820728823508944, CurrSamplesPerSec=3.2702186848966455, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:46,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=7080, skipped=0, lr=[9.986938528375911e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:46,949] [INFO] [timer.py:260:stop] epoch=1/micro_step=1776/global_step=7080, RunningAvgSamplesPerSec=3.2820720541097685, CurrSamplesPerSec=3.277437564026127, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:53,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=7090, skipped=0, lr=[9.986895546468557e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:53,059] [INFO] [timer.py:260:stop] epoch=1/micro_step=1786/global_step=7090, RunningAvgSamplesPerSec=3.2820754983502947, CurrSamplesPerSec=3.2893999436905585, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:20:59,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=0, lr=[9.986852494048985e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:20:59,168] [INFO] [timer.py:260:stop] epoch=1/micro_step=1796/global_step=7100, RunningAvgSamplesPerSec=3.2820790383660583, CurrSamplesPerSec=3.282467385094577, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 89.9899673461914, loss: 4.499696731567383
[2024-05-31 00:26:40,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=7110, skipped=0, lr=[9.9868093711178e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:26:40,648] [INFO] [timer.py:260:stop] epoch=1/micro_step=1806/global_step=7110, RunningAvgSamplesPerSec=3.282077962511934, CurrSamplesPerSec=3.2804918347562237, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:26:46,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=7120, skipped=0, lr=[9.986766177675615e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:26:46,755] [INFO] [timer.py:260:stop] epoch=1/micro_step=1816/global_step=7120, RunningAvgSamplesPerSec=3.2820841598561703, CurrSamplesPerSec=3.285691903714427, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:26:52,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=7130, skipped=0, lr=[9.986722913723037e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:26:52,861] [INFO] [timer.py:260:stop] epoch=1/micro_step=1826/global_step=7130, RunningAvgSamplesPerSec=3.2820886191867666, CurrSamplesPerSec=3.2840968526945806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:26:58,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=7140, skipped=0, lr=[9.98667957926068e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:26:58,973] [INFO] [timer.py:260:stop] epoch=1/micro_step=1836/global_step=7140, RunningAvgSamplesPerSec=3.2820901570264147, CurrSamplesPerSec=3.28627886058851, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:05,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=0, lr=[9.986636174289156e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:05,086] [INFO] [timer.py:260:stop] epoch=1/micro_step=1846/global_step=7150, RunningAvgSamplesPerSec=3.2820927711591374, CurrSamplesPerSec=3.279228678740192, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:11,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=7160, skipped=0, lr=[9.986592698809081e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:11,199] [INFO] [timer.py:260:stop] epoch=1/micro_step=1856/global_step=7160, RunningAvgSamplesPerSec=3.282094191624623, CurrSamplesPerSec=3.285361189255282, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:17,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=7170, skipped=0, lr=[9.986549152821066e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:17,309] [INFO] [timer.py:260:stop] epoch=1/micro_step=1866/global_step=7170, RunningAvgSamplesPerSec=3.282097642008638, CurrSamplesPerSec=3.285178488418314, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:23,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=7180, skipped=0, lr=[9.98650553632573e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:23,417] [INFO] [timer.py:260:stop] epoch=1/micro_step=1876/global_step=7180, RunningAvgSamplesPerSec=3.2821017287944407, CurrSamplesPerSec=3.278618608759546, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:29,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=7190, skipped=0, lr=[9.986461849323687e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:29,529] [INFO] [timer.py:260:stop] epoch=1/micro_step=1886/global_step=7190, RunningAvgSamplesPerSec=3.2821044771948547, CurrSamplesPerSec=3.2792979026993216, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:27:35,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=0, lr=[9.986418091815556e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:27:35,643] [INFO] [timer.py:260:stop] epoch=1/micro_step=1896/global_step=7200, RunningAvgSamplesPerSec=3.2821032848806735, CurrSamplesPerSec=3.269493448430285, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 91.46345520019531, loss: 4.515937805175781
[2024-05-31 00:33:17,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=7210, skipped=0, lr=[9.986374263801956e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:17,183] [INFO] [timer.py:260:stop] epoch=1/micro_step=1906/global_step=7210, RunningAvgSamplesPerSec=3.282103349913459, CurrSamplesPerSec=3.280718921273928, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:23,293] [INFO] [logging.py:96:log_dist] [Rank 0] step=7220, skipped=0, lr=[9.986330365283506e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:23,294] [INFO] [timer.py:260:stop] epoch=1/micro_step=1916/global_step=7220, RunningAvgSamplesPerSec=3.282105232462579, CurrSamplesPerSec=3.2793543095676867, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:29,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=7230, skipped=0, lr=[9.986286396260827e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:29,405] [INFO] [timer.py:260:stop] epoch=1/micro_step=1926/global_step=7230, RunningAvgSamplesPerSec=3.2821079044924453, CurrSamplesPerSec=3.2819267285106695, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:35,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=7240, skipped=0, lr=[9.986242356734541e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:35,509] [INFO] [timer.py:260:stop] epoch=1/micro_step=1936/global_step=7240, RunningAvgSamplesPerSec=3.2821147963125212, CurrSamplesPerSec=3.2889072899611698, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:41,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=0, lr=[9.986198246705271e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:41,618] [INFO] [timer.py:260:stop] epoch=1/micro_step=1946/global_step=7250, RunningAvgSamplesPerSec=3.282117076964266, CurrSamplesPerSec=3.2793773856640454, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:47,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=7260, skipped=0, lr=[9.98615406617364e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:47,728] [INFO] [timer.py:260:stop] epoch=1/micro_step=1956/global_step=7260, RunningAvgSamplesPerSec=3.2821187943585928, CurrSamplesPerSec=3.2834823997275704, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:53,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=7270, skipped=0, lr=[9.986109815140272e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:53,833] [INFO] [timer.py:260:stop] epoch=1/micro_step=1966/global_step=7270, RunningAvgSamplesPerSec=3.2821257666513626, CurrSamplesPerSec=3.285899116733799, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:33:59,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=7280, skipped=0, lr=[9.986065493605794e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:33:59,938] [INFO] [timer.py:260:stop] epoch=1/micro_step=1976/global_step=7280, RunningAvgSamplesPerSec=3.282131441820227, CurrSamplesPerSec=3.2928746305696204, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:34:06,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=7290, skipped=0, lr=[9.986021101570832e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:34:06,045] [INFO] [timer.py:260:stop] epoch=1/micro_step=1986/global_step=7290, RunningAvgSamplesPerSec=3.282134972189768, CurrSamplesPerSec=3.2827679695822014, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:34:12,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=0, lr=[9.985976639036014e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:34:12,152] [INFO] [timer.py:260:stop] epoch=1/micro_step=1996/global_step=7300, RunningAvgSamplesPerSec=3.2821421457009254, CurrSamplesPerSec=3.2815877853039495, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.15422058105469, loss: 4.501520156860352
[2024-05-31 00:39:53,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=7310, skipped=0, lr=[9.98593210600197e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:39:53,476] [INFO] [timer.py:260:stop] epoch=1/micro_step=2006/global_step=7310, RunningAvgSamplesPerSec=3.2821415880324354, CurrSamplesPerSec=3.2803750962963543, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:39:59,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=7320, skipped=0, lr=[9.985887502469327e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:39:59,582] [INFO] [timer.py:260:stop] epoch=1/micro_step=2016/global_step=7320, RunningAvgSamplesPerSec=3.2821457039233084, CurrSamplesPerSec=3.2789505304455537, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:05,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=7330, skipped=0, lr=[9.985842828438717e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:05,693] [INFO] [timer.py:260:stop] epoch=1/micro_step=2026/global_step=7330, RunningAvgSamplesPerSec=3.2821479918447825, CurrSamplesPerSec=3.2790953667567297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:11,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=7340, skipped=0, lr=[9.985798083910772e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:11,800] [INFO] [timer.py:260:stop] epoch=1/micro_step=2036/global_step=7340, RunningAvgSamplesPerSec=3.2821534461939867, CurrSamplesPerSec=3.2872279602598713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:17,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=0, lr=[9.985753268886125e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:17,909] [INFO] [timer.py:260:stop] epoch=1/micro_step=2046/global_step=7350, RunningAvgSamplesPerSec=3.2821571334995165, CurrSamplesPerSec=3.281836850384829, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:24,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=7360, skipped=0, lr=[9.985708383365407e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:24,016] [INFO] [timer.py:260:stop] epoch=1/micro_step=2056/global_step=7360, RunningAvgSamplesPerSec=3.282161097718027, CurrSamplesPerSec=3.2781676105500264, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:30,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=7370, skipped=0, lr=[9.985663427349255e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:30,129] [INFO] [timer.py:260:stop] epoch=1/micro_step=2066/global_step=7370, RunningAvgSamplesPerSec=3.2821631336089196, CurrSamplesPerSec=3.2793850777683344, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:36,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=7380, skipped=0, lr=[9.985618400838305e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:36,240] [INFO] [timer.py:260:stop] epoch=1/micro_step=2076/global_step=7380, RunningAvgSamplesPerSec=3.282164935794371, CurrSamplesPerSec=3.2848478772993834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:42,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=7390, skipped=0, lr=[9.985573303833192e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:42,351] [INFO] [timer.py:260:stop] epoch=1/micro_step=2086/global_step=7390, RunningAvgSamplesPerSec=3.282165259963174, CurrSamplesPerSec=3.2813336238388744, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:40:48,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=0, lr=[9.985528136334556e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:40:48,453] [INFO] [timer.py:260:stop] epoch=1/micro_step=2096/global_step=7400, RunningAvgSamplesPerSec=3.2821717841357683, CurrSamplesPerSec=3.273061550010847, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 91.11441040039062, loss: 4.512114524841309
[2024-05-31 00:46:29,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=7410, skipped=0, lr=[9.985482898343033e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:46:29,961] [INFO] [timer.py:260:stop] epoch=1/micro_step=2106/global_step=7410, RunningAvgSamplesPerSec=3.28216868451883, CurrSamplesPerSec=3.2817739386257294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:46:36,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=7420, skipped=0, lr=[9.985437589859263e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:46:36,072] [INFO] [timer.py:260:stop] epoch=1/micro_step=2116/global_step=7420, RunningAvgSamplesPerSec=3.282169844548759, CurrSamplesPerSec=3.281944704726589, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:46:42,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=7430, skipped=0, lr=[9.985392210883889e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:46:42,183] [INFO] [timer.py:260:stop] epoch=1/micro_step=2126/global_step=7430, RunningAvgSamplesPerSec=3.282173957641837, CurrSamplesPerSec=3.2825662892980363, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:46:48,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=7440, skipped=0, lr=[9.985346761417551e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:46:48,292] [INFO] [timer.py:260:stop] epoch=1/micro_step=2136/global_step=7440, RunningAvgSamplesPerSec=3.282177947632664, CurrSamplesPerSec=3.282263173195698, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:46:54,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=0, lr=[9.985301241460891e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:46:54,398] [INFO] [timer.py:260:stop] epoch=1/micro_step=2146/global_step=7450, RunningAvgSamplesPerSec=3.2821833526870514, CurrSamplesPerSec=3.282347937314359, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:47:00,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=7460, skipped=0, lr=[9.985255651014555e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:47:00,503] [INFO] [timer.py:260:stop] epoch=1/micro_step=2156/global_step=7460, RunningAvgSamplesPerSec=3.282190075003673, CurrSamplesPerSec=3.288356775746638, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:47:06,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=7470, skipped=0, lr=[9.985209990079184e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:47:06,609] [INFO] [timer.py:260:stop] epoch=1/micro_step=2166/global_step=7470, RunningAvgSamplesPerSec=3.2821958760233243, CurrSamplesPerSec=3.2864037446929877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:47:12,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=7480, skipped=0, lr=[9.985164258655426e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:47:12,715] [INFO] [timer.py:260:stop] epoch=1/micro_step=2176/global_step=7480, RunningAvgSamplesPerSec=3.2821998626404976, CurrSamplesPerSec=3.2879404670355727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:47:18,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=7490, skipped=0, lr=[9.985118456743928e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:47:18,812] [INFO] [timer.py:260:stop] epoch=1/micro_step=2186/global_step=7490, RunningAvgSamplesPerSec=3.282210899815204, CurrSamplesPerSec=3.285020249890938, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:47:24,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=0, lr=[9.985072584345336e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:47:24,922] [INFO] [timer.py:260:stop] epoch=1/micro_step=2196/global_step=7500, RunningAvgSamplesPerSec=3.2822139596774873, CurrSamplesPerSec=3.271332019643728, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.45756530761719, loss: 4.504879951477051
[2024-05-31 00:53:06,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=7510, skipped=0, lr=[9.985026641460301e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:06,154] [INFO] [timer.py:260:stop] epoch=1/micro_step=2206/global_step=7510, RunningAvgSamplesPerSec=3.28221327397915, CurrSamplesPerSec=3.2798197402843163, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:12,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=7520, skipped=0, lr=[9.984980628089471e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:12,265] [INFO] [timer.py:260:stop] epoch=1/micro_step=2216/global_step=7520, RunningAvgSamplesPerSec=3.282215156179918, CurrSamplesPerSec=3.278140708328758, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:18,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=7530, skipped=0, lr=[9.984934544233495e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:18,370] [INFO] [timer.py:260:stop] epoch=1/micro_step=2226/global_step=7530, RunningAvgSamplesPerSec=3.2822223327390656, CurrSamplesPerSec=3.299199762135027, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:24,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=7540, skipped=0, lr=[9.984888389893027e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:24,478] [INFO] [timer.py:260:stop] epoch=1/micro_step=2236/global_step=7540, RunningAvgSamplesPerSec=3.282226372870274, CurrSamplesPerSec=3.289568924375594, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:30,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=0, lr=[9.98484216506872e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:30,587] [INFO] [timer.py:260:stop] epoch=1/micro_step=2246/global_step=7550, RunningAvgSamplesPerSec=3.282230349901904, CurrSamplesPerSec=3.291462436572921, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:36,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=7560, skipped=0, lr=[9.984795869761224e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:36,705] [INFO] [timer.py:260:stop] epoch=1/micro_step=2256/global_step=7560, RunningAvgSamplesPerSec=3.282233156721183, CurrSamplesPerSec=3.2990972581092994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:42,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=7570, skipped=0, lr=[9.984749503971198e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:42,808] [INFO] [timer.py:260:stop] epoch=1/micro_step=2266/global_step=7570, RunningAvgSamplesPerSec=3.282238942759114, CurrSamplesPerSec=3.2772992760615876, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:48,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=7580, skipped=0, lr=[9.984703067699295e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:48,916] [INFO] [timer.py:260:stop] epoch=1/micro_step=2276/global_step=7580, RunningAvgSamplesPerSec=3.2822426236219737, CurrSamplesPerSec=3.2834823997275704, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:53:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=7590, skipped=0, lr=[9.984656560946172e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:53:55,027] [INFO] [timer.py:260:stop] epoch=1/micro_step=2286/global_step=7590, RunningAvgSamplesPerSec=3.2822440002894533, CurrSamplesPerSec=3.2766131306573922, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:54:01,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=0, lr=[9.984609983712487e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:54:01,132] [INFO] [timer.py:260:stop] epoch=1/micro_step=2296/global_step=7600, RunningAvgSamplesPerSec=3.2822501701234046, CurrSamplesPerSec=3.2848440184185415, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 89.70069885253906, loss: 4.496478080749512
[2024-05-31 00:59:42,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=7610, skipped=0, lr=[9.9845633359989e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:59:42,155] [INFO] [timer.py:260:stop] epoch=1/micro_step=2306/global_step=7610, RunningAvgSamplesPerSec=3.282253487000277, CurrSamplesPerSec=3.277960090563301, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:59:48,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=7620, skipped=0, lr=[9.984516617806068e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:59:48,263] [INFO] [timer.py:260:stop] epoch=1/micro_step=2316/global_step=7620, RunningAvgSamplesPerSec=3.2822576291570345, CurrSamplesPerSec=3.285479569660004, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 00:59:54,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=7630, skipped=0, lr=[9.98446982913465e-05], mom=[(0.9, 0.95)]
[2024-05-31 00:59:54,373] [INFO] [timer.py:260:stop] epoch=1/micro_step=2326/global_step=7630, RunningAvgSamplesPerSec=3.282261624090036, CurrSamplesPerSec=3.283931004865644, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:00,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=7640, skipped=0, lr=[9.984422969985315e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:00,487] [INFO] [timer.py:260:stop] epoch=1/micro_step=2336/global_step=7640, RunningAvgSamplesPerSec=3.282261362303034, CurrSamplesPerSec=3.2763622984741883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:06,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=0, lr=[9.984376040358716e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:06,590] [INFO] [timer.py:260:stop] epoch=1/micro_step=2346/global_step=7650, RunningAvgSamplesPerSec=3.2822670864674675, CurrSamplesPerSec=3.2882717010006393, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:12,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=7660, skipped=0, lr=[9.984329040255525e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:12,701] [INFO] [timer.py:260:stop] epoch=1/micro_step=2356/global_step=7660, RunningAvgSamplesPerSec=3.2822685762686303, CurrSamplesPerSec=3.2826176704573693, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:18,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=7670, skipped=0, lr=[9.9842819696764e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:18,802] [INFO] [timer.py:260:stop] epoch=1/micro_step=2366/global_step=7670, RunningAvgSamplesPerSec=3.2822761469365305, CurrSamplesPerSec=3.285465415032147, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:24,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=7680, skipped=0, lr=[9.98423482862201e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:24,907] [INFO] [timer.py:260:stop] epoch=1/micro_step=2376/global_step=7680, RunningAvgSamplesPerSec=3.282281726827704, CurrSamplesPerSec=3.291527011872652, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:31,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=7690, skipped=0, lr=[9.984187617093021e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:31,017] [INFO] [timer.py:260:stop] epoch=1/micro_step=2386/global_step=7690, RunningAvgSamplesPerSec=3.2822832898442704, CurrSamplesPerSec=3.280253235339547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:00:37,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=0, lr=[9.984140335090101e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:00:37,126] [INFO] [timer.py:260:stop] epoch=1/micro_step=2396/global_step=7700, RunningAvgSamplesPerSec=3.2822864690947107, CurrSamplesPerSec=3.2887538494410347, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.16674041748047, loss: 4.501659870147705
[2024-05-31 01:06:18,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=7710, skipped=0, lr=[9.98409298261392e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:18,112] [INFO] [timer.py:260:stop] epoch=1/micro_step=2406/global_step=7710, RunningAvgSamplesPerSec=3.282287186818879, CurrSamplesPerSec=3.291689752866482, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:24,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=7720, skipped=0, lr=[9.984045559665142e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:24,223] [INFO] [timer.py:260:stop] epoch=1/micro_step=2416/global_step=7720, RunningAvgSamplesPerSec=3.282289009091086, CurrSamplesPerSec=3.2763431037156145, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:30,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=7730, skipped=0, lr=[9.983998066244442e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:30,336] [INFO] [timer.py:260:stop] epoch=1/micro_step=2426/global_step=7730, RunningAvgSamplesPerSec=3.282290784271594, CurrSamplesPerSec=3.283172689489873, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:36,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=7740, skipped=0, lr=[9.983950502352493e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:36,440] [INFO] [timer.py:260:stop] epoch=1/micro_step=2436/global_step=7740, RunningAvgSamplesPerSec=3.282297503673173, CurrSamplesPerSec=3.289921130759788, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:42,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=0, lr=[9.983902867989963e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:42,551] [INFO] [timer.py:260:stop] epoch=1/micro_step=2446/global_step=7750, RunningAvgSamplesPerSec=3.282299730259797, CurrSamplesPerSec=3.2845199047918485, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:48,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=7760, skipped=0, lr=[9.983855163157527e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:48,660] [INFO] [timer.py:260:stop] epoch=1/micro_step=2456/global_step=7760, RunningAvgSamplesPerSec=3.2823029965295065, CurrSamplesPerSec=3.285205506275823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:06:54,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=7770, skipped=0, lr=[9.983807387855861e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:06:54,775] [INFO] [timer.py:260:stop] epoch=1/micro_step=2466/global_step=7770, RunningAvgSamplesPerSec=3.282302698090953, CurrSamplesPerSec=3.27885568882053, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:07:00,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=7780, skipped=0, lr=[9.98375954208564e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:07:00,894] [INFO] [timer.py:260:stop] epoch=1/micro_step=2476/global_step=7780, RunningAvgSamplesPerSec=3.282298796847728, CurrSamplesPerSec=3.277586108543221, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:07:07,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=7790, skipped=0, lr=[9.983711625847541e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:07:07,008] [INFO] [timer.py:260:stop] epoch=1/micro_step=2486/global_step=7790, RunningAvgSamplesPerSec=3.2823032161466865, CurrSamplesPerSec=3.279360719561877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:07:13,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=0, lr=[9.983663639142239e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:07:13,121] [INFO] [timer.py:260:stop] epoch=1/micro_step=2496/global_step=7800, RunningAvgSamplesPerSec=3.2823044550283145, CurrSamplesPerSec=3.2873980061502963, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.8508529663086, loss: 4.509219169616699
[2024-05-31 01:12:54,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=7810, skipped=0, lr=[9.983615581970416e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:12:54,173] [INFO] [timer.py:260:stop] epoch=1/micro_step=2506/global_step=7810, RunningAvgSamplesPerSec=3.282303717567334, CurrSamplesPerSec=3.2871493843899153, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:00,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=7820, skipped=0, lr=[9.983567454332747e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:00,279] [INFO] [timer.py:260:stop] epoch=1/micro_step=2516/global_step=7820, RunningAvgSamplesPerSec=3.2823088121272863, CurrSamplesPerSec=3.28298509261785, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:06,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=7830, skipped=0, lr=[9.983519256229919e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:06,391] [INFO] [timer.py:260:stop] epoch=1/micro_step=2526/global_step=7830, RunningAvgSamplesPerSec=3.282309648311475, CurrSamplesPerSec=3.2845096165178345, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:12,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=7840, skipped=0, lr=[9.983470987662606e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:12,505] [INFO] [timer.py:260:stop] epoch=1/micro_step=2536/global_step=7840, RunningAvgSamplesPerSec=3.2823086845278753, CurrSamplesPerSec=3.2812553295020894, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:18,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=0, lr=[9.983422648631498e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:18,617] [INFO] [timer.py:260:stop] epoch=1/micro_step=2546/global_step=7850, RunningAvgSamplesPerSec=3.2823106225484167, CurrSamplesPerSec=3.2746752985660477, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:24,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=7860, skipped=0, lr=[9.983374239137272e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:24,728] [INFO] [timer.py:260:stop] epoch=1/micro_step=2556/global_step=7860, RunningAvgSamplesPerSec=3.282311336541277, CurrSamplesPerSec=3.2850356871249877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:30,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=7870, skipped=0, lr=[9.983325759180617e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:30,842] [INFO] [timer.py:260:stop] epoch=1/micro_step=2566/global_step=7870, RunningAvgSamplesPerSec=3.282311305687314, CurrSamplesPerSec=3.2807035245843297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:36,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=7880, skipped=0, lr=[9.983277208762215e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:36,954] [INFO] [timer.py:260:stop] epoch=1/micro_step=2576/global_step=7880, RunningAvgSamplesPerSec=3.2823116678014745, CurrSamplesPerSec=3.290179205283987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:43,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=7890, skipped=0, lr=[9.983228587882754e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:43,057] [INFO] [timer.py:260:stop] epoch=1/micro_step=2586/global_step=7890, RunningAvgSamplesPerSec=3.282318102127355, CurrSamplesPerSec=3.297263642481149, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:13:49,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=0, lr=[9.983179896542923e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:13:49,166] [INFO] [timer.py:260:stop] epoch=1/micro_step=2596/global_step=7900, RunningAvgSamplesPerSec=3.282322471746624, CurrSamplesPerSec=3.2808420999935075, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 96.1207275390625, loss: 4.565603733062744
[2024-05-31 01:19:29,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=7910, skipped=0, lr=[9.983131134743408e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:19:29,944] [INFO] [timer.py:260:stop] epoch=1/micro_step=2606/global_step=7910, RunningAvgSamplesPerSec=3.2823216621910785, CurrSamplesPerSec=3.2855246079236973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:19:36,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=7920, skipped=0, lr=[9.983082302484902e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:19:36,049] [INFO] [timer.py:260:stop] epoch=1/micro_step=2616/global_step=7920, RunningAvgSamplesPerSec=3.282328237167058, CurrSamplesPerSec=3.2833821551641806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:19:42,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=7930, skipped=0, lr=[9.983033399768091e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:19:42,155] [INFO] [timer.py:260:stop] epoch=1/micro_step=2626/global_step=7930, RunningAvgSamplesPerSec=3.282334054113513, CurrSamplesPerSec=3.290873626744374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:19:48,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=7940, skipped=0, lr=[9.982984426593668e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:19:48,259] [INFO] [timer.py:260:stop] epoch=1/micro_step=2636/global_step=7940, RunningAvgSamplesPerSec=3.2823398863567013, CurrSamplesPerSec=3.2769702488449597, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:19:54,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=0, lr=[9.982935382962328e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:19:54,369] [INFO] [timer.py:260:stop] epoch=1/micro_step=2646/global_step=7950, RunningAvgSamplesPerSec=3.2823427697526975, CurrSamplesPerSec=3.288235610014045, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:20:00,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=7960, skipped=0, lr=[9.982886268874762e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:20:00,468] [INFO] [timer.py:260:stop] epoch=1/micro_step=2656/global_step=7960, RunningAvgSamplesPerSec=3.2823513755608174, CurrSamplesPerSec=3.282249046268219, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:20:06,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=7970, skipped=0, lr=[9.982837084331665e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:20:06,578] [INFO] [timer.py:260:stop] epoch=1/micro_step=2666/global_step=7970, RunningAvgSamplesPerSec=3.2823547710125283, CurrSamplesPerSec=3.2811026021231746, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:20:12,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=7980, skipped=0, lr=[9.98278782933373e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:20:12,684] [INFO] [timer.py:260:stop] epoch=1/micro_step=2676/global_step=7980, RunningAvgSamplesPerSec=3.2823591126062244, CurrSamplesPerSec=3.289190999217364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:20:18,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=7990, skipped=0, lr=[9.982738503881656e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:20:18,796] [INFO] [timer.py:260:stop] epoch=1/micro_step=2686/global_step=7990, RunningAvgSamplesPerSec=3.282360603881425, CurrSamplesPerSec=3.2734153396858794, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:20:24,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=0, lr=[9.982689107976143e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:20:24,899] [INFO] [timer.py:260:stop] epoch=1/micro_step=2696/global_step=8000, RunningAvgSamplesPerSec=3.282367311694675, CurrSamplesPerSec=3.289263223934439, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 90.94088745117188, loss: 4.5102081298828125
saving model ... to step 8000
[2024-05-31 01:26:06,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=8010, skipped=0, lr=[9.982639641617886e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:06,569] [INFO] [timer.py:260:stop] epoch=1/micro_step=2706/global_step=8010, RunningAvgSamplesPerSec=3.2823698393687164, CurrSamplesPerSec=3.2816417034038112, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:12,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=8020, skipped=0, lr=[9.982590104807583e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:12,669] [INFO] [timer.py:260:stop] epoch=1/micro_step=2716/global_step=8020, RunningAvgSamplesPerSec=3.2823781514115526, CurrSamplesPerSec=3.276737281200477, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:18,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=8030, skipped=0, lr=[9.982540497545938e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:18,774] [INFO] [timer.py:260:stop] epoch=1/micro_step=2726/global_step=8030, RunningAvgSamplesPerSec=3.282384337853393, CurrSamplesPerSec=3.286193893324746, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:24,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=8040, skipped=0, lr=[9.982490819833651e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:24,886] [INFO] [timer.py:260:stop] epoch=1/micro_step=2736/global_step=8040, RunningAvgSamplesPerSec=3.282385641647986, CurrSamplesPerSec=3.273001528304456, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:31,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=0, lr=[9.982441071671424e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:31,001] [INFO] [timer.py:260:stop] epoch=1/micro_step=2746/global_step=8050, RunningAvgSamplesPerSec=3.2823863416720225, CurrSamplesPerSec=3.276778240144499, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:37,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=8060, skipped=0, lr=[9.982391253059961e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:37,106] [INFO] [timer.py:260:stop] epoch=1/micro_step=2756/global_step=8060, RunningAvgSamplesPerSec=3.282391862325356, CurrSamplesPerSec=3.2759950777719067, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:43,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=8070, skipped=0, lr=[9.982341363999965e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:43,208] [INFO] [timer.py:260:stop] epoch=1/micro_step=2766/global_step=8070, RunningAvgSamplesPerSec=3.2823992048189976, CurrSamplesPerSec=3.2923731823692615, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:49,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=8080, skipped=0, lr=[9.982291404492144e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:49,315] [INFO] [timer.py:260:stop] epoch=1/micro_step=2776/global_step=8080, RunningAvgSamplesPerSec=3.28240286697522, CurrSamplesPerSec=3.2798466700708704, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:26:55,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=8090, skipped=0, lr=[9.982241374537202e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:26:55,420] [INFO] [timer.py:260:stop] epoch=1/micro_step=2786/global_step=8090, RunningAvgSamplesPerSec=3.282408746477683, CurrSamplesPerSec=3.28669474860449, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:27:01,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=0, lr=[9.982191274135848e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:27:01,522] [INFO] [timer.py:260:stop] epoch=1/micro_step=2796/global_step=8100, RunningAvgSamplesPerSec=3.282416276366707, CurrSamplesPerSec=3.2933283918666807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
ppl: 89.33192443847656, loss: 4.49235725402832
[2024-05-31 01:32:42,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=8110, skipped=0, lr=[9.982141103288791e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:32:42,709] [INFO] [timer.py:260:stop] epoch=1/micro_step=2806/global_step=8110, RunningAvgSamplesPerSec=3.282418439607095, CurrSamplesPerSec=3.286483572495051, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:32:48,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=8120, skipped=0, lr=[9.982090861996737e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:32:48,819] [INFO] [timer.py:260:stop] epoch=1/micro_step=2816/global_step=8120, RunningAvgSamplesPerSec=3.2824202871017065, CurrSamplesPerSec=3.2868016346617246, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:32:54,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=8130, skipped=0, lr=[9.982040550260399e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:32:54,922] [INFO] [timer.py:260:stop] epoch=1/micro_step=2826/global_step=8130, RunningAvgSamplesPerSec=3.28242598182289, CurrSamplesPerSec=3.2840428538879105, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:01,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=8140, skipped=0, lr=[9.981990168080488e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:01,025] [INFO] [timer.py:260:stop] epoch=1/micro_step=2836/global_step=8140, RunningAvgSamplesPerSec=3.2824318066652647, CurrSamplesPerSec=3.281770086963734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:07,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=0, lr=[9.981939715457717e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:07,132] [INFO] [timer.py:260:stop] epoch=1/micro_step=2846/global_step=8150, RunningAvgSamplesPerSec=3.2824379006579925, CurrSamplesPerSec=3.2846935291372077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:13,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=8160, skipped=0, lr=[9.981889192392797e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:13,237] [INFO] [timer.py:260:stop] epoch=1/micro_step=2856/global_step=8160, RunningAvgSamplesPerSec=3.282442750740291, CurrSamplesPerSec=3.284218999403731, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:19,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=8170, skipped=0, lr=[9.981838598886446e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:19,339] [INFO] [timer.py:260:stop] epoch=1/micro_step=2866/global_step=8170, RunningAvgSamplesPerSec=3.282449156112841, CurrSamplesPerSec=3.2869935318944177, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:25,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=8180, skipped=0, lr=[9.981787934939377e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:25,446] [INFO] [timer.py:260:stop] epoch=1/micro_step=2876/global_step=8180, RunningAvgSamplesPerSec=3.28245300700108, CurrSamplesPerSec=3.2895998845507854, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:31,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=8190, skipped=0, lr=[9.981737200552306e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:31,551] [INFO] [timer.py:260:stop] epoch=1/micro_step=2886/global_step=8190, RunningAvgSamplesPerSec=3.2824576654532884, CurrSamplesPerSec=3.2799030958195607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 01:33:37,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=0, lr=[9.981686395725951e-05], mom=[(0.9, 0.95)]
[2024-05-31 01:33:37,664] [INFO] [timer.py:260:stop] epoch=1/micro_step=2896/global_step=8200, RunningAvgSamplesPerSec=3.282458710269757, CurrSamplesPerSec=3.2864011696671644, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 2/50 *****
[2024-05-31 01:34:54,165] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1041098
[2024-05-31 01:34:54,165] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1041099
[2024-05-31 01:34:54,480] [ERROR] [launch.py:325:sigkill_handler] ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data_wo_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-4', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '10607', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data_wo_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-30-16.37.17'] exits with return code = -9
