[2024-05-31 14:14:52,867] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-31 14:14:53,454] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-31 14:14:53,454] [INFO] [runner.py:568:main] cmd = /home/chanho/anaconda3/envs/COMEDY/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=12341 --enable_each_rank_log=None training/EPISODE/main.py --model_name gemma --model_name_or_path /home/chanho/Model/SHARE/Refactorizing/result/output_path --train_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json --valid_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json --per_device_train_batch_size 1 --per_device_eval_batch_size 1 --data_output_path /home/chanho/Model/SHARE/Refactorizing/result/output_path/data --max_seq_len 2048 --learning_rate 1e-5 --weight_decay 0.1 --num_train_epochs 50 --num_train_samples 14255 /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json --gradient_accumulation_steps 1 --lr_scheduler_type linear --num_warmup_steps 1000 --seed 42 --zero_stage 2 --save_interval 1000 --eval_interval 100 --output_dir /home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50
[2024-05-31 14:14:54,811] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-31 14:14:55,493] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-05-31 14:14:55,493] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-05-31 14:14:55,493] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-05-31 14:14:55,493] [INFO] [launch.py:164:main] dist_world_size=2
[2024-05-31 14:14:55,493] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-05-31 14:14:55,493] [INFO] [launch.py:256:main] process 1419537 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=0', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'linear', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50']
[2024-05-31 14:14:55,494] [INFO] [launch.py:256:main] process 1419538 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'linear', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50']
[2024-05-31 14:14:58,071] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-31 14:14:58,074] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.[93m [WARNING] [0m async_io: please install the libaio-dev package with apt

[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50', seed=42, local_rank=0, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', num_train_samples=14255, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json']
[2024-05-31 14:14:58,491] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-31 14:14:58,491] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50', seed=42, local_rank=1, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', num_train_samples=14255, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json']
[2024-05-31 14:14:58,646] [INFO] [comm.py:637:init_distributed] cdb=None
This model is gemma
This model is gemma
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  1.21s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.66it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.44it/s]
Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  1.46s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.49it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.27it/s]
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06414341926574707 seconds
[2024-05-31 14:15:03,285] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.2, git-hash=unknown, git-branch=unknown
[2024-05-31 14:15:03,285] [INFO] [comm.py:662:init_distributed] Distributed backend already initialized
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06797456741333008 seconds
[2024-05-31 14:15:06,541] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-05-31 14:15:06,542] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-05-31 14:15:06,542] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-31 14:15:06,543] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-31 14:15:06,543] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-05-31 14:15:06,543] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-05-31 14:15:06,543] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 500,000,000
[2024-05-31 14:15:06,543] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 500,000,000
[2024-05-31 14:15:06,543] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-05-31 14:15:06,543] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-05-31 14:15:07,147] [INFO] [utils.py:779:see_memory_usage] Before initializing optimizer states
[2024-05-31 14:15:07,147] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 14:15:07,147] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.34 GB, percent = 17.8%
[2024-05-31 14:15:07,267] [INFO] [utils.py:779:see_memory_usage] After initializing optimizer states
[2024-05-31 14:15:07,268] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 14:15:07,268] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.37 GB, percent = 17.8%
[2024-05-31 14:15:07,268] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-05-31 14:15:07,384] [INFO] [utils.py:779:see_memory_usage] After initializing ZeRO optimizer
[2024-05-31 14:15:07,384] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 14:15:07,384] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.39 GB, percent = 17.8%
[2024-05-31 14:15:07,385] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[2024-05-31 14:15:07,385] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-05-31 14:15:07,385] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f3d28197750>
[2024-05-31 14:15:07,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.95)]
[2024-05-31 14:15:07,386] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3d0c148e50>
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-31 14:15:07,386] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   gradient_clipping ............ 1.0
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   steps_per_print .............. 10
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   train_batch_size ............. 2
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   world_size ................... 2
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='none', nvme_path=None, buffer_count=5, buffer_size=100,000,000, max_in_cpu=1,000,000,000, pin_memory=False) offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='none', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False, ratio=1.0) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=30000000 param_persistence_threshold=10000 model_persistence_threshold=sys.maxsize max_live_parameters=30000000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=False pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-31 14:15:07,387] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-05-31 14:15:07,387] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 2, 
    "train_micro_batch_size_per_gpu": 1, 
    "steps_per_print": 10, 
    "zero_optimization": {
        "stage": 2, 
        "offload_param": {
            "device": "none"
        }, 
        "offload_optimizer": {
            "device": "none"
        }, 
        "stage3_param_persistence_threshold": 1.000000e+04, 
        "stage3_max_live_parameters": 3.000000e+07, 
        "stage3_prefetch_bucket_size": 3.000000e+07, 
        "memory_efficient_linear": false
    }, 
    "bf16": {
        "enabled": true
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": false, 
    "wall_clock_breakdown": false, 
    "hybrid_engine": {
        "enabled": false, 
        "inference_tp_size": 1, 
        "release_inference_cache": false, 
        "pin_parameters": true, 
        "tp_gather_partition_size": 8
    }
}
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240531_141507-wl1evsz2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run whole-voice-290
wandb: ‚≠êÔ∏è View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: üöÄ View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/wl1evsz2
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240531_141508-45cyn6wy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run astral-deluge-291
wandb: ‚≠êÔ∏è View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: üöÄ View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/45cyn6wy
***** Running training *****
***** Evaluating perplexity, Epoch 0/50 *****
Beginning of Epoch 1/50
[2024-05-31 14:15:18,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[1.0000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:18,121] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=3.3616343219307, CurrSamplesPerSec=3.351721448503582, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:24,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[2.0000000000000002e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:24,104] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=3.3570717528080847, CurrSamplesPerSec=3.3383867145977772, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:30,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[3.0000000000000004e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:30,096] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=3.35431586235746, CurrSamplesPerSec=3.3477981681033193, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:36,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[4.0000000000000003e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:36,109] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=3.350026735719931, CurrSamplesPerSec=3.323146206646841, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:42,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[5.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:42,120] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=3.3475196767172046, CurrSamplesPerSec=3.337466271674254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:48,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[6.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:48,156] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=3.343485397415045, CurrSamplesPerSec=3.310818661749476, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:15:54,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[7.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:15:54,201] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=3.3397658675214963, CurrSamplesPerSec=3.3179188648065834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:16:00,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[8.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:16:00,258] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=3.336367357094836, CurrSamplesPerSec=3.310143227897576, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:16:06,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[9.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 14:16:06,324] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=3.3331394820055262, CurrSamplesPerSec=3.309428900566523, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:16:12,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[1.0000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:16:12,399] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=3.3301498690130424, CurrSamplesPerSec=3.299173811146608, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 1263855.125, loss: 14.049392700195312
[2024-05-31 14:18:57,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[1.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:18:57,479] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=3.3258049687582107, CurrSamplesPerSec=3.27986462350759, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:03,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[1.2000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:03,581] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=3.3226615062084854, CurrSamplesPerSec=3.283747177622658, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:09,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[1.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:09,679] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=3.320197898597895, CurrSamplesPerSec=3.2872730464714928, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:15,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[1.4000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:15,778] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=3.3180198313689173, CurrSamplesPerSec=3.2955434031051607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:21,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[1.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:21,880] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=3.3159951271686636, CurrSamplesPerSec=3.2774490885499588, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:27,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[1.6000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:27,989] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=3.3141291817186898, CurrSamplesPerSec=3.2785289117307954, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:34,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.7000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:34,090] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=3.312716663860636, CurrSamplesPerSec=3.291019518317229, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:40,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.8000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:40,188] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=3.311512577407298, CurrSamplesPerSec=3.2933477861614824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:46,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[1.9000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:46,295] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=3.310184296712372, CurrSamplesPerSec=3.2898604891214616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:19:52,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[2.0000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:19:52,396] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=3.309144933184393, CurrSamplesPerSec=3.284645941379506, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 837008.5, loss: 13.63736343383789
[2024-05-31 14:22:37,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[2.1000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:22:37,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=3.3078442248996174, CurrSamplesPerSec=3.282214371598148, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:22:43,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[2.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:22:43,794] [INFO] [timer.py:260:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=3.3069920409250115, CurrSamplesPerSec=3.2845173327173027, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:22:49,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[2.3000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:22:49,897] [INFO] [timer.py:260:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=3.3062014019657626, CurrSamplesPerSec=3.288624918897834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:22:55,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[2.4000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:22:55,998] [INFO] [timer.py:260:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=3.305488491296814, CurrSamplesPerSec=3.283672624187655, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:02,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[2.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:02,103] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=3.3048464696250237, CurrSamplesPerSec=3.2846780951187613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:08,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[2.6e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:08,212] [INFO] [timer.py:260:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=3.304081725972243, CurrSamplesPerSec=3.2858579294563177, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:14,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[2.7000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:14,317] [INFO] [timer.py:260:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=3.30353135057644, CurrSamplesPerSec=3.287265317318808, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:20,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[2.8000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:20,418] [INFO] [timer.py:260:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=3.3030579508339337, CurrSamplesPerSec=3.284675522796455, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:26,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[2.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:26,514] [INFO] [timer.py:260:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=3.302694458569959, CurrSamplesPerSec=3.300297862948422, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:23:32,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:23:32,618] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=3.3022146556923, CurrSamplesPerSec=3.280625260313295, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 349945.78125, loss: 12.76541805267334
[2024-05-31 14:26:17,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[3.1000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:17,816] [INFO] [timer.py:260:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=3.301625221022078, CurrSamplesPerSec=3.287738150714702, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:23,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[3.2000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:23,918] [INFO] [timer.py:260:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=3.3012321103312923, CurrSamplesPerSec=3.288075788024636, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:30,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[3.3000000000000006e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:30,019] [INFO] [timer.py:260:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=3.3009073794945842, CurrSamplesPerSec=3.2842434298359016, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:36,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[3.4000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:36,125] [INFO] [timer.py:260:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=3.3005072335785153, CurrSamplesPerSec=3.286966484619225, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:42,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[3.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:42,222] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=3.3002294359548854, CurrSamplesPerSec=3.289392204532978, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:48,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[3.6000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:48,322] [INFO] [timer.py:260:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=3.299953511988897, CurrSamplesPerSec=3.278516098270188, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:26:54,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[3.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:26:54,417] [INFO] [timer.py:260:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=3.299760801719845, CurrSamplesPerSec=3.2910272651340775, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:27:00,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=0, lr=[3.8000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:27:00,519] [INFO] [timer.py:260:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=3.299495913792829, CurrSamplesPerSec=3.2869394377891488, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:27:06,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=0, lr=[3.900000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:27:06,620] [INFO] [timer.py:260:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=3.2992717481669587, CurrSamplesPerSec=3.2857034863612844, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:27:12,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[4.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:27:12,723] [INFO] [timer.py:260:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=3.2990019841742138, CurrSamplesPerSec=3.2902643787624672, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 101253.421875, loss: 11.525373458862305
[2024-05-31 14:29:57,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[4.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:29:57,819] [INFO] [timer.py:260:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=3.298650159108271, CurrSamplesPerSec=3.2879842840411837, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:03,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[4.2000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:03,919] [INFO] [timer.py:260:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=3.2984429463263427, CurrSamplesPerSec=3.271397083254687, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:10,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[4.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:10,023] [INFO] [timer.py:260:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=3.2982123662604486, CurrSamplesPerSec=3.291846051032473, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:16,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[4.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:16,129] [INFO] [timer.py:260:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=3.2979790355846466, CurrSamplesPerSec=3.2855156001721757, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:22,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[4.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:22,238] [INFO] [timer.py:260:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=3.297728855260284, CurrSamplesPerSec=3.2832279447105037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:28,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[4.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:28,341] [INFO] [timer.py:260:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=3.297525618434248, CurrSamplesPerSec=3.2821694240421437, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:34,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[4.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:34,441] [INFO] [timer.py:260:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=3.2974029031224914, CurrSamplesPerSec=3.295571886424941, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:40,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[4.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:40,548] [INFO] [timer.py:260:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=3.2971748771722056, CurrSamplesPerSec=3.283017213848726, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:46,648] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[4.9000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:46,649] [INFO] [timer.py:260:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=3.2970418278995717, CurrSamplesPerSec=3.2878077344107948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:30:52,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:30:52,755] [INFO] [timer.py:260:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=3.296878030651976, CurrSamplesPerSec=3.293407263423254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 27129.04296875, loss: 10.20834732055664
[2024-05-31 14:33:37,829] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[5.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:33:37,830] [INFO] [timer.py:260:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=3.2966503585211324, CurrSamplesPerSec=3.28516819601806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:33:43,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[5.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:33:43,938] [INFO] [timer.py:260:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=3.2964622058289685, CurrSamplesPerSec=3.2865080366300767, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:33:50,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[5.300000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:33:50,047] [INFO] [timer.py:260:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=3.2962778420405208, CurrSamplesPerSec=3.2745334089060227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:33:56,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[5.400000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:33:56,151] [INFO] [timer.py:260:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=3.2961432811976183, CurrSamplesPerSec=3.2804687429730985, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:02,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[5.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:02,258] [INFO] [timer.py:260:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=3.2959770993751025, CurrSamplesPerSec=3.282070543752096, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:08,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[5.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:08,361] [INFO] [timer.py:260:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=3.295866595638985, CurrSamplesPerSec=3.2890323739187814, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:14,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[5.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:14,461] [INFO] [timer.py:260:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=3.2958008535815013, CurrSamplesPerSec=3.2823569277049507, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:20,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[5.8e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:20,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=3.2957574275653623, CurrSamplesPerSec=3.279162021393535, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:26,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[5.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:26,655] [INFO] [timer.py:260:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=3.2957083207794664, CurrSamplesPerSec=3.2902101769477627, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:34:32,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[6e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:34:32,750] [INFO] [timer.py:260:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=3.2956522035512843, CurrSamplesPerSec=3.295662518445415, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 9899.54296875, loss: 9.200166702270508
[2024-05-31 14:37:17,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=0, lr=[6.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:17,841] [INFO] [timer.py:260:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=3.295479558050513, CurrSamplesPerSec=3.2845083304881144, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:23,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=0, lr=[6.200000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:23,938] [INFO] [timer.py:260:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=3.2954300005480834, CurrSamplesPerSec=3.2857215039742678, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:30,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=0, lr=[6.300000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:30,036] [INFO] [timer.py:260:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=3.2953628085450823, CurrSamplesPerSec=3.278774949598547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:36,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=0, lr=[6.4000000000000006e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:36,136] [INFO] [timer.py:260:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=3.295296487806828, CurrSamplesPerSec=3.280357137270728, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:42,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[6.5000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:42,232] [INFO] [timer.py:260:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=3.2952640025684423, CurrSamplesPerSec=3.2896321353529823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:48,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=0, lr=[6.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:48,329] [INFO] [timer.py:260:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=3.2952154593282796, CurrSamplesPerSec=3.296468067681943, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:37:54,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=0, lr=[6.700000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:37:54,428] [INFO] [timer.py:260:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=3.2951707891094197, CurrSamplesPerSec=3.289089116170379, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:38:00,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=0, lr=[6.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:38:00,525] [INFO] [timer.py:260:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=3.295134911831511, CurrSamplesPerSec=3.2896798677007677, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:38:06,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=0, lr=[6.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:38:06,622] [INFO] [timer.py:260:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=3.2950791357069615, CurrSamplesPerSec=3.2887886624209814, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:38:12,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:38:12,720] [INFO] [timer.py:260:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=3.2950231479428496, CurrSamplesPerSec=3.2940939934656948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 3300.356201171875, loss: 8.101763725280762
[2024-05-31 14:40:57,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=0, lr=[7.100000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:40:57,941] [INFO] [timer.py:260:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=3.2949648937844156, CurrSamplesPerSec=3.2917285030941104, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:04,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=0, lr=[7.2000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:04,041] [INFO] [timer.py:260:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=3.2949181022862533, CurrSamplesPerSec=3.2899043573170164, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:10,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=0, lr=[7.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:10,154] [INFO] [timer.py:260:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=3.2947748257297915, CurrSamplesPerSec=3.2785929805362306, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:16,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=0, lr=[7.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:16,259] [INFO] [timer.py:260:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=3.294687100201632, CurrSamplesPerSec=3.282908004228179, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:22,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[7.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:22,363] [INFO] [timer.py:260:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=3.294604265947648, CurrSamplesPerSec=3.2782137296709206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:28,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[7.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:28,466] [INFO] [timer.py:260:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=3.294526366107406, CurrSamplesPerSec=3.2871699940907333, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:34,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[7.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:34,566] [INFO] [timer.py:260:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=3.2944755968553943, CurrSamplesPerSec=3.2916781279760983, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:40,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=0, lr=[7.800000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:40,666] [INFO] [timer.py:260:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=3.294414845882226, CurrSamplesPerSec=3.2826870375740245, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:46,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=0, lr=[7.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:46,763] [INFO] [timer.py:260:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=3.294400193568235, CurrSamplesPerSec=3.2936904563715803, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:41:52,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[8.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:41:52,861] [INFO] [timer.py:260:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=3.294366419398135, CurrSamplesPerSec=3.2925437610072223, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 987.380615234375, loss: 6.895054817199707
[2024-05-31 14:44:37,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=0, lr=[8.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:44:37,862] [INFO] [timer.py:260:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=3.2942506833497203, CurrSamplesPerSec=3.2880061929819404, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:44:43,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=0, lr=[8.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:44:43,967] [INFO] [timer.py:260:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=3.2941829374737774, CurrSamplesPerSec=3.2934990695008284, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:44:50,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=0, lr=[8.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:44:50,074] [INFO] [timer.py:260:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=3.294113188996512, CurrSamplesPerSec=3.279182531057722, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:44:56,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=0, lr=[8.400000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:44:56,174] [INFO] [timer.py:260:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=3.2940819116614075, CurrSamplesPerSec=3.285946740810553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:02,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[8.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:02,277] [INFO] [timer.py:260:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=3.2940277417217096, CurrSamplesPerSec=3.291102152910598, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:08,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=0, lr=[8.6e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:08,385] [INFO] [timer.py:260:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=3.2939394173796623, CurrSamplesPerSec=3.2759093621421678, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:14,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=0, lr=[8.700000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:14,493] [INFO] [timer.py:260:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=3.293867034895675, CurrSamplesPerSec=3.2831688345438845, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:20,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=0, lr=[8.8e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:20,600] [INFO] [timer.py:260:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=3.2937940417292824, CurrSamplesPerSec=3.2829478327774746, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:26,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=0, lr=[8.900000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:26,704] [INFO] [timer.py:260:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=3.293742301425603, CurrSamplesPerSec=3.285137319204246, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:45:32,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=0, lr=[9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:45:32,803] [INFO] [timer.py:260:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=3.2937094948962637, CurrSamplesPerSec=3.2778191969065382, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 403.3109130859375, loss: 5.999696731567383
[2024-05-31 14:48:18,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=0, lr=[9.100000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:18,034] [INFO] [timer.py:260:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=3.293619145129247, CurrSamplesPerSec=3.286273710932297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:24,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=0, lr=[9.200000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:24,136] [INFO] [timer.py:260:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=3.2935837472492233, CurrSamplesPerSec=3.2781547999134015, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:30,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=0, lr=[9.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:30,240] [INFO] [timer.py:260:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=3.2935432382295025, CurrSamplesPerSec=3.289014319976569, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:36,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=0, lr=[9.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:36,342] [INFO] [timer.py:260:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=3.2935069823937226, CurrSamplesPerSec=3.2872434182502457, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:42,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=0, lr=[9.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:42,447] [INFO] [timer.py:260:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=3.2934789177729518, CurrSamplesPerSec=3.2845764914510487, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:48,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=0, lr=[9.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:48,548] [INFO] [timer.py:260:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=3.2934461728751305, CurrSamplesPerSec=3.286802922487931, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:48:54,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=0, lr=[9.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:48:54,661] [INFO] [timer.py:260:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=3.293351840025381, CurrSamplesPerSec=3.279803069685681, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:49:00,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=0, lr=[9.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:49:00,771] [INFO] [timer.py:260:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=3.293280799473254, CurrSamplesPerSec=3.2737551519465686, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:49:06,881] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=0, lr=[9.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:49:06,882] [INFO] [timer.py:260:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=3.293213082974505, CurrSamplesPerSec=3.2870824046470366, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:49:12,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=0, lr=[1e-05], mom=[(0.9, 0.95)]
[2024-05-31 14:49:12,992] [INFO] [timer.py:260:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=3.2931485812259575, CurrSamplesPerSec=3.2883864240409566, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 271.44915771484375, loss: 5.603771686553955
saving model ... to step 1000
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-31 14:51:59,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=0, lr=[9.99971862689927e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:51:59,001] [INFO] [timer.py:260:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=3.2931311320293144, CurrSamplesPerSec=3.2901817862336973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:05,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=0, lr=[9.999437253798538e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:05,101] [INFO] [timer.py:260:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=3.293109099818869, CurrSamplesPerSec=3.2850446922451857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:11,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=0, lr=[9.999155880697807e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:11,203] [INFO] [timer.py:260:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=3.293069766505812, CurrSamplesPerSec=3.277960090563301, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:17,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=0, lr=[9.998874507597074e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:17,310] [INFO] [timer.py:260:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=3.29301278151504, CurrSamplesPerSec=3.3037513843400617, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:23,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=0, lr=[9.998593134496342e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:23,414] [INFO] [timer.py:260:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=3.2929608983519576, CurrSamplesPerSec=3.280662467451914, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:29,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=0, lr=[9.998311761395611e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:29,517] [INFO] [timer.py:260:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=3.2929228590217643, CurrSamplesPerSec=3.2859608995860725, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:35,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=0, lr=[9.99803038829488e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:35,612] [INFO] [timer.py:260:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=3.2929173954916204, CurrSamplesPerSec=3.2946839563505654, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:41,713] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=0, lr=[9.997749015194148e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:41,713] [INFO] [timer.py:260:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=3.292878623451762, CurrSamplesPerSec=3.2875977037081165, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:47,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=0, lr=[9.997467642093417e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:47,812] [INFO] [timer.py:260:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=3.2928496474353155, CurrSamplesPerSec=3.2824070179255425, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:52:53,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=0, lr=[9.997186268992685e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:52:53,912] [INFO] [timer.py:260:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=3.292827379934696, CurrSamplesPerSec=3.2863161960787233, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 215.66778564453125, loss: 5.373730659484863
[2024-05-31 14:55:39,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=0, lr=[9.996904895891954e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:55:39,403] [INFO] [timer.py:260:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=3.2927723092222703, CurrSamplesPerSec=3.2934499332170684, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:55:45,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=0, lr=[9.996623522791222e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:55:45,505] [INFO] [timer.py:260:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=3.2927512333998283, CurrSamplesPerSec=3.294637372650365, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:55:51,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=0, lr=[9.99634214969049e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:55:51,604] [INFO] [timer.py:260:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=3.2927467471366865, CurrSamplesPerSec=3.2799518287104013, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:55:57,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=0, lr=[9.996060776589758e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:55:57,701] [INFO] [timer.py:260:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=3.292738306681371, CurrSamplesPerSec=3.286106355890706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:03,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=0, lr=[9.995779403489028e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:03,803] [INFO] [timer.py:260:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=3.2927111272923377, CurrSamplesPerSec=3.280368682336057, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:09,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=0, lr=[9.995498030388295e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:09,908] [INFO] [timer.py:260:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=3.292674541451386, CurrSamplesPerSec=3.294476927765542, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:16,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=0, lr=[9.995216657287565e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:16,010] [INFO] [timer.py:260:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=3.2926549349600416, CurrSamplesPerSec=3.2811603545023504, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:22,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=0, lr=[9.994935284186834e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:22,110] [INFO] [timer.py:260:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=3.2926435421700093, CurrSamplesPerSec=3.2953479172420077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:28,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=0, lr=[9.994653911086101e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:28,211] [INFO] [timer.py:260:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=3.2926154335437667, CurrSamplesPerSec=3.292910823462448, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:56:34,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=0, lr=[9.994372537985369e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:56:34,312] [INFO] [timer.py:260:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=3.292592665288899, CurrSamplesPerSec=3.2866998995803374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 183.1925048828125, loss: 5.210536479949951
[2024-05-31 14:59:19,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=0, lr=[9.994091164884638e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:19,768] [INFO] [timer.py:260:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=3.292563039079607, CurrSamplesPerSec=3.2912222387006813, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:25,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=0, lr=[9.993809791783906e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:25,867] [INFO] [timer.py:260:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=3.292541857528131, CurrSamplesPerSec=3.279444051766737, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:31,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=0, lr=[9.993528418683175e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:31,969] [INFO] [timer.py:260:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=3.292513349452714, CurrSamplesPerSec=3.270030015982536, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:38,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=0, lr=[9.993247045582442e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:38,060] [INFO] [timer.py:260:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=3.2925352460610693, CurrSamplesPerSec=3.29416514006452, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:44,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=0, lr=[9.992965672481712e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:44,144] [INFO] [timer.py:260:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=3.2925763222302185, CurrSamplesPerSec=3.288046145331454, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:50,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=0, lr=[9.992684299380981e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:50,229] [INFO] [timer.py:260:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=3.2926238925141966, CurrSamplesPerSec=3.2941573784680296, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 14:59:56,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=0, lr=[9.992402926280249e-06], mom=[(0.9, 0.95)]
[2024-05-31 14:59:56,326] [INFO] [timer.py:260:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=3.292622502235275, CurrSamplesPerSec=3.2976006465784957, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:00:02,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=0, lr=[9.992121553179516e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:00:02,411] [INFO] [timer.py:260:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=3.2926610041285893, CurrSamplesPerSec=3.2874057359269613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:00:08,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=0, lr=[9.991840180078785e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:00:08,504] [INFO] [timer.py:260:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=3.2926931572470197, CurrSamplesPerSec=3.2906554590598462, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:00:14,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=0, lr=[9.991558806978053e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:00:14,610] [INFO] [timer.py:260:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=3.292662563018699, CurrSamplesPerSec=3.2836019300919053, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 165.64630126953125, loss: 5.109853744506836
[2024-05-31 15:03:00,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=0, lr=[9.991277433877322e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:00,153] [INFO] [timer.py:260:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=3.2926196050986207, CurrSamplesPerSec=3.2884328311401583, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:06,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=0, lr=[9.990996060776591e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:06,248] [INFO] [timer.py:260:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=3.29262106921955, CurrSamplesPerSec=3.292570900147503, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:12,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=0, lr=[9.990714687675859e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:12,346] [INFO] [timer.py:260:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=3.292612249075978, CurrSamplesPerSec=3.3013473227691055, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:18,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=0, lr=[9.990433314575128e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:18,445] [INFO] [timer.py:260:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=3.292603875703259, CurrSamplesPerSec=3.2937693452714, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:24,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=0, lr=[9.990151941474396e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:24,580] [INFO] [timer.py:260:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=3.2924574993236972, CurrSamplesPerSec=3.163924520900831, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:30,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=0, lr=[9.989870568373663e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:30,791] [INFO] [timer.py:260:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=3.292003734907324, CurrSamplesPerSec=3.287400582738479, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:36,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=0, lr=[9.989589195272933e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:36,922] [INFO] [timer.py:260:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=3.2918865575750718, CurrSamplesPerSec=3.2948935993043045, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:43,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=0, lr=[9.9893078221722e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:43,093] [INFO] [timer.py:260:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=3.2916085050185386, CurrSamplesPerSec=3.2765184241979206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:49,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=0, lr=[9.98902644907147e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:49,196] [INFO] [timer.py:260:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=3.291586900749121, CurrSamplesPerSec=3.277563057649359, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:03:55,290] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=0, lr=[9.988745075970739e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:03:55,291] [INFO] [timer.py:260:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=3.2915906778385082, CurrSamplesPerSec=3.295201641667688, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 152.40371704101562, loss: 5.026532173156738
[2024-05-31 15:06:40,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=0, lr=[9.988463702870006e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:06:40,990] [INFO] [timer.py:260:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=3.2915883341522476, CurrSamplesPerSec=3.2913875323994546, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:06:47,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=0, lr=[9.988182329769275e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:06:47,085] [INFO] [timer.py:260:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=3.2915936281846148, CurrSamplesPerSec=3.2861449747720077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:06:53,179] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=0, lr=[9.987900956668543e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:06:53,180] [INFO] [timer.py:260:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=3.291602189214878, CurrSamplesPerSec=3.29669348474702, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:06:59,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=0, lr=[9.98761958356781e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:06:59,276] [INFO] [timer.py:260:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=3.2916086210725997, CurrSamplesPerSec=3.292709187476522, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:05,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=0, lr=[9.98733821046708e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:05,379] [INFO] [timer.py:260:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=3.2915969808212027, CurrSamplesPerSec=3.2910982793213326, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:11,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=0, lr=[9.987056837366349e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:11,479] [INFO] [timer.py:260:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=3.291580178999648, CurrSamplesPerSec=3.2893277129693166, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:17,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=0, lr=[9.986775464265617e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:17,577] [INFO] [timer.py:260:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=3.291579737636333, CurrSamplesPerSec=3.2938081444772833, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:23,674] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=0, lr=[9.986494091164886e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:23,675] [INFO] [timer.py:260:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=3.291573153743402, CurrSamplesPerSec=3.2870373236646793, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:29,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=0, lr=[9.986212718064155e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:29,775] [INFO] [timer.py:260:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=3.291564209784151, CurrSamplesPerSec=3.29326891745361, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:07:35,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=0, lr=[9.985931344963423e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:07:35,877] [INFO] [timer.py:260:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=3.2915579899484335, CurrSamplesPerSec=3.2776898415780846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 142.81639099121094, loss: 4.961557388305664
[2024-05-31 15:10:21,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=0, lr=[9.98564997186269e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:21,592] [INFO] [timer.py:260:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=3.2915501987918057, CurrSamplesPerSec=3.2939892195248563, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:27,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=0, lr=[9.98536859876196e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:27,690] [INFO] [timer.py:260:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=3.291546338161503, CurrSamplesPerSec=3.303673317643204, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:33,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=0, lr=[9.985087225661227e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:33,794] [INFO] [timer.py:260:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=3.291524906373639, CurrSamplesPerSec=3.2897701759319067, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:39,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=0, lr=[9.984805852560496e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:39,898] [INFO] [timer.py:260:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=3.291501314966434, CurrSamplesPerSec=3.278653207496581, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:46,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=0, lr=[9.984524479459764e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:46,001] [INFO] [timer.py:260:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=3.291484007277842, CurrSamplesPerSec=3.292029494258007, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:52,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=0, lr=[9.984243106359033e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:52,103] [INFO] [timer.py:260:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=3.291470540260975, CurrSamplesPerSec=3.2999719908230607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:10:58,205] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=0, lr=[9.983961733258302e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:10:58,206] [INFO] [timer.py:260:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=3.2914545789861513, CurrSamplesPerSec=3.284051853565706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:11:04,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=0, lr=[9.98368036015757e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:11:04,303] [INFO] [timer.py:260:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=3.2914484979709404, CurrSamplesPerSec=3.2924920686443477, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:11:10,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=0, lr=[9.983398987056837e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:11:10,404] [INFO] [timer.py:260:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=3.2914421788312995, CurrSamplesPerSec=3.2881247640800364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:11:16,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=0, lr=[9.983117613956107e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:11:16,506] [INFO] [timer.py:260:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=3.291434280434173, CurrSamplesPerSec=3.2831611246790655, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 134.86944580078125, loss: 4.904304027557373
[2024-05-31 15:14:02,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=0, lr=[9.982836240855374e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:02,260] [INFO] [timer.py:260:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=3.2913775809317336, CurrSamplesPerSec=3.291701377838975, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:08,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=0, lr=[9.982554867754643e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:08,365] [INFO] [timer.py:260:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=3.2913558777028804, CurrSamplesPerSec=3.2826151013612006, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:14,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=0, lr=[9.982273494653913e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:14,470] [INFO] [timer.py:260:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=3.2913378443443237, CurrSamplesPerSec=3.281458132364458, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:20,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=0, lr=[9.98199212155318e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:20,567] [INFO] [timer.py:260:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=3.2913390574881776, CurrSamplesPerSec=3.293184881184236, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:26,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=0, lr=[9.98171074845245e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:26,665] [INFO] [timer.py:260:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=3.291332628294818, CurrSamplesPerSec=3.2895405447269406, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:32,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=0, lr=[9.981429375351717e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:32,766] [INFO] [timer.py:260:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=3.2913167939108328, CurrSamplesPerSec=3.2864333577799925, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:38,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=0, lr=[9.981148002250985e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:38,862] [INFO] [timer.py:260:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=3.291325992032894, CurrSamplesPerSec=3.292148355713061, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:44,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=0, lr=[9.980866629150254e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:44,965] [INFO] [timer.py:260:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=3.2913173869057535, CurrSamplesPerSec=3.2969111580641917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:51,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=0, lr=[9.980585256049521e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:51,073] [INFO] [timer.py:260:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=3.2912855537791232, CurrSamplesPerSec=3.2838474444765446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:14:57,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=0, lr=[9.98030388294879e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:14:57,166] [INFO] [timer.py:260:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=3.29129237150482, CurrSamplesPerSec=3.2886030017108276, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 128.5625457763672, loss: 4.856410026550293
[2024-05-31 15:17:42,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=0, lr=[9.98002250984806e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:17:42,721] [INFO] [timer.py:260:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=3.2912601742475314, CurrSamplesPerSec=3.287798714135883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:17:48,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=0, lr=[9.979741136747327e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:17:48,826] [INFO] [timer.py:260:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=3.291238910584676, CurrSamplesPerSec=3.2938055578351197, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:17:54,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=0, lr=[9.979459763646597e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:17:54,920] [INFO] [timer.py:260:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=3.2912589176358114, CurrSamplesPerSec=3.275970769898869, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:01,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=0, lr=[9.979178390545864e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:01,015] [INFO] [timer.py:260:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=3.2912726927407308, CurrSamplesPerSec=3.295600370237087, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:07,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=0, lr=[9.978897017445134e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:07,104] [INFO] [timer.py:260:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=3.2912989497442635, CurrSamplesPerSec=3.287672435483909, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:13,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=0, lr=[9.978615644344401e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:13,203] [INFO] [timer.py:260:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=3.2912948854047746, CurrSamplesPerSec=3.2953220268139947, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:19,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=0, lr=[9.97833427124367e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:19,297] [INFO] [timer.py:260:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=3.291302413975423, CurrSamplesPerSec=3.2920424135656225, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:25,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=0, lr=[9.978052898142938e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:25,392] [INFO] [timer.py:260:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=3.2913079281168423, CurrSamplesPerSec=3.288168585997917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:31,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=0, lr=[9.977771525042207e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:31,494] [INFO] [timer.py:260:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=3.2912970696277486, CurrSamplesPerSec=3.2881956530601366, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:18:37,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=0, lr=[9.977490151941476e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:18:37,602] [INFO] [timer.py:260:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=3.291287871118997, CurrSamplesPerSec=3.2856172619490587, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 124.15792846679688, loss: 4.821547508239746
[2024-05-31 15:21:23,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=0, lr=[9.977208778840744e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:23,144] [INFO] [timer.py:260:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=3.2912579774564987, CurrSamplesPerSec=3.291311340272522, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:29,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=0, lr=[9.976927405740012e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:29,242] [INFO] [timer.py:260:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=3.2912490350070724, CurrSamplesPerSec=3.2853174421341578, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:35,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=0, lr=[9.97664603263928e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:35,338] [INFO] [timer.py:260:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=3.291252555383681, CurrSamplesPerSec=3.286448808298113, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:41,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=0, lr=[9.976364659538548e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:41,434] [INFO] [timer.py:260:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=3.291253215250687, CurrSamplesPerSec=3.3012745664046066, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:47,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=0, lr=[9.976083286437818e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:47,536] [INFO] [timer.py:260:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=3.291239700585166, CurrSamplesPerSec=3.288808003283865, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:53,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=0, lr=[9.975801913337085e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:53,644] [INFO] [timer.py:260:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=3.2912194809810713, CurrSamplesPerSec=3.2892245317272666, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:21:59,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=0, lr=[9.975520540236354e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:21:59,744] [INFO] [timer.py:260:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=3.2912158562180895, CurrSamplesPerSec=3.2850189634613165, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:22:05,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=0, lr=[9.975239167135624e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:22:05,841] [INFO] [timer.py:260:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=3.2912249512415803, CurrSamplesPerSec=3.286007238249987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:22:11,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=0, lr=[9.974957794034891e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:22:11,937] [INFO] [timer.py:260:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=3.2912302983533244, CurrSamplesPerSec=3.278085624205743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:22:18,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=0, lr=[9.974676420934159e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:22:18,039] [INFO] [timer.py:260:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=3.2912227509994985, CurrSamplesPerSec=3.288457324303929, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 119.18571472167969, loss: 4.780678749084473
[2024-05-31 15:25:03,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=0, lr=[9.974395047833428e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:03,508] [INFO] [timer.py:260:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=3.2912213758091275, CurrSamplesPerSec=3.294028023910994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:09,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=0, lr=[9.974113674732696e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:09,605] [INFO] [timer.py:260:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=3.2912318015616147, CurrSamplesPerSec=3.297852148362712, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:15,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=0, lr=[9.973832301631965e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:15,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=3.291254171031641, CurrSamplesPerSec=3.2942738062559176, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:21,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=0, lr=[9.973550928531234e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:21,791] [INFO] [timer.py:260:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=3.2912589796379303, CurrSamplesPerSec=3.279632526373364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:27,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=0, lr=[9.973269555430502e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:27,891] [INFO] [timer.py:260:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=3.291262874469996, CurrSamplesPerSec=3.2872846402686693, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:33,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=0, lr=[9.972988182329771e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:33,985] [INFO] [timer.py:260:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=3.29128138200003, CurrSamplesPerSec=3.2947292473220484, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:40,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=0, lr=[9.972706809229038e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:40,074] [INFO] [timer.py:260:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=3.2913107562724946, CurrSamplesPerSec=3.2890581656086217, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:46,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=0, lr=[9.972425436128308e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:46,172] [INFO] [timer.py:260:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=3.2913170534824534, CurrSamplesPerSec=3.285272409549941, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:52,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=0, lr=[9.972144063027575e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:52,266] [INFO] [timer.py:260:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=3.291328632143435, CurrSamplesPerSec=3.287919847672323, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:25:58,353] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=0, lr=[9.971862689926843e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:25:58,353] [INFO] [timer.py:260:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=3.291352286913543, CurrSamplesPerSec=3.289406393016361, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 114.87118530273438, loss: 4.743807792663574
saving model ... to step 2000
[2024-05-31 15:28:44,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=0, lr=[9.971581316826112e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:28:44,473] [INFO] [timer.py:260:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=3.2913632489594775, CurrSamplesPerSec=3.293407263423254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:28:50,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=0, lr=[9.971299943725381e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:28:50,569] [INFO] [timer.py:260:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=3.29136824757773, CurrSamplesPerSec=3.2915657582687334, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:28:56,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=0, lr=[9.971018570624649e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:28:56,669] [INFO] [timer.py:260:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=3.2913635546651814, CurrSamplesPerSec=3.290330197652613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:02,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=0, lr=[9.970737197523918e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:02,766] [INFO] [timer.py:260:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=3.291368741621385, CurrSamplesPerSec=3.2832742063255984, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:08,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=0, lr=[9.970455824423186e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:08,858] [INFO] [timer.py:260:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=3.29138492496526, CurrSamplesPerSec=3.301968480846389, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:14,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=0, lr=[9.970174451322455e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:14,962] [INFO] [timer.py:260:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=3.2913683211992635, CurrSamplesPerSec=3.2857961504760493, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:21,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=0, lr=[9.969893078221722e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:21,063] [INFO] [timer.py:260:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=3.291358747307186, CurrSamplesPerSec=3.2912119083957485, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:27,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=0, lr=[9.969611705120992e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:27,158] [INFO] [timer.py:260:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=3.2913636164095728, CurrSamplesPerSec=3.286182307220106, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:33,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=0, lr=[9.96933033202026e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:33,255] [INFO] [timer.py:260:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=3.291362538504258, CurrSamplesPerSec=3.288800266911414, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:29:39,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=0, lr=[9.969048958919528e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:29:39,357] [INFO] [timer.py:260:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=3.2913503752013935, CurrSamplesPerSec=3.2796953560565187, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 110.9764404296875, loss: 4.709317684173584
[2024-05-31 15:32:25,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=0, lr=[9.968767585818796e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:25,012] [INFO] [timer.py:260:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=3.2913640364081496, CurrSamplesPerSec=3.28250463403, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:32:31,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=0, lr=[9.968486212718065e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:31,113] [INFO] [timer.py:260:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=3.2913605816577265, CurrSamplesPerSec=3.286586581841162, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:32:37,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=0, lr=[9.968204839617333e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:37,208] [INFO] [timer.py:260:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=3.291368992589253, CurrSamplesPerSec=3.2962893105486186, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:32:43,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=0, lr=[9.967923466516602e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:43,305] [INFO] [timer.py:260:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=3.291374727560417, CurrSamplesPerSec=3.289723731079479, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:32:49,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=0, lr=[9.96764209341587e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:49,398] [INFO] [timer.py:260:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=3.2913919736221167, CurrSamplesPerSec=3.290873626744374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:32:55,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=0, lr=[9.967360720315139e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:32:55,495] [INFO] [timer.py:260:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=3.2913971295231943, CurrSamplesPerSec=3.2880848098199524, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:33:01,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=0, lr=[9.967079347214406e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:33:01,593] [INFO] [timer.py:260:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=3.2914041297561, CurrSamplesPerSec=3.2908516795739935, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:33:07,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=0, lr=[9.966797974113676e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:33:07,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=3.291402050583171, CurrSamplesPerSec=3.282597117800616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:33:13,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=0, lr=[9.966516601012945e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:33:13,789] [INFO] [timer.py:260:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=3.2914068318327887, CurrSamplesPerSec=3.279263290354434, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:33:19,884] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=0, lr=[9.966235227912213e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:33:19,885] [INFO] [timer.py:260:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=3.2914112540749065, CurrSamplesPerSec=3.287206061689034, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 105.9686508178711, loss: 4.663142204284668
[2024-05-31 15:36:05,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=0, lr=[9.965953854811482e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:05,355] [INFO] [timer.py:260:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=3.29140463271539, CurrSamplesPerSec=3.2928384384723874, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:11,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=0, lr=[9.96567248171075e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:11,444] [INFO] [timer.py:260:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=3.2914240070291116, CurrSamplesPerSec=3.303973894668849, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:17,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=0, lr=[9.965391108610017e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:17,539] [INFO] [timer.py:260:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=3.29143049998052, CurrSamplesPerSec=3.287769076438226, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:23,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=0, lr=[9.965109735509286e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:23,635] [INFO] [timer.py:260:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=3.2914317973740035, CurrSamplesPerSec=3.290889119040894, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:29,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=0, lr=[9.964828362408555e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:29,731] [INFO] [timer.py:260:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=3.29143527261565, CurrSamplesPerSec=3.2742100486919528, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:35,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=0, lr=[9.964546989307823e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:35,824] [INFO] [timer.py:260:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=3.291446744414206, CurrSamplesPerSec=3.279026151348064, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:41,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=0, lr=[9.964265616207092e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:41,910] [INFO] [timer.py:260:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=3.2914689697241504, CurrSamplesPerSec=3.3047223218049377, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:48,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=0, lr=[9.96398424310636e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:48,004] [INFO] [timer.py:260:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=3.2914772472807785, CurrSamplesPerSec=3.287302675226828, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:36:54,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=0, lr=[9.963702870005629e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:36:54,098] [INFO] [timer.py:260:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=3.291483301342861, CurrSamplesPerSec=3.288970475513492, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:37:00,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=0, lr=[9.963421496904897e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:37:00,188] [INFO] [timer.py:260:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=3.29149830112303, CurrSamplesPerSec=3.2987210321086846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 101.78713989257812, loss: 4.6228837966918945
[2024-05-31 15:39:45,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=0, lr=[9.963140123804164e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:39:45,837] [INFO] [timer.py:260:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=3.291492242179561, CurrSamplesPerSec=3.298386392822401, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:39:51,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=0, lr=[9.962858750703433e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:39:51,935] [INFO] [timer.py:260:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=3.2914921871406357, CurrSamplesPerSec=3.2932456454419254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:39:58,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=0, lr=[9.962577377602703e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:39:58,034] [INFO] [timer.py:260:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=3.2914904926760133, CurrSamplesPerSec=3.284464606076837, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:04,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=0, lr=[9.96229600450197e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:04,135] [INFO] [timer.py:260:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=3.291485261911801, CurrSamplesPerSec=3.2940939934656948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:10,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=0, lr=[9.96201463140124e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:10,237] [INFO] [timer.py:260:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=3.291476842585669, CurrSamplesPerSec=3.2819036165224125, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:16,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=0, lr=[9.961733258300507e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:16,335] [INFO] [timer.py:260:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=3.2914844532339522, CurrSamplesPerSec=3.2860574399440927, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:22,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=0, lr=[9.961451885199776e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:22,435] [INFO] [timer.py:260:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=3.2914785959767427, CurrSamplesPerSec=3.2842395723750792, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:28,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=0, lr=[9.961170512099044e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:28,535] [INFO] [timer.py:260:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=3.2914751385351453, CurrSamplesPerSec=3.2844530321628325, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:34,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=0, lr=[9.960889138998313e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:34,629] [INFO] [timer.py:260:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=3.2914841155273216, CurrSamplesPerSec=3.2869265585026994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:40:40,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=0, lr=[9.96060776589758e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:40:40,723] [INFO] [timer.py:260:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=3.291489290218629, CurrSamplesPerSec=3.29231115815567, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 98.54776763916016, loss: 4.590541362762451
[2024-05-31 15:43:26,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=0, lr=[9.96032639279685e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:26,398] [INFO] [timer.py:260:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=3.2914854559821656, CurrSamplesPerSec=3.287327151557997, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:43:32,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=0, lr=[9.960045019696117e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:32,497] [INFO] [timer.py:260:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=3.2914864861694624, CurrSamplesPerSec=3.287874743716824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:43:38,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=0, lr=[9.959763646595387e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:38,591] [INFO] [timer.py:260:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=3.291491297801676, CurrSamplesPerSec=3.290104359503743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:43:44,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=0, lr=[9.959482273494654e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:44,680] [INFO] [timer.py:260:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=3.291506022238468, CurrSamplesPerSec=3.3036134690074364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:43:50,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=0, lr=[9.959200900393923e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:50,775] [INFO] [timer.py:260:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=3.2915149898068896, CurrSamplesPerSec=3.2968904260336425, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:43:56,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=0, lr=[9.958919527293191e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:43:56,863] [INFO] [timer.py:260:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=3.291533336079726, CurrSamplesPerSec=3.295760924569162, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:44:02,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=0, lr=[9.95863815419246e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:44:02,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=3.2915439635703523, CurrSamplesPerSec=3.2902450207664993, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:44:09,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=0, lr=[9.958356781091728e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:44:09,046] [INFO] [timer.py:260:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=3.2915577811482666, CurrSamplesPerSec=3.2956405073535624, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:44:15,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=0, lr=[9.958075407990997e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:44:15,135] [INFO] [timer.py:260:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=3.2915727429954544, CurrSamplesPerSec=3.287506226331612, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:44:21,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=0, lr=[9.957794034890266e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:44:21,225] [INFO] [timer.py:260:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=3.2915831970297997, CurrSamplesPerSec=3.28510644297084, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 95.67538452148438, loss: 4.56096076965332
[2024-05-31 15:47:06,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=0, lr=[9.957512661789534e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:06,793] [INFO] [timer.py:260:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=3.2915792383558746, CurrSamplesPerSec=3.293819784417294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:12,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=0, lr=[9.957231288688803e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:12,885] [INFO] [timer.py:260:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=3.2915882284162192, CurrSamplesPerSec=3.2817392739932405, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:18,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=0, lr=[9.95694991558807e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:18,977] [INFO] [timer.py:260:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=3.291603194570656, CurrSamplesPerSec=3.2995838845024807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:25,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=0, lr=[9.956668542487338e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:25,070] [INFO] [timer.py:260:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=3.2916090734837367, CurrSamplesPerSec=3.2825534442595283, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:31,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=0, lr=[9.956387169386607e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:31,162] [INFO] [timer.py:260:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=3.2916198278445314, CurrSamplesPerSec=3.2817816419768446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:37,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=0, lr=[9.956105796285875e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:37,245] [INFO] [timer.py:260:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=3.2916478764798107, CurrSamplesPerSec=3.2924894840688106, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:43,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=0, lr=[9.955824423185144e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:43,338] [INFO] [timer.py:260:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=3.2916551666445435, CurrSamplesPerSec=3.303838563178576, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:49,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=0, lr=[9.955543050084414e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:49,429] [INFO] [timer.py:260:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=3.291662115703342, CurrSamplesPerSec=3.287781962328073, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:47:55,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=0, lr=[9.955261676983681e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:47:55,524] [INFO] [timer.py:260:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=3.2916625718531205, CurrSamplesPerSec=3.2934214865650078, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:48:01,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=0, lr=[9.95498030388295e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:48:01,613] [INFO] [timer.py:260:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=3.2916752980819277, CurrSamplesPerSec=3.2986263404613574, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 93.77136993408203, loss: 4.540859222412109
[2024-05-31 15:50:47,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=0, lr=[9.954698930782218e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:50:47,135] [INFO] [timer.py:260:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=3.2916740900892405, CurrSamplesPerSec=3.292841023595806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:50:53,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=0, lr=[9.954417557681485e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:50:53,223] [INFO] [timer.py:260:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=3.291693615513754, CurrSamplesPerSec=3.2953958156063474, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:50:59,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=0, lr=[9.954136184580755e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:50:59,321] [INFO] [timer.py:260:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=3.2916921558062455, CurrSamplesPerSec=3.294180663367227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:05,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=0, lr=[9.953854811480024e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:05,429] [INFO] [timer.py:260:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=3.2916708246373787, CurrSamplesPerSec=3.2852093660060304, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:11,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=0, lr=[9.953573438379291e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:11,521] [INFO] [timer.py:260:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=3.2916786362462758, CurrSamplesPerSec=3.295249535779817, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:17,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=0, lr=[9.95329206527856e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:17,627] [INFO] [timer.py:260:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=3.291669144764902, CurrSamplesPerSec=3.282387752275162, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:23,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=0, lr=[9.953010692177828e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:23,727] [INFO] [timer.py:260:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=3.2916667829910784, CurrSamplesPerSec=3.292926334945787, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:29,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=0, lr=[9.952729319077098e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:29,818] [INFO] [timer.py:260:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=3.2916763477381235, CurrSamplesPerSec=3.2978962299459353, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:35,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=0, lr=[9.952447945976365e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:35,909] [INFO] [timer.py:260:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=3.2916880493958875, CurrSamplesPerSec=3.2947176009533092, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:51:42,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=0, lr=[9.952166572875633e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:51:42,009] [INFO] [timer.py:260:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=3.2916839370598105, CurrSamplesPerSec=3.288136363885803, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 92.05445861816406, loss: 4.5223774909973145
[2024-05-31 15:54:27,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=0, lr=[9.951885199774902e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:27,649] [INFO] [timer.py:260:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=3.291672454838086, CurrSamplesPerSec=3.28213603522602, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:54:33,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=0, lr=[9.951603826674171e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:33,748] [INFO] [timer.py:260:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=3.2916733686474378, CurrSamplesPerSec=3.2884225183382516, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:54:39,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=0, lr=[9.951322453573439e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:39,837] [INFO] [timer.py:260:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=3.291688149657021, CurrSamplesPerSec=3.288484396119964, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:54:45,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=0, lr=[9.951041080472708e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:45,934] [INFO] [timer.py:260:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=3.291688100317404, CurrSamplesPerSec=3.2831354253911846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:54:52,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=0, lr=[9.950759707371977e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:52,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=3.2916953373741946, CurrSamplesPerSec=3.3019632819010183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:54:58,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=0, lr=[9.950478334271245e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:54:58,125] [INFO] [timer.py:260:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=3.291692450928077, CurrSamplesPerSec=3.28259069514816, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:55:04,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=0, lr=[9.950196961170512e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:55:04,213] [INFO] [timer.py:260:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=3.291706489455712, CurrSamplesPerSec=3.297176810279465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:55:10,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=0, lr=[9.949915588069782e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:55:10,303] [INFO] [timer.py:260:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=3.2917189874899404, CurrSamplesPerSec=3.305490625664951, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:55:16,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=0, lr=[9.949634214969049e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:55:16,402] [INFO] [timer.py:260:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=3.291711334555133, CurrSamplesPerSec=3.2816198791975713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:55:22,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=0, lr=[9.949352841868318e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:55:22,495] [INFO] [timer.py:260:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=3.2917192867909724, CurrSamplesPerSec=3.291010480410334, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.90563201904297, loss: 4.509819030761719
[2024-05-31 15:58:08,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=0, lr=[9.949071468767588e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:08,062] [INFO] [timer.py:260:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=3.2916957870596666, CurrSamplesPerSec=3.2775207985193617, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:14,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=0, lr=[9.948790095666855e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:14,153] [INFO] [timer.py:260:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=3.291705701128613, CurrSamplesPerSec=3.2810833517818967, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:20,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=0, lr=[9.948508722566124e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:20,248] [INFO] [timer.py:260:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=3.2917099733010695, CurrSamplesPerSec=3.2835543739583066, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:26,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=0, lr=[9.948227349465392e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:26,337] [INFO] [timer.py:260:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=3.2917236513008232, CurrSamplesPerSec=3.3048368936154455, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:32,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=0, lr=[9.94794597636466e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:32,434] [INFO] [timer.py:260:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=3.2917263115774964, CurrSamplesPerSec=3.2860419931056097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:38,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=0, lr=[9.947664603263929e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:38,526] [INFO] [timer.py:260:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=3.2917351965719974, CurrSamplesPerSec=3.2979467955661006, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:44,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=0, lr=[9.947383230163196e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:44,610] [INFO] [timer.py:260:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=3.2917546109213394, CurrSamplesPerSec=3.2926290569546643, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:50,707] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=0, lr=[9.947101857062466e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:50,708] [INFO] [timer.py:260:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=3.29175269888655, CurrSamplesPerSec=3.2904915295989405, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:58:56,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=0, lr=[9.946820483961735e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:58:56,807] [INFO] [timer.py:260:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=3.291751984011247, CurrSamplesPerSec=3.288261389209342, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 15:59:02,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=0, lr=[9.946539110861002e-06], mom=[(0.9, 0.95)]
[2024-05-31 15:59:02,905] [INFO] [timer.py:260:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=3.2917508742557025, CurrSamplesPerSec=3.2926691217280784, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.49742126464844, loss: 4.494206428527832
[2024-05-31 16:01:48,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=0, lr=[9.946257737760272e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:01:48,468] [INFO] [timer.py:260:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=3.291748988137176, CurrSamplesPerSec=3.2952534191472242, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:01:54,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=0, lr=[9.94597636465954e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:01:54,567] [INFO] [timer.py:260:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=3.2917408490002638, CurrSamplesPerSec=3.2887151692165952, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:00,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=0, lr=[9.945694991558807e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:00,663] [INFO] [timer.py:260:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=3.291741956041879, CurrSamplesPerSec=3.2858386232754317, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:06,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=0, lr=[9.945413618458076e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:06,764] [INFO] [timer.py:260:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=3.2917385877992187, CurrSamplesPerSec=3.2950670278355636, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:12,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=0, lr=[9.945132245357345e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:12,861] [INFO] [timer.py:260:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=3.2917416242225896, CurrSamplesPerSec=3.288945974705024, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:18,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=0, lr=[9.944850872256613e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:18,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=3.2917445340078024, CurrSamplesPerSec=3.285004812801975, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:25,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=0, lr=[9.944569499155882e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:25,050] [INFO] [timer.py:260:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=3.2917516683671666, CurrSamplesPerSec=3.281894628614889, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:31,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=0, lr=[9.944288126055151e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:31,144] [INFO] [timer.py:260:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=3.2917610407175593, CurrSamplesPerSec=3.286773302740503, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:37,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=0, lr=[9.944006752954419e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:37,245] [INFO] [timer.py:260:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=3.2917605985182505, CurrSamplesPerSec=3.290073389832104, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:02:43,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=0, lr=[9.943725379853686e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:02:43,340] [INFO] [timer.py:260:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=3.291763696191675, CurrSamplesPerSec=3.291332002195632, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.54481506347656, loss: 4.483506202697754
saving model ... to step 3000
[2024-05-31 16:05:29,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=0, lr=[9.943444006752954e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:05:29,696] [INFO] [timer.py:260:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=3.291776923266702, CurrSamplesPerSec=3.294206535863526, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:05:35,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=0, lr=[9.943162633652223e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:05:35,781] [INFO] [timer.py:260:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=3.2917972705166325, CurrSamplesPerSec=3.294698190521713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:05:41,870] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=0, lr=[9.942881260551492e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:05:41,871] [INFO] [timer.py:260:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=3.2918088252736566, CurrSamplesPerSec=3.292533422404796, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:05:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=0, lr=[9.94259988745076e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:05:47,958] [INFO] [timer.py:260:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=3.2918213262270255, CurrSamplesPerSec=3.2964615906357095, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:05:54,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=0, lr=[9.94231851435003e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:05:54,050] [INFO] [timer.py:260:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=3.2918296741359274, CurrSamplesPerSec=3.298898755766657, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:06:00,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=0, lr=[9.942037141249299e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:06:00,148] [INFO] [timer.py:260:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=3.2918318655730823, CurrSamplesPerSec=3.290985949198989, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:06:06,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=0, lr=[9.941755768148566e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:06:06,246] [INFO] [timer.py:260:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=3.291830626776341, CurrSamplesPerSec=3.2883232609272572, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:06:12,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=0, lr=[9.941474395047834e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:06:12,343] [INFO] [timer.py:260:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=3.2918343373251524, CurrSamplesPerSec=3.3056326056450973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:06:18,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=0, lr=[9.941193021947103e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:06:18,437] [INFO] [timer.py:260:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=3.291838960889623, CurrSamplesPerSec=3.295382869965163, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:06:24,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=0, lr=[9.94091164884637e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:06:24,526] [INFO] [timer.py:260:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=3.291847948259777, CurrSamplesPerSec=3.293045261173186, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 87.55146789550781, loss: 4.472224235534668
[2024-05-31 16:09:10,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=0, lr=[9.94063027574564e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:10,128] [INFO] [timer.py:260:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=3.2918354021804013, CurrSamplesPerSec=3.293195223878253, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:16,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=0, lr=[9.940348902644909e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:16,223] [INFO] [timer.py:260:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=3.291836667205524, CurrSamplesPerSec=3.2868054981433716, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:22,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=0, lr=[9.940067529544177e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:22,312] [INFO] [timer.py:260:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=3.2918502864961265, CurrSamplesPerSec=3.290987240306258, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:28,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=0, lr=[9.939786156443446e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:28,400] [INFO] [timer.py:260:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=3.291865441868772, CurrSamplesPerSec=3.3001485509983133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:34,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=0, lr=[9.939504783342713e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:34,496] [INFO] [timer.py:260:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=3.291866871090724, CurrSamplesPerSec=3.2883000587601874, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:40,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=0, lr=[9.939223410241981e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:40,584] [INFO] [timer.py:260:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=3.2918811446734857, CurrSamplesPerSec=3.3004134266887624, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:46,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=0, lr=[9.93894203714125e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:46,681] [INFO] [timer.py:260:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=3.2918838173239635, CurrSamplesPerSec=3.283369303739748, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:52,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=0, lr=[9.938660664040518e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:52,778] [INFO] [timer.py:260:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=3.2918862439007857, CurrSamplesPerSec=3.283924576992428, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:09:58,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=0, lr=[9.938379290939787e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:09:58,870] [INFO] [timer.py:260:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=3.291896815432997, CurrSamplesPerSec=3.309432817425891, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:10:04,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=0, lr=[9.938097917839056e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:10:04,969] [INFO] [timer.py:260:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=3.2918953337678003, CurrSamplesPerSec=3.2817816419768446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 86.8733139038086, loss: 4.464447021484375
[2024-05-31 16:12:50,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=0, lr=[9.937816544738324e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:12:50,551] [INFO] [timer.py:260:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=3.291885736349833, CurrSamplesPerSec=3.2846395107071955, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:12:56,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=0, lr=[9.937535171637593e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:12:56,651] [INFO] [timer.py:260:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=3.2918836379741556, CurrSamplesPerSec=3.293819784417294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:02,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=0, lr=[9.93725379853686e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:02,740] [INFO] [timer.py:260:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=3.2918942130250697, CurrSamplesPerSec=3.286987092026617, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:08,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=0, lr=[9.936972425436128e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:08,833] [INFO] [timer.py:260:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=3.2918999149825066, CurrSamplesPerSec=3.2894270310288753, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:14,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=0, lr=[9.936691052335397e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:14,921] [INFO] [timer.py:260:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=3.291911282926797, CurrSamplesPerSec=3.2952857808982343, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:21,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=0, lr=[9.936409679234667e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:21,022] [INFO] [timer.py:260:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=3.291909663986517, CurrSamplesPerSec=3.2994709743904407, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:27,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=0, lr=[9.936128306133934e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:27,113] [INFO] [timer.py:260:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=3.291919945135051, CurrSamplesPerSec=3.2884109165134237, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:33,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=0, lr=[9.935846933033203e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:33,210] [INFO] [timer.py:260:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=3.291921603081085, CurrSamplesPerSec=3.2869935318944177, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:39,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=0, lr=[9.935565559932471e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:39,315] [INFO] [timer.py:260:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=3.2919110456725327, CurrSamplesPerSec=3.2939711111242, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:13:45,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=0, lr=[9.93528418683174e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:13:45,409] [INFO] [timer.py:260:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=3.2919147906875, CurrSamplesPerSec=3.297131451992639, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 85.90242004394531, loss: 4.453205108642578
[2024-05-31 16:16:30,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=0, lr=[9.935002813731008e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:16:30,914] [INFO] [timer.py:260:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=3.2919218641201895, CurrSamplesPerSec=3.2917065445197724, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:16:37,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=0, lr=[9.934721440630275e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:16:37,003] [INFO] [timer.py:260:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=3.2919309985786964, CurrSamplesPerSec=3.3004458898695694, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:16:43,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=0, lr=[9.934440067529545e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:16:43,098] [INFO] [timer.py:260:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=3.2919349220360417, CurrSamplesPerSec=3.281840702203541, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:16:49,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=0, lr=[9.934158694428814e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:16:49,186] [INFO] [timer.py:260:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=3.2919487412073027, CurrSamplesPerSec=3.2910995705167414, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:16:55,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=0, lr=[9.933877321328081e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:16:55,282] [INFO] [timer.py:260:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=3.2919483603915323, CurrSamplesPerSec=3.29093817894219, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:17:01,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=0, lr=[9.93359594822735e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:17:01,373] [INFO] [timer.py:260:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=3.2919576904557473, CurrSamplesPerSec=3.2972066178331834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:17:07,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=0, lr=[9.93331457512662e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:17:07,462] [INFO] [timer.py:260:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=3.2919686977720377, CurrSamplesPerSec=3.2914921408961013, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:17:13,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=0, lr=[9.933033202025887e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:17:13,554] [INFO] [timer.py:260:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=3.291973203134485, CurrSamplesPerSec=3.288285879819275, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:17:19,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=0, lr=[9.932751828925155e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:17:19,646] [INFO] [timer.py:260:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=3.291980451765787, CurrSamplesPerSec=3.288768032417971, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:17:25,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=0, lr=[9.932470455824424e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:17:25,738] [INFO] [timer.py:260:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=3.2919853058977946, CurrSamplesPerSec=3.281876652947528, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 85.29373168945312, loss: 4.446094512939453
[2024-05-31 16:20:11,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=0, lr=[9.932189082723692e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:11,272] [INFO] [timer.py:260:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=3.29198170393653, CurrSamplesPerSec=3.2829362695507034, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:17,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=0, lr=[9.931907709622961e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:17,367] [INFO] [timer.py:260:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=3.2919828797595896, CurrSamplesPerSec=3.288079654502281, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:23,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=0, lr=[9.931626336522229e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:23,463] [INFO] [timer.py:260:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=3.291985442744146, CurrSamplesPerSec=3.295362157150826, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:29,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=0, lr=[9.931344963421498e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:29,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=3.2919886465395947, CurrSamplesPerSec=3.285608253689481, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:35,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=0, lr=[9.931063590320767e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:35,644] [INFO] [timer.py:260:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=3.2919975381417683, CurrSamplesPerSec=3.2915115135696342, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:41,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=0, lr=[9.930782217220035e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:41,731] [INFO] [timer.py:260:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=3.292011970040568, CurrSamplesPerSec=3.2949013643705105, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:47,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=0, lr=[9.930500844119302e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:47,820] [INFO] [timer.py:260:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=3.2920245694505983, CurrSamplesPerSec=3.297009638770149, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:20:53,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=0, lr=[9.930219471018571e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:20:53,922] [INFO] [timer.py:260:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=3.2920185682729097, CurrSamplesPerSec=3.29281905017613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:21:00,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=0, lr=[9.929938097917839e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:21:00,014] [INFO] [timer.py:260:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=3.292023032419884, CurrSamplesPerSec=3.292346046488262, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:21:06,107] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=0, lr=[9.929656724817108e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:21:06,108] [INFO] [timer.py:260:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=3.2920266747747933, CurrSamplesPerSec=3.283996570609813, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 84.66064453125, loss: 4.438645362854004
[2024-05-31 16:23:51,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=0, lr=[9.929375351716377e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:23:51,698] [INFO] [timer.py:260:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=3.2920284509215407, CurrSamplesPerSec=3.2916742530308833, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:23:57,786] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=0, lr=[9.929093978615645e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:23:57,787] [INFO] [timer.py:260:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=3.2920412531006455, CurrSamplesPerSec=3.2936684716138003, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:03,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=0, lr=[9.928812605514914e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:03,874] [INFO] [timer.py:260:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=3.2920536620147542, CurrSamplesPerSec=3.287914692871919, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:09,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=0, lr=[9.928531232414182e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:09,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=3.2920737920574754, CurrSamplesPerSec=3.300600423365361, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:16,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=0, lr=[9.92824985931345e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:16,052] [INFO] [timer.py:260:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=3.292073136654464, CurrSamplesPerSec=3.2923227875177106, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:22,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=0, lr=[9.927968486212719e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:22,140] [INFO] [timer.py:260:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=3.292087974723584, CurrSamplesPerSec=3.3003939490868115, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:28,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=0, lr=[9.927687113111988e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:28,245] [INFO] [timer.py:260:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=3.2920780041030886, CurrSamplesPerSec=3.2743979221492983, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:34,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=0, lr=[9.927405740011255e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:34,339] [INFO] [timer.py:260:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=3.2920836466221473, CurrSamplesPerSec=3.294580438805679, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:40,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=0, lr=[9.927124366910525e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:40,437] [INFO] [timer.py:260:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=3.2920828050595006, CurrSamplesPerSec=3.288532095166075, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:24:46,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=0, lr=[9.926842993809792e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:24:46,532] [INFO] [timer.py:260:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=3.2920857579012206, CurrSamplesPerSec=3.294601141794257, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 84.11370849609375, loss: 4.432162284851074
[2024-05-31 16:27:31,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=0, lr=[9.926561620709062e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:27:31,931] [INFO] [timer.py:260:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=3.292076739025746, CurrSamplesPerSec=3.298762542489921, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:27:38,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=0, lr=[9.926280247608329e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:27:38,014] [INFO] [timer.py:260:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=3.2920922041972642, CurrSamplesPerSec=3.2960289815780737, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:27:44,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=0, lr=[9.925998874507597e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:27:44,101] [INFO] [timer.py:260:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=3.2921018048702773, CurrSamplesPerSec=3.303255723475948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:27:50,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=0, lr=[9.925717501406866e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:27:50,186] [INFO] [timer.py:260:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=3.2921166422441397, CurrSamplesPerSec=3.299633203987751, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:27:56,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=0, lr=[9.925436128306135e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:27:56,272] [INFO] [timer.py:260:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=3.292127550372157, CurrSamplesPerSec=3.2950424361121162, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:28:02,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=0, lr=[9.925154755205403e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:28:02,361] [INFO] [timer.py:260:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=3.2921354193266734, CurrSamplesPerSec=3.280048016297388, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:28:08,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=0, lr=[9.924873382104672e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:28:08,460] [INFO] [timer.py:260:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=3.2921323658229382, CurrSamplesPerSec=3.295248241326049, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:28:14,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=0, lr=[9.924592009003941e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:28:14,547] [INFO] [timer.py:260:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=3.292145469925497, CurrSamplesPerSec=3.2938120244481457, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:28:20,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=0, lr=[9.924310635903209e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:28:20,637] [INFO] [timer.py:260:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=3.29215277093462, CurrSamplesPerSec=3.3053642867640947, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:28:26,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=0, lr=[9.924029262802476e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:28:26,722] [INFO] [timer.py:260:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=3.2921664133321817, CurrSamplesPerSec=3.295389342773041, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 84.35592651367188, loss: 4.4350385665893555
[2024-05-31 16:31:12,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=0, lr=[9.923747889701746e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:12,129] [INFO] [timer.py:260:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=3.2921725376915414, CurrSamplesPerSec=3.297060177206105, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:18,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=0, lr=[9.923466516601013e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:18,223] [INFO] [timer.py:260:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=3.2921766514500383, CurrSamplesPerSec=3.2804687429730985, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:24,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=0, lr=[9.923185143500282e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:24,313] [INFO] [timer.py:260:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=3.292186784715584, CurrSamplesPerSec=3.285425525373451, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:30,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=0, lr=[9.92290377039955e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:30,407] [INFO] [timer.py:260:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=3.2921921930008513, CurrSamplesPerSec=3.2773607359384145, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:36,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=0, lr=[9.92262239729882e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:36,497] [INFO] [timer.py:260:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=3.2921992261270616, CurrSamplesPerSec=3.2832832017910367, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:42,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=0, lr=[9.922341024198088e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:42,593] [INFO] [timer.py:260:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=3.2922017965898607, CurrSamplesPerSec=3.2914443559430433, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:48,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=0, lr=[9.922059651097356e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:48,688] [INFO] [timer.py:260:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=3.2922033641347426, CurrSamplesPerSec=3.289821782861616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:31:54,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=0, lr=[9.921778277996624e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:31:54,786] [INFO] [timer.py:260:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=3.292201072846921, CurrSamplesPerSec=3.286083184997618, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:32:00,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=0, lr=[9.921496904895893e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:32:00,873] [INFO] [timer.py:260:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=3.292211102712706, CurrSamplesPerSec=3.2944885724328477, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:32:06,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=0, lr=[9.92121553179516e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:32:06,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=3.292211693416778, CurrSamplesPerSec=3.2886120263995093, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 83.16844177246094, loss: 4.420862674713135
[2024-05-31 16:34:52,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=0, lr=[9.92093415869443e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:34:52,535] [INFO] [timer.py:260:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=3.29221467073756, CurrSamplesPerSec=3.301451265995903, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:34:58,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=0, lr=[9.920652785593699e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:34:58,628] [INFO] [timer.py:260:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=3.2922178737582786, CurrSamplesPerSec=3.296486203546806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:04,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=0, lr=[9.920371412492966e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:04,725] [INFO] [timer.py:260:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=3.29221764455832, CurrSamplesPerSec=3.2877729421945743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:10,822] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=0, lr=[9.920090039392236e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:10,823] [INFO] [timer.py:260:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=3.2922160601794594, CurrSamplesPerSec=3.2882343210648903, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:16,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=0, lr=[9.919808666291503e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:16,919] [INFO] [timer.py:260:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=3.2922158953093508, CurrSamplesPerSec=3.2814157727334425, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:23,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=0, lr=[9.91952729319077e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:23,012] [INFO] [timer.py:260:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=3.2922166301850466, CurrSamplesPerSec=3.287656973458444, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:29,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=0, lr=[9.91924592009004e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:29,101] [INFO] [timer.py:260:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=3.292224024069773, CurrSamplesPerSec=3.3001563408529586, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:35,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=0, lr=[9.918964546989308e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:35,195] [INFO] [timer.py:260:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=3.2922258360303354, CurrSamplesPerSec=3.2947874804008133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:41,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=0, lr=[9.918683173888577e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:41,297] [INFO] [timer.py:260:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=3.292235332355769, CurrSamplesPerSec=3.287130063030108, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:35:47,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=0, lr=[9.918401800787846e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:35:47,394] [INFO] [timer.py:260:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=3.292237107015648, CurrSamplesPerSec=3.2800903406229374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.78123474121094, loss: 4.416195869445801
[2024-05-31 16:38:32,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=0, lr=[9.918120427687114e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:38:32,909] [INFO] [timer.py:260:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=3.2922232389751946, CurrSamplesPerSec=3.290274703120122, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:38:38,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=0, lr=[9.917839054586383e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:38:38,999] [INFO] [timer.py:260:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=3.2922303841444154, CurrSamplesPerSec=3.2860806104741123, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:38:45,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=0, lr=[9.91755768148565e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:38:45,094] [INFO] [timer.py:260:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=3.292229746698158, CurrSamplesPerSec=3.279299184652053, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:38:51,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=0, lr=[9.91727630838492e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:38:51,184] [INFO] [timer.py:260:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=3.292237509733973, CurrSamplesPerSec=3.2947188949902144, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:38:57,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=0, lr=[9.916994935284187e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:38:57,279] [INFO] [timer.py:260:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=3.292237879551026, CurrSamplesPerSec=3.2915915897062424, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:39:03,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=0, lr=[9.916713562183456e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:39:03,370] [INFO] [timer.py:260:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=3.292243409663169, CurrSamplesPerSec=3.2940241434312383, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:39:09,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=0, lr=[9.916432189082724e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:39:09,460] [INFO] [timer.py:260:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=3.2922513430719533, CurrSamplesPerSec=3.298625043353249, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:39:15,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=0, lr=[9.916150815981993e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:39:15,551] [INFO] [timer.py:260:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=3.292256229841293, CurrSamplesPerSec=3.30238704966016, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:39:21,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=0, lr=[9.915869442881263e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:39:21,645] [INFO] [timer.py:260:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=3.292261655551785, CurrSamplesPerSec=3.293415021485345, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:39:27,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=0, lr=[9.91558806978053e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:39:27,734] [INFO] [timer.py:260:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=3.292270751754652, CurrSamplesPerSec=3.295193875186097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.2612075805664, loss: 4.409893989562988
saving model ... to step 4000
[2024-05-31 16:42:13,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=0, lr=[9.915306696679798e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:13,732] [INFO] [timer.py:260:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=3.292283730892453, CurrSamplesPerSec=3.3084565007759794, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:19,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=0, lr=[9.915025323579067e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:19,819] [INFO] [timer.py:260:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=3.292295378475729, CurrSamplesPerSec=3.2880435677312185, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:25,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=0, lr=[9.914743950478334e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:25,907] [INFO] [timer.py:260:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=3.292304754535083, CurrSamplesPerSec=3.2972740108108787, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:31,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=0, lr=[9.914462577377604e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:31,997] [INFO] [timer.py:260:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=3.2923118621486145, CurrSamplesPerSec=3.2862157784119734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:38,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=0, lr=[9.914181204276871e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:38,094] [INFO] [timer.py:260:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=3.292313509749564, CurrSamplesPerSec=3.286441083020893, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:44,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=0, lr=[9.91389983117614e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:44,183] [INFO] [timer.py:260:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=3.292320436610807, CurrSamplesPerSec=3.297977913641544, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:50,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=0, lr=[9.91361845807541e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:50,270] [INFO] [timer.py:260:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=3.2923271480731966, CurrSamplesPerSec=3.2921328515582537, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:42:56,363] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=0, lr=[9.913337084974677e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:42:56,364] [INFO] [timer.py:260:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=3.2923297204335205, CurrSamplesPerSec=3.2921457716771183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:43:02,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=0, lr=[9.913055711873945e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:43:02,457] [INFO] [timer.py:260:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=3.29233826943887, CurrSamplesPerSec=3.301605893655693, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:43:08,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=0, lr=[9.912774338773214e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:43:08,551] [INFO] [timer.py:260:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=3.2923440618764377, CurrSamplesPerSec=3.286899512329682, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.34465026855469, loss: 4.410907745361328
[2024-05-31 16:45:54,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=0, lr=[9.912492965672482e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:45:54,047] [INFO] [timer.py:260:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=3.292349465028511, CurrSamplesPerSec=3.294782304043789, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:00,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=0, lr=[9.912211592571751e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:00,140] [INFO] [timer.py:260:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=3.2923565640287737, CurrSamplesPerSec=3.2935456210168574, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:06,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=0, lr=[9.91193021947102e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:06,236] [INFO] [timer.py:260:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=3.292355938161254, CurrSamplesPerSec=3.2806175623899843, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:12,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=0, lr=[9.911648846370288e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:12,333] [INFO] [timer.py:260:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=3.2923570662288446, CurrSamplesPerSec=3.2865904448172563, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:18,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=0, lr=[9.911367473269557e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:18,426] [INFO] [timer.py:260:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=3.2923581087975515, CurrSamplesPerSec=3.289380595864888, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:24,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=0, lr=[9.911086100168825e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:24,518] [INFO] [timer.py:260:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=3.292366607972829, CurrSamplesPerSec=3.293531396802899, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:30,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=0, lr=[9.910804727068094e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:30,609] [INFO] [timer.py:260:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=3.2923757363794475, CurrSamplesPerSec=3.2836623412209107, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:36,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=0, lr=[9.910523353967361e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:36,701] [INFO] [timer.py:260:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=3.292383887399103, CurrSamplesPerSec=3.291104735308507, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:42,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=0, lr=[9.910241980866629e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:42,789] [INFO] [timer.py:260:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=3.2923932053497174, CurrSamplesPerSec=3.2979156780778807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:46:48,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=0, lr=[9.909960607765898e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:46:48,886] [INFO] [timer.py:260:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=3.2923963792572932, CurrSamplesPerSec=3.2948120683187976, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 81.77227783203125, loss: 4.403931140899658
[2024-05-31 16:49:34,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=0, lr=[9.909679234665167e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:49:34,373] [INFO] [timer.py:260:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=3.292391054868362, CurrSamplesPerSec=3.2867707271355213, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:49:40,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=0, lr=[9.909397861564435e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:49:40,467] [INFO] [timer.py:260:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=3.292393092654467, CurrSamplesPerSec=3.2897250211965607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:49:46,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=0, lr=[9.909116488463704e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:49:46,562] [INFO] [timer.py:260:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=3.292396197545972, CurrSamplesPerSec=3.281889492689835, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:49:52,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=0, lr=[9.908835115362972e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:49:52,657] [INFO] [timer.py:260:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=3.2923990694738743, CurrSamplesPerSec=3.278361063334455, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:49:58,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=0, lr=[9.908553742262241e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:49:58,751] [INFO] [timer.py:260:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=3.2924000315383237, CurrSamplesPerSec=3.28667800804449, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:50:04,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=0, lr=[9.908272369161509e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:50:04,842] [INFO] [timer.py:260:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=3.292405234166373, CurrSamplesPerSec=3.289977903681386, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:50:10,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=0, lr=[9.907990996060778e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:50:10,934] [INFO] [timer.py:260:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=3.2924098604804386, CurrSamplesPerSec=3.2899443558090686, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:50:17,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=0, lr=[9.907709622960045e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:50:17,029] [INFO] [timer.py:260:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=3.292409314097364, CurrSamplesPerSec=3.286862163584379, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:50:23,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=0, lr=[9.907428249859315e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:50:23,121] [INFO] [timer.py:260:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=3.292412378426999, CurrSamplesPerSec=3.290867171663874, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:50:29,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=0, lr=[9.907146876758584e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:50:29,214] [INFO] [timer.py:260:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=3.292414616425575, CurrSamplesPerSec=3.2934757942362856, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 81.234619140625, loss: 4.397336006164551
[2024-05-31 16:53:14,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=0, lr=[9.906865503657851e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:14,691] [INFO] [timer.py:260:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=3.292411839504223, CurrSamplesPerSec=3.290587045566699, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:20,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=0, lr=[9.906584130557119e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:20,788] [INFO] [timer.py:260:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=3.2924116126150467, CurrSamplesPerSec=3.290778094138932, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:26,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=0, lr=[9.906302757456388e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:26,876] [INFO] [timer.py:260:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=3.2924198053700113, CurrSamplesPerSec=3.286096057675659, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:32,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=0, lr=[9.906021384355656e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:32,978] [INFO] [timer.py:260:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=3.2924143553055982, CurrSamplesPerSec=3.2988533500911954, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:39,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=0, lr=[9.905740011254925e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:39,072] [INFO] [timer.py:260:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=3.29241815721061, CurrSamplesPerSec=3.2944665770192656, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:45,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=0, lr=[9.905458638154193e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:45,174] [INFO] [timer.py:260:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=3.29241247738137, CurrSamplesPerSec=3.2819292965294586, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:51,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=0, lr=[9.905177265053462e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:51,268] [INFO] [timer.py:260:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=3.2924155697660407, CurrSamplesPerSec=3.2882497885214375, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:53:57,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=0, lr=[9.904895891952731e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:53:57,361] [INFO] [timer.py:260:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=3.2924209857358027, CurrSamplesPerSec=3.280060841735241, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:54:03,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=0, lr=[9.904614518851999e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:54:03,453] [INFO] [timer.py:260:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=3.2924244737278885, CurrSamplesPerSec=3.2934732081160876, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:54:09,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=0, lr=[9.904333145751268e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:54:09,545] [INFO] [timer.py:260:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=3.292433186520811, CurrSamplesPerSec=3.282539314833279, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 81.23240661621094, loss: 4.397308349609375
[2024-05-31 16:56:54,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=0, lr=[9.904051772650535e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:56:54,976] [INFO] [timer.py:260:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=3.292430037019799, CurrSamplesPerSec=3.299568310234489, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:01,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=0, lr=[9.903770399549803e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:01,070] [INFO] [timer.py:260:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=3.2924322131859225, CurrSamplesPerSec=3.289504425882304, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:07,163] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=0, lr=[9.903489026449072e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:07,164] [INFO] [timer.py:260:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=3.2924338577256504, CurrSamplesPerSec=3.295662518445415, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:13,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=0, lr=[9.903207653348341e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:13,254] [INFO] [timer.py:260:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=3.292437876104625, CurrSamplesPerSec=3.2945015110486224, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:19,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=0, lr=[9.902926280247609e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:19,343] [INFO] [timer.py:260:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=3.292445167480766, CurrSamplesPerSec=3.2889446851989006, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:25,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=0, lr=[9.902644907146878e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:25,438] [INFO] [timer.py:260:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=3.292443123571958, CurrSamplesPerSec=3.2866960363469384, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:31,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=0, lr=[9.902363534046146e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:31,527] [INFO] [timer.py:260:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=3.292450083098982, CurrSamplesPerSec=3.291660044976482, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:37,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=0, lr=[9.902082160945415e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:37,614] [INFO] [timer.py:260:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=3.2924621367609084, CurrSamplesPerSec=3.2960976215436313, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:43,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=0, lr=[9.901800787844683e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:43,704] [INFO] [timer.py:260:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=3.292466915276147, CurrSamplesPerSec=3.28980759079454, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 16:57:49,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=0, lr=[9.90151941474395e-06], mom=[(0.9, 0.95)]
[2024-05-31 16:57:49,794] [INFO] [timer.py:260:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=3.292474882270077, CurrSamplesPerSec=3.2936322620642917, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.68086242675781, loss: 4.390496253967285
[2024-05-31 17:00:35,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=0, lr=[9.90123804164322e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:00:35,260] [INFO] [timer.py:260:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=3.292478962342671, CurrSamplesPerSec=3.2890852473183037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:00:41,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=0, lr=[9.900956668542489e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:00:41,346] [INFO] [timer.py:260:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=3.292490618180972, CurrSamplesPerSec=3.293683990235885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:00:47,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=0, lr=[9.900675295441756e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:00:47,436] [INFO] [timer.py:260:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=3.292496429553967, CurrSamplesPerSec=3.287401871034085, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:00:53,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=0, lr=[9.900393922341026e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:00:53,526] [INFO] [timer.py:260:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=3.292502516624429, CurrSamplesPerSec=3.2883374401905434, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:00:59,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=0, lr=[9.900112549240293e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:00:59,620] [INFO] [timer.py:260:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=3.2925064930144385, CurrSamplesPerSec=3.290256635536746, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:01:05,707] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=0, lr=[9.899831176139562e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:01:05,707] [INFO] [timer.py:260:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=3.2925141797461728, CurrSamplesPerSec=3.289007872188098, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:01:11,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=0, lr=[9.89954980303883e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:01:11,792] [INFO] [timer.py:260:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=3.292525218392008, CurrSamplesPerSec=3.3059126936585304, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:01:17,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=0, lr=[9.899268429938099e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:01:17,879] [INFO] [timer.py:260:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=3.292534125588044, CurrSamplesPerSec=3.291829257955855, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:01:23,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=0, lr=[9.898987056837367e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:01:23,964] [INFO] [timer.py:260:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=3.292545419516183, CurrSamplesPerSec=3.2970744319168888, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:01:30,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=0, lr=[9.898705683736636e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:01:30,056] [INFO] [timer.py:260:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=3.2925536510946865, CurrSamplesPerSec=3.290112102012753, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.92265319824219, loss: 4.393486022949219
[2024-05-31 17:04:15,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=0, lr=[9.898424310635903e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:15,435] [INFO] [timer.py:260:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=3.2925572763934836, CurrSamplesPerSec=3.295536929692058, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:21,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=0, lr=[9.898142937535173e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:21,520] [INFO] [timer.py:260:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=3.292567299871814, CurrSamplesPerSec=3.285900403852858, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:27,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=0, lr=[9.897861564434442e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:27,607] [INFO] [timer.py:260:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=3.2925752848746375, CurrSamplesPerSec=3.2884096274268297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:33,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=0, lr=[9.89758019133371e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:33,690] [INFO] [timer.py:260:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=3.2925908380791835, CurrSamplesPerSec=3.2916200047557873, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:39,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=0, lr=[9.897298818232977e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:39,777] [INFO] [timer.py:260:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=3.292600108977491, CurrSamplesPerSec=3.294955720858763, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:45,868] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=0, lr=[9.897017445132246e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:45,869] [INFO] [timer.py:260:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=3.2926056347270087, CurrSamplesPerSec=3.287841238722381, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:51,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=0, lr=[9.896736072031514e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:51,960] [INFO] [timer.py:260:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=3.292611106365341, CurrSamplesPerSec=3.2958140145236325, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:04:58,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=0, lr=[9.896454698930783e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:04:58,048] [INFO] [timer.py:260:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=3.292620535946428, CurrSamplesPerSec=3.291985569370585, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:05:04,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=0, lr=[9.896173325830052e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:05:04,139] [INFO] [timer.py:260:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=3.2926250096750045, CurrSamplesPerSec=3.298222989008293, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:05:10,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=0, lr=[9.89589195272932e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:05:10,234] [INFO] [timer.py:260:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=3.2926260529199824, CurrSamplesPerSec=3.2902617976831774, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.14483642578125, loss: 4.383828163146973
[2024-05-31 17:07:55,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=0, lr=[9.89561057962859e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:07:55,654] [INFO] [timer.py:260:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=3.292622827769914, CurrSamplesPerSec=3.2875371476921305, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:01,750] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=0, lr=[9.895329206527857e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:01,751] [INFO] [timer.py:260:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=3.292622086575874, CurrSamplesPerSec=3.28788891911235, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:07,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=0, lr=[9.895047833427124e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:07,842] [INFO] [timer.py:260:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=3.2926272539425123, CurrSamplesPerSec=3.291734961554082, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:13,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=0, lr=[9.894766460326394e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:13,934] [INFO] [timer.py:260:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=3.2926312593216687, CurrSamplesPerSec=3.2963501894242295, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:20,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=0, lr=[9.894485087225663e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:20,024] [INFO] [timer.py:260:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=3.292636754733386, CurrSamplesPerSec=3.2892993374824333, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:26,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=0, lr=[9.89420371412493e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:26,119] [INFO] [timer.py:260:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=3.2926365511319697, CurrSamplesPerSec=3.2942595757514828, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:32,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=0, lr=[9.8939223410242e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:32,210] [INFO] [timer.py:260:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=3.2926412984436726, CurrSamplesPerSec=3.286258262060493, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:38,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=0, lr=[9.893640967923467e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:38,309] [INFO] [timer.py:260:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=3.2926405754974457, CurrSamplesPerSec=3.288091253989775, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:44,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=0, lr=[9.893359594822736e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:44,406] [INFO] [timer.py:260:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=3.2926373898008965, CurrSamplesPerSec=3.2851128754716035, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:08:50,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=0, lr=[9.893078221722004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:08:50,503] [INFO] [timer.py:260:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=3.29263633754186, CurrSamplesPerSec=3.2800416036160738, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 79.86383056640625, loss: 4.380317211151123
[2024-05-31 17:11:35,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=0, lr=[9.892796848621272e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:11:35,962] [INFO] [timer.py:260:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=3.2926368911851887, CurrSamplesPerSec=3.2855400498983625, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:11:42,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=0, lr=[9.89251547552054e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:11:42,057] [INFO] [timer.py:260:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=3.292639460536491, CurrSamplesPerSec=3.2946826623411054, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:11:48,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=0, lr=[9.89223410241981e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:11:48,146] [INFO] [timer.py:260:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=3.292645683123004, CurrSamplesPerSec=3.280718921273928, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:11:54,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=0, lr=[9.891952729319078e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:11:54,234] [INFO] [timer.py:260:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=3.2926527158844925, CurrSamplesPerSec=3.2921470636945824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:00,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=0, lr=[9.891671356218347e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:00,323] [INFO] [timer.py:260:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=3.2926591976828594, CurrSamplesPerSec=3.2937202009227873, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:06,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=0, lr=[9.891389983117614e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:06,415] [INFO] [timer.py:260:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=3.292664157940303, CurrSamplesPerSec=3.299831794729778, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:12,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=0, lr=[9.891108610016884e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:12,503] [INFO] [timer.py:260:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=3.292670614870454, CurrSamplesPerSec=3.2959577544477274, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:18,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=0, lr=[9.890827236916151e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:18,589] [INFO] [timer.py:260:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=3.29267988828541, CurrSamplesPerSec=3.2883219719093857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:24,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=0, lr=[9.89054586381542e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:24,681] [INFO] [timer.py:260:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=3.2926861975690733, CurrSamplesPerSec=3.29176596251473, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:12:30,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=0, lr=[9.890264490714688e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:12:30,769] [INFO] [timer.py:260:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=3.2926920626127942, CurrSamplesPerSec=3.303973894668849, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 79.7662124633789, loss: 4.379096031188965
[2024-05-31 17:15:16,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=0, lr=[9.889983117613957e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:16,241] [INFO] [timer.py:260:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=3.292690755025529, CurrSamplesPerSec=3.2849855166447957, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:22,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=0, lr=[9.889701744513225e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:22,324] [INFO] [timer.py:260:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=3.2927028923343746, CurrSamplesPerSec=3.2940241434312383, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:28,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=0, lr=[9.889420371412494e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:28,412] [INFO] [timer.py:260:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=3.2927095370804853, CurrSamplesPerSec=3.3003939490868115, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:34,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=0, lr=[9.889138998311763e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:34,503] [INFO] [timer.py:260:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=3.292712680889154, CurrSamplesPerSec=3.3020178716439497, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:40,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=0, lr=[9.888857625211031e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:40,586] [INFO] [timer.py:260:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=3.2927227951850058, CurrSamplesPerSec=3.2832960525414543, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:46,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=0, lr=[9.888576252110298e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:46,680] [INFO] [timer.py:260:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=3.2927259293141264, CurrSamplesPerSec=3.28974308294195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:52,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=0, lr=[9.888294879009568e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:52,759] [INFO] [timer.py:260:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=3.2927417373224266, CurrSamplesPerSec=3.295135627741083, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:15:58,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=0, lr=[9.888013505908835e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:15:58,846] [INFO] [timer.py:260:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=3.292748264450536, CurrSamplesPerSec=3.2936245029786924, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:16:04,935] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=0, lr=[9.887732132808104e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:16:04,936] [INFO] [timer.py:260:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=3.2927554754244395, CurrSamplesPerSec=3.290583173189889, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:16:11,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=0, lr=[9.887450759707374e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:16:11,024] [INFO] [timer.py:260:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=3.292762684210478, CurrSamplesPerSec=3.296369619325983, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
[2024-05-31 17:16:30,892] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1419537
[2024-05-31 17:16:30,892] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1419538
[2024-05-31 17:16:31,316] [ERROR] [launch.py:325:sigkill_handler] ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'linear', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-14.14.50'] exits with return code = -9
