[2024-05-18 13:10:46,353] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-18 13:10:46,939] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-18 13:10:46,939] [INFO] [runner.py:568:main] cmd = /home/chanho/anaconda3/envs/COMEDY/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=12390 --enable_each_rank_log=None training/EPISODE/main.py --model_name quan_llama --model_name_or_path /home/chanho/Model/SHARE/Refactorizing/result/output_path --train_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json --valid_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json --per_device_train_batch_size 4 --per_device_eval_batch_size 4 --data_output_path /home/chanho/Model/SHARE/Refactorizing/result/output_path/data --max_seq_len 2048 --learning_rate 1e-5 --weight_decay 0.1 --num_train_epochs 20 --num_train_samples 5644 /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json --gradient_accumulation_steps 1 --lr_scheduler_type cosine --num_warmup_steps 600 --seed 42 --zero_stage 2 --save_interval 1000 --eval_interval 2000 --output_dir /home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44
[2024-05-18 13:10:48,340] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-18 13:10:49,160] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-05-18 13:10:49,160] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-05-18 13:10:49,160] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-05-18 13:10:49,160] [INFO] [launch.py:164:main] dist_world_size=2
[2024-05-18 13:10:49,160] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-05-18 13:10:49,161] [INFO] [launch.py:256:main] process 4072852 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=0', '--model_name', 'quan_llama', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json', '--per_device_train_batch_size', '4', '--per_device_eval_batch_size', '4', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '20', '--num_train_samples', '5644', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '600', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '2000', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44']
[2024-05-18 13:10:49,161] [INFO] [launch.py:256:main] process 4072853 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'quan_llama', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json', '--per_device_train_batch_size', '4', '--per_device_eval_batch_size', '4', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '20', '--num_train_samples', '5644', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '600', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '2000', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44']
[2024-05-18 13:10:51,807] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-18 13:10:51,810] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='quan_llama', per_device_train_batch_size=4, per_device_eval_batch_size=4, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=20, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=600, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44', seed=42, local_rank=0, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=2000, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json', num_train_samples=5644, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json']
[2024-05-18 13:10:52,235] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-18 13:10:52,235] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='quan_llama', per_device_train_batch_size=4, per_device_eval_batch_size=4, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=20, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=600, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44', seed=42, local_rank=1, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=2000, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json', num_train_samples=5644, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json']
[2024-05-18 13:10:52,309] [INFO] [comm.py:637:init_distributed] cdb=None
This model is quan_llama
This model is quan_llama
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
`low_cpu_mem_usage` was None, now set to True since model is quantized.
`low_cpu_mem_usage` was None, now set to True since model is quantized.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.07s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.47s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.87s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.05s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.06s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.27s/it]
trainable params: 8,388,608 || all params: 6,746,804,224 || trainable%: 0.12433454005023165
trainable params: 8,388,608 || all params: 6,746,804,224 || trainable%: 0.12433454005023165
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06174755096435547 seconds
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06352758407592773 seconds
[2024-05-18 13:11:00,193] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.2, git-hash=unknown, git-branch=unknown
[2024-05-18 13:11:00,193] [INFO] [comm.py:662:init_distributed] Distributed backend already initialized
[2024-05-18 13:11:00,296] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-05-18 13:11:00,297] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-05-18 13:11:00,298] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-18 13:11:00,302] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-18 13:11:00,302] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-05-18 13:11:00,302] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-05-18 13:11:00,302] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 500,000,000
[2024-05-18 13:11:00,302] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 500,000,000
[2024-05-18 13:11:00,302] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-05-18 13:11:00,302] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-05-18 13:11:00,897] [INFO] [utils.py:779:see_memory_usage] Before initializing optimizer states
[2024-05-18 13:11:00,897] [INFO] [utils.py:780:see_memory_usage] MA 6.71 GB         Max_MA 6.72 GB         CA 6.75 GB         Max_CA 7 GB 
[2024-05-18 13:11:00,897] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 7.7 GB, percent = 6.1%
[2024-05-18 13:11:01,022] [INFO] [utils.py:779:see_memory_usage] After initializing optimizer states
[2024-05-18 13:11:01,022] [INFO] [utils.py:780:see_memory_usage] MA 6.71 GB         Max_MA 6.73 GB         CA 6.75 GB         Max_CA 7 GB 
[2024-05-18 13:11:01,022] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 7.72 GB, percent = 6.1%
[2024-05-18 13:11:01,022] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-05-18 13:11:01,146] [INFO] [utils.py:779:see_memory_usage] After initializing ZeRO optimizer
[2024-05-18 13:11:01,147] [INFO] [utils.py:780:see_memory_usage] MA 6.71 GB         Max_MA 6.71 GB         CA 6.75 GB         Max_CA 7 GB 
[2024-05-18 13:11:01,147] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 7.73 GB, percent = 6.2%
[2024-05-18 13:11:01,148] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[2024-05-18 13:11:01,148] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-05-18 13:11:01,148] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f0e10e07990>
[2024-05-18 13:11:01,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.95)]
[2024-05-18 13:11:01,149] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0e10ee8090>
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-18 13:11:01,150] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   gradient_clipping ............ 1.0
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   steps_per_print .............. 10
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   train_batch_size ............. 8
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  4
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   world_size ................... 2
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='none', nvme_path=None, buffer_count=5, buffer_size=100,000,000, max_in_cpu=1,000,000,000, pin_memory=False) offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='none', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False, ratio=1.0) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=30000000 param_persistence_threshold=10000 model_persistence_threshold=sys.maxsize max_live_parameters=30000000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=False pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-18 13:11:01,151] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-05-18 13:11:01,151] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 8, 
    "train_micro_batch_size_per_gpu": 4, 
    "steps_per_print": 10, 
    "zero_optimization": {
        "stage": 2, 
        "offload_param": {
            "device": "none"
        }, 
        "offload_optimizer": {
            "device": "none"
        }, 
        "stage3_param_persistence_threshold": 1.000000e+04, 
        "stage3_max_live_parameters": 3.000000e+07, 
        "stage3_prefetch_bucket_size": 3.000000e+07, 
        "memory_efficient_linear": false
    }, 
    "bf16": {
        "enabled": true
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": false, 
    "wall_clock_breakdown": false, 
    "hybrid_engine": {
        "enabled": false, 
        "inference_tp_size": 1, 
        "release_inference_cache": false, 
        "pin_parameters": true, 
        "tp_gather_partition_size": 8
    }
}
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240518_131101-bquhwlo9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-forest-235
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/bquhwlo9
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240518_131102-ryhf7whh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run visionary-silence-236
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/ryhf7whh
***** Running training *****
***** Evaluating perplexity, Epoch 0/20 *****
Beginning of Epoch 1/20
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
[2024-05-18 13:12:34,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[1.6666666666666668e-07], mom=[(0.9, 0.95)]
[2024-05-18 13:12:34,201] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=0.9212906430966027, CurrSamplesPerSec=0.9187028533934332, MemAllocated=7.89GB, MaxMemAllocated=20.44GB
[2024-05-18 13:14:01,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[3.3333333333333335e-07], mom=[(0.9, 0.95)]
[2024-05-18 13:14:01,883] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=0.9171721866883038, CurrSamplesPerSec=0.9154295472485181, MemAllocated=7.89GB, MaxMemAllocated=20.44GB
[2024-05-18 13:15:29,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[5.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-18 13:15:29,464] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=0.9163648734479849, CurrSamplesPerSec=0.9138775340342415, MemAllocated=7.89GB, MaxMemAllocated=20.44GB
[2024-05-18 13:16:57,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[6.666666666666667e-07], mom=[(0.9, 0.95)]
[2024-05-18 13:16:57,171] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=0.9156842803402359, CurrSamplesPerSec=0.9134797896763956, MemAllocated=7.9GB, MaxMemAllocated=20.44GB
[2024-05-18 13:18:24,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[8.333333333333333e-07], mom=[(0.9, 0.95)]
[2024-05-18 13:18:24,769] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=0.9154843340522534, CurrSamplesPerSec=0.9116745605534685, MemAllocated=7.9GB, MaxMemAllocated=20.44GB
[2024-05-18 13:19:52,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[1.0000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:19:52,425] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=0.9152713819330585, CurrSamplesPerSec=0.9155179411812534, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:21:20,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[1.1666666666666668e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:21:20,043] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=0.915170830165535, CurrSamplesPerSec=0.9149579187219483, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:22:47,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[1.3333333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:22:47,699] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=0.9150524920703442, CurrSamplesPerSec=0.9145054438183264, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:24:15,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[1.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:24:15,350] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=0.9149708586234341, CurrSamplesPerSec=0.9145502598778551, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:25:42,979] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[1.6666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:25:42,979] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=0.9149227944884334, CurrSamplesPerSec=0.9111411242599212, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:27:10,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[1.8333333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:27:10,604] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=0.9148858337049267, CurrSamplesPerSec=0.9160074763636451, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:28:38,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[2.0000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:28:38,218] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=0.914871502860836, CurrSamplesPerSec=0.9136128301675135, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:30:05,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[2.166666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:30:05,878] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=0.9148200980714719, CurrSamplesPerSec=0.9164364338906033, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:31:33,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[2.3333333333333336e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:31:33,530] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=0.9147870027702413, CurrSamplesPerSec=0.9162243566838381, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:33:01,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[2.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:33:01,112] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=0.9147926017621605, CurrSamplesPerSec=0.9139508909571806, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:34:28,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[2.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:34:28,723] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=0.9147815284137463, CurrSamplesPerSec=0.9128803821065561, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:35:56,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[2.8333333333333335e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:35:56,370] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=0.9147525571140734, CurrSamplesPerSec=0.9163736387982043, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:37:24,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[3e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:37:24,025] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=0.914731660058754, CurrSamplesPerSec=0.9141824395208562, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:38:51,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[3.1666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:38:51,695] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=0.9146979143770368, CurrSamplesPerSec=0.9136817906821559, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:40:19,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[3.3333333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:40:19,342] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=0.9146765325688654, CurrSamplesPerSec=0.91332364276598, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:41:46,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[3.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:41:46,922] [INFO] [timer.py:260:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=0.9146901643181994, CurrSamplesPerSec=0.9155684525269653, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:43:14,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[3.6666666666666666e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:43:14,600] [INFO] [timer.py:260:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=0.9146618223052939, CurrSamplesPerSec=0.9167317287192037, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:44:42,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[3.833333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:44:42,209] [INFO] [timer.py:260:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=0.91466318642855, CurrSamplesPerSec=0.9133685419661092, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:46:09,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[4.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:46:09,824] [INFO] [timer.py:260:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=0.9146608446493919, CurrSamplesPerSec=0.9144841589748404, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:47:37,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[4.166666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:47:37,479] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=0.9146418253161357, CurrSamplesPerSec=0.9161917843169121, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:49:05,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[4.333333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:49:05,151] [INFO] [timer.py:260:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=0.9146192182017767, CurrSamplesPerSec=0.9159578917024903, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:50:32,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[4.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:50:32,775] [INFO] [timer.py:260:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=0.9146134125678081, CurrSamplesPerSec=0.9149054790255425, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:52:00,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[4.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:52:00,382] [INFO] [timer.py:260:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=0.9146178664287496, CurrSamplesPerSec=0.9126380988563041, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:53:28,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[4.833333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:53:28,079] [INFO] [timer.py:260:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=0.914590437814984, CurrSamplesPerSec=0.9126410031099405, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:54:55,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[5e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:54:55,836] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=0.9145426083566893, CurrSamplesPerSec=0.9131886734166209, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 13:56:23,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[5.1666666666666675e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:56:23,616] [INFO] [timer.py:260:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=0.9144928772153602, CurrSamplesPerSec=0.9146722924894279, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:57:51,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[5.333333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:57:51,347] [INFO] [timer.py:260:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=0.9144615128801946, CurrSamplesPerSec=0.9123574911813466, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 13:59:19,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[5.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-18 13:59:19,090] [INFO] [timer.py:260:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=0.9144294499115254, CurrSamplesPerSec=0.9152538341479062, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:00:46,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[5.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:00:46,807] [INFO] [timer.py:260:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=0.9144083659252964, CurrSamplesPerSec=0.9134232424158523, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:02:14,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[5.833333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:02:14,423] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=0.9144111253006914, CurrSamplesPerSec=0.9150651618964616, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:03:42,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[6e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:03:42,111] [INFO] [timer.py:260:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=0.9143952166477282, CurrSamplesPerSec=0.9140821015172712, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:05:09,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[6.166666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:05:09,780] [INFO] [timer.py:260:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=0.9143849004717033, CurrSamplesPerSec=0.913333164209821, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:06:37,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=0, lr=[6.333333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:06:37,496] [INFO] [timer.py:260:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=0.9143625304614597, CurrSamplesPerSec=0.9130582409588289, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:08:05,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=0, lr=[6.5000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:08:05,248] [INFO] [timer.py:260:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=0.9143345071323928, CurrSamplesPerSec=0.9142663080091765, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:09:32,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[6.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:09:32,995] [INFO] [timer.py:260:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=0.9143085240763538, CurrSamplesPerSec=0.9143846766863086, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:11:00,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[6.833333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:11:00,728] [INFO] [timer.py:260:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=0.9142884931767095, CurrSamplesPerSec=0.9127707204637165, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:12:28,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[7e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:12:28,439] [INFO] [timer.py:260:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=0.9142710538655364, CurrSamplesPerSec=0.9131306215257826, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:13:56,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[7.166666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:13:56,166] [INFO] [timer.py:260:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=0.914253309992045, CurrSamplesPerSec=0.9135029427516487, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:15:23,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[7.333333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:15:23,878] [INFO] [timer.py:260:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=0.9142395218052712, CurrSamplesPerSec=0.9124745968537137, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:16:51,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[7.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:16:51,595] [INFO] [timer.py:260:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=0.9142230355442028, CurrSamplesPerSec=0.9137858731023917, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:18:19,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[7.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:18:19,282] [INFO] [timer.py:260:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=0.9142157390084777, CurrSamplesPerSec=0.9137165485377687, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:19:47,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[7.833333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:19:47,047] [INFO] [timer.py:260:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=0.9141924474860759, CurrSamplesPerSec=0.9146065728221644, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:21:14,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[8.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:21:14,806] [INFO] [timer.py:260:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=0.9141730007157108, CurrSamplesPerSec=0.9128745208993991, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:22:42,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[8.166666666666668e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:22:42,564] [INFO] [timer.py:260:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=0.9141524847064186, CurrSamplesPerSec=0.912617099418499, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:24:10,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[8.333333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:24:10,252] [INFO] [timer.py:260:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=0.9141470793032436, CurrSamplesPerSec=0.9141817421343212, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:25:37,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[8.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:25:37,916] [INFO] [timer.py:260:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=0.9141431009150295, CurrSamplesPerSec=0.9142488704659757, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:27:05,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[8.666666666666668e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:27:05,716] [INFO] [timer.py:260:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=0.914116393698114, CurrSamplesPerSec=0.9142762726182305, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:28:33,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[8.833333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:28:33,408] [INFO] [timer.py:260:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=0.9141100012549666, CurrSamplesPerSec=0.9142165131303658, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:30:01,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[9e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:30:01,219] [INFO] [timer.py:260:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=0.9140850850441982, CurrSamplesPerSec=0.9139921422856668, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:31:28,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[9.166666666666666e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:31:28,959] [INFO] [timer.py:260:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=0.9140718016642534, CurrSamplesPerSec=0.9132204360937497, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:32:56,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[9.333333333333334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:32:56,653] [INFO] [timer.py:260:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=0.9140663513246151, CurrSamplesPerSec=0.9134910552044335, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:34:24,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[9.5e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:34:24,328] [INFO] [timer.py:260:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=0.914066404727956, CurrSamplesPerSec=0.915067757203366, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:35:52,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[9.666666666666667e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:35:52,055] [INFO] [timer.py:260:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=0.9140560276743742, CurrSamplesPerSec=0.9148042340326676, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:37:19,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[9.833333333333333e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:37:19,792] [INFO] [timer.py:260:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=0.9140428177292845, CurrSamplesPerSec=0.913406657541973, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:38:47,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[1e-05], mom=[(0.9, 0.95)]
[2024-05-18 14:38:47,539] [INFO] [timer.py:260:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=0.9140301903065122, CurrSamplesPerSec=0.9136960219253724, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:40:15,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=0, lr=[9.999999208685867e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:40:15,306] [INFO] [timer.py:260:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=0.9140139367018342, CurrSamplesPerSec=0.9138437594580889, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:41:42,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=0, lr=[9.999996834743712e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:41:42,987] [INFO] [timer.py:260:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=0.9140134004041481, CurrSamplesPerSec=0.911729454655643, MemAllocated=7.91GB, MaxMemAllocated=20.45GB
[2024-05-18 14:43:10,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=0, lr=[9.999992878174289e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:43:10,726] [INFO] [timer.py:260:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=0.9140026599491997, CurrSamplesPerSec=0.9116267813123425, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:44:38,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=0, lr=[9.999987338978852e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:44:38,492] [INFO] [timer.py:260:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=0.9139882189089575, CurrSamplesPerSec=0.9149698943767924, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:46:06,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[9.999980217159154e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:46:06,310] [INFO] [timer.py:260:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=0.9139662344876921, CurrSamplesPerSec=0.9121194524570176, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:47:34,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=0, lr=[9.999971512717445e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:47:34,135] [INFO] [timer.py:260:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=0.9139450719874809, CurrSamplesPerSec=0.9138824871849337, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:49:01,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=0, lr=[9.999961225656486e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:49:01,894] [INFO] [timer.py:260:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=0.9139331773840363, CurrSamplesPerSec=0.9137097311120911, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:50:29,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=0, lr=[9.99994935597953e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:50:29,650] [INFO] [timer.py:260:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=0.9139209398983688, CurrSamplesPerSec=0.9138722822597406, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 14:51:57,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=0, lr=[9.999935903690334e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:51:57,417] [INFO] [timer.py:260:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=0.9139094955208004, CurrSamplesPerSec=0.9130115835662861, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:53:25,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[9.999920868793156e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:53:25,224] [INFO] [timer.py:260:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=0.9138912367935489, CurrSamplesPerSec=0.9141384315342042, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
Beginning of Epoch 2/20
[2024-05-18 14:54:48,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=0, lr=[9.999904251292756e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:54:48,721] [INFO] [timer.py:260:stop] epoch=1/micro_step=4/global_step=710, RunningAvgSamplesPerSec=0.9145090174747835, CurrSamplesPerSec=0.9116643057996905, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:56:16,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=0, lr=[9.999886051194392e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:56:16,465] [INFO] [timer.py:260:stop] epoch=1/micro_step=14/global_step=720, RunningAvgSamplesPerSec=0.9144917299398247, CurrSamplesPerSec=0.9143562215561731, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:57:44,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=0, lr=[9.999866268503828e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:57:44,218] [INFO] [timer.py:260:stop] epoch=1/micro_step=24/global_step=730, RunningAvgSamplesPerSec=0.9144730870794257, CurrSamplesPerSec=0.913055731574105, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 14:59:11,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=0, lr=[9.999844903227323e-06], mom=[(0.9, 0.95)]
[2024-05-18 14:59:11,946] [INFO] [timer.py:260:stop] epoch=1/micro_step=34/global_step=740, RunningAvgSamplesPerSec=0.9144593780571314, CurrSamplesPerSec=0.9117690934962414, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:00:39,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[9.99982195537164e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:00:39,684] [INFO] [timer.py:260:stop] epoch=1/micro_step=44/global_step=750, RunningAvgSamplesPerSec=0.9144443670401542, CurrSamplesPerSec=0.9144930316931503, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:02:07,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[9.999797424944041e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:02:07,443] [INFO] [timer.py:260:stop] epoch=1/micro_step=54/global_step=760, RunningAvgSamplesPerSec=0.9144260766269301, CurrSamplesPerSec=0.9135861642459423, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:03:35,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[9.999771311952296e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:03:35,203] [INFO] [timer.py:260:stop] epoch=1/micro_step=64/global_step=770, RunningAvgSamplesPerSec=0.9144088555104708, CurrSamplesPerSec=0.9126380988563041, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:05:03,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=0, lr=[9.999743616404667e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:05:03,072] [INFO] [timer.py:260:stop] epoch=1/micro_step=74/global_step=780, RunningAvgSamplesPerSec=0.9143777171098142, CurrSamplesPerSec=0.9110048451725741, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:06:30,979] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=0, lr=[9.999714338309918e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:06:30,979] [INFO] [timer.py:260:stop] epoch=1/micro_step=84/global_step=790, RunningAvgSamplesPerSec=0.9143440903972616, CurrSamplesPerSec=0.9126951944118553, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:07:58,737] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[9.999683477677319e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:07:58,737] [INFO] [timer.py:260:stop] epoch=1/micro_step=94/global_step=800, RunningAvgSamplesPerSec=0.9143282151926234, CurrSamplesPerSec=0.9135693495956785, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:09:26,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=0, lr=[9.99965103451664e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:09:26,599] [INFO] [timer.py:260:stop] epoch=1/micro_step=104/global_step=810, RunningAvgSamplesPerSec=0.9143010950276791, CurrSamplesPerSec=0.9108539443032226, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:10:54,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=0, lr=[9.999617008838145e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:10:54,335] [INFO] [timer.py:260:stop] epoch=1/micro_step=114/global_step=820, RunningAvgSamplesPerSec=0.9142892970125653, CurrSamplesPerSec=0.9138589913086467, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:12:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=0, lr=[9.99958140065261e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:12:22,167] [INFO] [timer.py:260:stop] epoch=1/micro_step=124/global_step=830, RunningAvgSamplesPerSec=0.9142673879793779, CurrSamplesPerSec=0.9119893252363365, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:13:49,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=0, lr=[9.999544209971299e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:13:49,965] [INFO] [timer.py:260:stop] epoch=1/micro_step=134/global_step=840, RunningAvgSamplesPerSec=0.9142484626565897, CurrSamplesPerSec=0.9134421901902406, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:15:17,663] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[9.99950543680599e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:15:17,664] [INFO] [timer.py:260:stop] epoch=1/micro_step=144/global_step=850, RunningAvgSamplesPerSec=0.914242688699356, CurrSamplesPerSec=0.9136270841390047, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:16:45,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=0, lr=[9.999465081168954e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:16:45,382] [INFO] [timer.py:260:stop] epoch=1/micro_step=154/global_step=860, RunningAvgSamplesPerSec=0.9142333051026923, CurrSamplesPerSec=0.9136659178954009, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:18:13,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=0, lr=[9.999423143072961e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:18:13,035] [INFO] [timer.py:260:stop] epoch=1/micro_step=164/global_step=870, RunningAvgSamplesPerSec=0.9142325455851645, CurrSamplesPerSec=0.9149711668085434, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:19:40,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=0, lr=[9.999379622531292e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:19:40,800] [INFO] [timer.py:260:stop] epoch=1/micro_step=174/global_step=880, RunningAvgSamplesPerSec=0.9142199912889569, CurrSamplesPerSec=0.9130572222960402, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:21:08,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=0, lr=[9.999334519557715e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:21:08,646] [INFO] [timer.py:260:stop] epoch=1/micro_step=184/global_step=890, RunningAvgSamplesPerSec=0.9141989258251644, CurrSamplesPerSec=0.9105618056560373, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:22:36,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=0, lr=[9.99928783416651e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:22:36,421] [INFO] [timer.py:260:stop] epoch=1/micro_step=194/global_step=900, RunningAvgSamplesPerSec=0.9141848012794047, CurrSamplesPerSec=0.915176998036625, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:24:04,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=0, lr=[9.999239566372457e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:24:04,211] [INFO] [timer.py:260:stop] epoch=1/micro_step=204/global_step=910, RunningAvgSamplesPerSec=0.9141695188415496, CurrSamplesPerSec=0.9142977969150953, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:25:31,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=0, lr=[9.99918971619083e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:25:31,998] [INFO] [timer.py:260:stop] epoch=1/micro_step=214/global_step=920, RunningAvgSamplesPerSec=0.9141552025705647, CurrSamplesPerSec=0.914479797448903, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:26:59,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=0, lr=[9.999138283637408e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:26:59,802] [INFO] [timer.py:260:stop] epoch=1/micro_step=224/global_step=930, RunningAvgSamplesPerSec=0.9141396821173696, CurrSamplesPerSec=0.9105071508922714, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:28:27,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=0, lr=[9.999085268728473e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:28:27,553] [INFO] [timer.py:260:stop] epoch=1/micro_step=234/global_step=940, RunningAvgSamplesPerSec=0.9141293448269167, CurrSamplesPerSec=0.9112774193772661, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:29:55,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=0, lr=[9.999030671480804e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:29:55,378] [INFO] [timer.py:260:stop] epoch=1/micro_step=244/global_step=950, RunningAvgSamplesPerSec=0.914111549490985, CurrSamplesPerSec=0.9102277531200277, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:31:23,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=0, lr=[9.998974491911681e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:31:23,177] [INFO] [timer.py:260:stop] epoch=1/micro_step=254/global_step=960, RunningAvgSamplesPerSec=0.9140960987091329, CurrSamplesPerSec=0.9126738696272744, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:32:50,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=0, lr=[9.99891673003889e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:32:50,956] [INFO] [timer.py:260:stop] epoch=1/micro_step=264/global_step=970, RunningAvgSamplesPerSec=0.9140845698053148, CurrSamplesPerSec=0.9139167624677189, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:34:18,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=0, lr=[9.998857385880712e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:34:18,669] [INFO] [timer.py:260:stop] epoch=1/micro_step=274/global_step=980, RunningAvgSamplesPerSec=0.9140790835408499, CurrSamplesPerSec=0.9135386569929485, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:35:46,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=0, lr=[9.998796459455931e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:35:46,485] [INFO] [timer.py:260:stop] epoch=1/micro_step=284/global_step=990, RunningAvgSamplesPerSec=0.9140634690345073, CurrSamplesPerSec=0.9134151612551449, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:37:14,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=0, lr=[9.99873395078383e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:37:14,253] [INFO] [timer.py:260:stop] epoch=1/micro_step=294/global_step=1000, RunningAvgSamplesPerSec=0.9140529331211985, CurrSamplesPerSec=0.9122796771940711, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
saving model ... to step 1000
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-18 15:38:42,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=0, lr=[9.998669859884199e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:38:42,674] [INFO] [timer.py:260:stop] epoch=1/micro_step=304/global_step=1010, RunningAvgSamplesPerSec=0.9140392051124112, CurrSamplesPerSec=0.9119834011047268, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:40:10,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=0, lr=[9.998604186777318e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:40:10,543] [INFO] [timer.py:260:stop] epoch=1/micro_step=314/global_step=1020, RunningAvgSamplesPerSec=0.9140200517822904, CurrSamplesPerSec=0.913313102286838, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:41:38,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=0, lr=[9.998536931483981e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:41:38,401] [INFO] [timer.py:260:stop] epoch=1/micro_step=324/global_step=1030, RunningAvgSamplesPerSec=0.9140026901129727, CurrSamplesPerSec=0.9123776599943372, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:43:06,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=0, lr=[9.998468094025473e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:43:06,178] [INFO] [timer.py:260:stop] epoch=1/micro_step=334/global_step=1040, RunningAvgSamplesPerSec=0.9139933889498454, CurrSamplesPerSec=0.9141952417341511, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:44:33,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=0, lr=[9.998397674423581e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:44:33,933] [INFO] [timer.py:260:stop] epoch=1/micro_step=344/global_step=1050, RunningAvgSamplesPerSec=0.9139862273591166, CurrSamplesPerSec=0.9132006028015254, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:46:01,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=0, lr=[9.9983256727006e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:46:01,718] [INFO] [timer.py:260:stop] epoch=1/micro_step=354/global_step=1060, RunningAvgSamplesPerSec=0.913974664090532, CurrSamplesPerSec=0.9134634762916757, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:47:29,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=0, lr=[9.998252088879312e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:47:29,501] [INFO] [timer.py:260:stop] epoch=1/micro_step=364/global_step=1070, RunningAvgSamplesPerSec=0.9139637704378081, CurrSamplesPerSec=0.9139482521938466, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:48:57,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=0, lr=[9.998176922983017e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:48:57,338] [INFO] [timer.py:260:stop] epoch=1/micro_step=374/global_step=1080, RunningAvgSamplesPerSec=0.9139486320918786, CurrSamplesPerSec=0.9127364069473487, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:50:25,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=0, lr=[9.998100175035501e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:50:25,136] [INFO] [timer.py:260:stop] epoch=1/micro_step=384/global_step=1090, RunningAvgSamplesPerSec=0.9139371607363244, CurrSamplesPerSec=0.9124104331160968, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:51:52,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=0, lr=[9.998021845061059e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:51:52,984] [INFO] [timer.py:260:stop] epoch=1/micro_step=394/global_step=1100, RunningAvgSamplesPerSec=0.9139215742608444, CurrSamplesPerSec=0.9126408789961591, MemAllocated=7.89GB, MaxMemAllocated=20.45GB
[2024-05-18 15:53:20,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=0, lr=[9.997941933084485e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:53:20,860] [INFO] [timer.py:260:stop] epoch=1/micro_step=404/global_step=1110, RunningAvgSamplesPerSec=0.9139037852079961, CurrSamplesPerSec=0.9116096424421989, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:54:48,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=0, lr=[9.99786043913107e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:54:48,781] [INFO] [timer.py:260:stop] epoch=1/micro_step=414/global_step=1120, RunningAvgSamplesPerSec=0.9138824665691432, CurrSamplesPerSec=0.913033296796871, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:56:16,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=0, lr=[9.997777363226615e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:56:16,628] [INFO] [timer.py:260:stop] epoch=1/micro_step=424/global_step=1130, RunningAvgSamplesPerSec=0.9138675449729671, CurrSamplesPerSec=0.9096598538392742, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:57:44,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=0, lr=[9.997692705397408e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:57:44,494] [INFO] [timer.py:260:stop] epoch=1/micro_step=434/global_step=1140, RunningAvgSamplesPerSec=0.913851430061797, CurrSamplesPerSec=0.9134432843114556, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 15:59:12,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=0, lr=[9.997606465670253e-06], mom=[(0.9, 0.95)]
[2024-05-18 15:59:12,397] [INFO] [timer.py:260:stop] epoch=1/micro_step=444/global_step=1150, RunningAvgSamplesPerSec=0.9138319575165147, CurrSamplesPerSec=0.9133416416937242, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 16:00:40,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=0, lr=[9.99751864407244e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:00:40,218] [INFO] [timer.py:260:stop] epoch=1/micro_step=454/global_step=1160, RunningAvgSamplesPerSec=0.913819599149211, CurrSamplesPerSec=0.9128320790645934, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 16:02:08,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=0, lr=[9.997429240631772e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:02:08,096] [INFO] [timer.py:260:stop] epoch=1/micro_step=464/global_step=1170, RunningAvgSamplesPerSec=0.9138034414735474, CurrSamplesPerSec=0.9124874505357076, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 16:03:35,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=0, lr=[9.997338255376545e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:03:35,974] [INFO] [timer.py:260:stop] epoch=1/micro_step=474/global_step=1180, RunningAvgSamplesPerSec=0.9137878761442271, CurrSamplesPerSec=0.9132662199901369, MemAllocated=7.9GB, MaxMemAllocated=20.45GB
[2024-05-18 16:05:03,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=0, lr=[9.99724568833556e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:05:03,879] [INFO] [timer.py:260:stop] epoch=1/micro_step=484/global_step=1190, RunningAvgSamplesPerSec=0.9137707467451144, CurrSamplesPerSec=0.9120002317886942, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:06:31,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=0, lr=[9.997151539538114e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:06:31,729] [INFO] [timer.py:260:stop] epoch=1/micro_step=494/global_step=1200, RunningAvgSamplesPerSec=0.9137579671272577, CurrSamplesPerSec=0.9122248160179548, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:07:59,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=0, lr=[9.997055809014009e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:07:59,499] [INFO] [timer.py:260:stop] epoch=1/micro_step=504/global_step=1210, RunningAvgSamplesPerSec=0.9137509218449139, CurrSamplesPerSec=0.9142955547535523, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:09:27,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=0, lr=[9.996958496793547e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:09:27,259] [INFO] [timer.py:260:stop] epoch=1/micro_step=514/global_step=1220, RunningAvgSamplesPerSec=0.9137455510050027, CurrSamplesPerSec=0.9138108584027809, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:10:55,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=0, lr=[9.996859602907529e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:10:55,048] [INFO] [timer.py:260:stop] epoch=1/micro_step=524/global_step=1230, RunningAvgSamplesPerSec=0.9137379081753639, CurrSamplesPerSec=0.9127735014116334, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:12:22,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=0, lr=[9.996759127387259e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:12:22,813] [INFO] [timer.py:260:stop] epoch=1/micro_step=534/global_step=1240, RunningAvgSamplesPerSec=0.9137327792727089, CurrSamplesPerSec=0.9127424153507185, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:13:50,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=0, lr=[9.996657070264537e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:13:50,734] [INFO] [timer.py:260:stop] epoch=1/micro_step=544/global_step=1250, RunningAvgSamplesPerSec=0.9137156463921194, CurrSamplesPerSec=0.9133077824204098, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:15:18,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=0, lr=[9.996553431571669e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:15:18,488] [INFO] [timer.py:260:stop] epoch=1/micro_step=554/global_step=1260, RunningAvgSamplesPerSec=0.9137104421178521, CurrSamplesPerSec=0.9145512070944755, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:16:46,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=0, lr=[9.996448211341459e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:16:46,299] [INFO] [timer.py:260:stop] epoch=1/micro_step=564/global_step=1270, RunningAvgSamplesPerSec=0.9137013828514752, CurrSamplesPerSec=0.9123221420919772, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:18:14,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=0, lr=[9.99634140960721e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:18:14,109] [INFO] [timer.py:260:stop] epoch=1/micro_step=574/global_step=1280, RunningAvgSamplesPerSec=0.9136930961964974, CurrSamplesPerSec=0.9124565328316419, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:19:41,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=0, lr=[9.99623302640273e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:19:41,946] [INFO] [timer.py:260:stop] epoch=1/micro_step=584/global_step=1290, RunningAvgSamplesPerSec=0.9136828983966583, CurrSamplesPerSec=0.9135287581978717, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:21:09,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=0, lr=[9.996123061762324e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:21:09,795] [INFO] [timer.py:260:stop] epoch=1/micro_step=594/global_step=1300, RunningAvgSamplesPerSec=0.9136710481751287, CurrSamplesPerSec=0.9109741020515685, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:22:37,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=0, lr=[9.996011515720798e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:22:37,596] [INFO] [timer.py:260:stop] epoch=1/micro_step=604/global_step=1310, RunningAvgSamplesPerSec=0.9136632817664087, CurrSamplesPerSec=0.911963571935453, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:24:05,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=0, lr=[9.99589838831346e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:24:05,445] [INFO] [timer.py:260:stop] epoch=1/micro_step=614/global_step=1320, RunningAvgSamplesPerSec=0.913651787761656, CurrSamplesPerSec=0.9125050442898095, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:25:33,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=0, lr=[9.99578367957612e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:25:33,211] [INFO] [timer.py:260:stop] epoch=1/micro_step=624/global_step=1330, RunningAvgSamplesPerSec=0.9136479583751346, CurrSamplesPerSec=0.9115906715541758, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:27:00,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=0, lr=[9.995667389545082e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:27:01,000] [INFO] [timer.py:260:stop] epoch=1/micro_step=634/global_step=1340, RunningAvgSamplesPerSec=0.9136418644537513, CurrSamplesPerSec=0.9118106684333439, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:28:28,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=0, lr=[9.995549518257156e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:28:28,877] [INFO] [timer.py:260:stop] epoch=1/micro_step=644/global_step=1350, RunningAvgSamplesPerSec=0.9136290424053669, CurrSamplesPerSec=0.9108881658788683, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 16:29:56,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=0, lr=[9.995430065749653e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:29:56,809] [INFO] [timer.py:260:stop] epoch=1/micro_step=654/global_step=1360, RunningAvgSamplesPerSec=0.9136134359578393, CurrSamplesPerSec=0.909647622218669, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:31:24,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=0, lr=[9.995309032060384e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:31:24,579] [INFO] [timer.py:260:stop] epoch=1/micro_step=664/global_step=1370, RunningAvgSamplesPerSec=0.9136092613435424, CurrSamplesPerSec=0.9143243798238887, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:32:52,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=0, lr=[9.995186417227654e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:32:52,401] [INFO] [timer.py:260:stop] epoch=1/micro_step=674/global_step=1380, RunningAvgSamplesPerSec=0.9136004735797137, CurrSamplesPerSec=0.9134891154248358, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:34:20,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=0, lr=[9.995062221290278e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:34:20,203] [INFO] [timer.py:260:stop] epoch=1/micro_step=684/global_step=1390, RunningAvgSamplesPerSec=0.9135937728040441, CurrSamplesPerSec=0.91255420617509, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:35:48,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=0, lr=[9.994936444287565e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:35:48,048] [INFO] [timer.py:260:stop] epoch=1/micro_step=694/global_step=1400, RunningAvgSamplesPerSec=0.913585203867937, CurrSamplesPerSec=0.9105298076088909, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 16:37:15,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=0, lr=[9.994809086259327e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:37:15,845] [INFO] [timer.py:260:stop] epoch=1/micro_step=704/global_step=1410, RunningAvgSamplesPerSec=0.9135783515877425, CurrSamplesPerSec=0.911623586300686, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 3/20
[2024-05-18 16:38:39,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=0, lr=[9.99468014724588e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:38:39,360] [INFO] [timer.py:260:stop] epoch=2/micro_step=8/global_step=1420, RunningAvgSamplesPerSec=0.9138874596277576, CurrSamplesPerSec=0.9140347169636982, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:40:07,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=0, lr=[9.99454962728803e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:40:07,123] [INFO] [timer.py:260:stop] epoch=2/micro_step=18/global_step=1430, RunningAvgSamplesPerSec=0.9138812875523289, CurrSamplesPerSec=0.9145739907380473, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:41:34,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=0, lr=[9.994417526427094e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:41:34,923] [INFO] [timer.py:260:stop] epoch=2/micro_step=28/global_step=1440, RunningAvgSamplesPerSec=0.9138726394750069, CurrSamplesPerSec=0.9138674038882142, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:43:02,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=0, lr=[9.994283844704884e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:43:02,803] [INFO] [timer.py:260:stop] epoch=2/micro_step=38/global_step=1450, RunningAvgSamplesPerSec=0.9138594044019053, CurrSamplesPerSec=0.9117254909611436, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:44:30,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=0, lr=[9.994148582163715e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:44:30,633] [INFO] [timer.py:260:stop] epoch=2/micro_step=48/global_step=1460, RunningAvgSamplesPerSec=0.9138487014542448, CurrSamplesPerSec=0.9110099898395756, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:45:58,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=0, lr=[9.994011738846399e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:45:58,486] [INFO] [timer.py:260:stop] epoch=2/micro_step=58/global_step=1470, RunningAvgSamplesPerSec=0.9138375625343206, CurrSamplesPerSec=0.913266617698816, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:47:26,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=0, lr=[9.993873314796253e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:47:26,266] [INFO] [timer.py:260:stop] epoch=2/micro_step=68/global_step=1480, RunningAvgSamplesPerSec=0.9138307613692024, CurrSamplesPerSec=0.9141534988737918, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 16:48:54,133] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=0, lr=[9.99373331005709e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:48:54,134] [INFO] [timer.py:260:stop] epoch=2/micro_step=78/global_step=1490, RunningAvgSamplesPerSec=0.9138190310616281, CurrSamplesPerSec=0.9133884571441389, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:50:22,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=0, lr=[9.993591724673225e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:50:22,032] [INFO] [timer.py:260:stop] epoch=2/micro_step=88/global_step=1500, RunningAvgSamplesPerSec=0.9138051662055171, CurrSamplesPerSec=0.9137156279305498, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:51:49,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=0, lr=[9.993448558689474e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:51:49,824] [INFO] [timer.py:260:stop] epoch=2/micro_step=98/global_step=1510, RunningAvgSamplesPerSec=0.9137979520955548, CurrSamplesPerSec=0.913664524699067, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:53:17,736] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=0, lr=[9.993303812151153e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:53:17,737] [INFO] [timer.py:260:stop] epoch=2/micro_step=108/global_step=1520, RunningAvgSamplesPerSec=0.9137836245986012, CurrSamplesPerSec=0.9106023809310582, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:54:45,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=0, lr=[9.993157485104077e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:54:45,609] [INFO] [timer.py:260:stop] epoch=2/micro_step=118/global_step=1530, RunningAvgSamplesPerSec=0.9137718269463987, CurrSamplesPerSec=0.9112927390425412, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:56:13,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=0, lr=[9.993009577594564e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:56:13,525] [INFO] [timer.py:260:stop] epoch=2/micro_step=128/global_step=1540, RunningAvgSamplesPerSec=0.9137574400522862, CurrSamplesPerSec=0.912649393279833, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 16:57:41,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=0, lr=[9.992860089669428e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:57:41,415] [INFO] [timer.py:260:stop] epoch=2/micro_step=138/global_step=1550, RunningAvgSamplesPerSec=0.9137452865408926, CurrSamplesPerSec=0.9108851738610756, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 16:59:09,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=0, lr=[9.992709021375987e-06], mom=[(0.9, 0.95)]
[2024-05-18 16:59:09,169] [INFO] [timer.py:260:stop] epoch=2/micro_step=148/global_step=1560, RunningAvgSamplesPerSec=0.9137405762980235, CurrSamplesPerSec=0.9131767940472112, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:00:36,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=0, lr=[9.992556372762059e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:00:36,931] [INFO] [timer.py:260:stop] epoch=2/micro_step=158/global_step=1570, RunningAvgSamplesPerSec=0.9137357359149485, CurrSamplesPerSec=0.9132056728844901, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:02:04,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=0, lr=[9.99240214387596e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:02:04,759] [INFO] [timer.py:260:stop] epoch=2/micro_step=168/global_step=1580, RunningAvgSamplesPerSec=0.9137276303906394, CurrSamplesPerSec=0.9123702175241075, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:03:32,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=0, lr=[9.992246334766508e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:03:32,531] [INFO] [timer.py:260:stop] epoch=2/micro_step=178/global_step=1590, RunningAvgSamplesPerSec=0.9137234106108972, CurrSamplesPerSec=0.9137993112415558, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:05:00,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=0, lr=[9.99208894548302e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:05:00,339] [INFO] [timer.py:260:stop] epoch=2/micro_step=188/global_step=1600, RunningAvgSamplesPerSec=0.9137170818044672, CurrSamplesPerSec=0.9143647927925198, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:06:28,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=0, lr=[9.991929976075314e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:06:28,142] [INFO] [timer.py:260:stop] epoch=2/micro_step=198/global_step=1610, RunningAvgSamplesPerSec=0.9137099675583531, CurrSamplesPerSec=0.9116094938420966, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:07:55,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=0, lr=[9.991769426593707e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:07:55,978] [INFO] [timer.py:260:stop] epoch=2/micro_step=208/global_step=1620, RunningAvgSamplesPerSec=0.9137015186644609, CurrSamplesPerSec=0.9108778051737975, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:09:23,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=0, lr=[9.991607297089019e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:09:23,793] [INFO] [timer.py:260:stop] epoch=2/micro_step=218/global_step=1630, RunningAvgSamplesPerSec=0.9136948446876976, CurrSamplesPerSec=0.9143245293104081, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:10:51,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=0, lr=[9.991443587612568e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:10:51,616] [INFO] [timer.py:260:stop] epoch=2/micro_step=228/global_step=1640, RunningAvgSamplesPerSec=0.9136871436594736, CurrSamplesPerSec=0.9129886292830652, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:12:19,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=0, lr=[9.991278298216169e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:12:19,458] [INFO] [timer.py:260:stop] epoch=2/micro_step=238/global_step=1650, RunningAvgSamplesPerSec=0.9136784738523981, CurrSamplesPerSec=0.912755351066122, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:13:47,290] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=0, lr=[9.991111428952145e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:13:47,290] [INFO] [timer.py:260:stop] epoch=2/micro_step=248/global_step=1660, RunningAvgSamplesPerSec=0.9136707347850244, CurrSamplesPerSec=0.9129905917794737, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:15:15,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=0, lr=[9.99094297987331e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:15:15,078] [INFO] [timer.py:260:stop] epoch=2/micro_step=258/global_step=1670, RunningAvgSamplesPerSec=0.9136654321226998, CurrSamplesPerSec=0.9133368435676698, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:16:42,920] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=0, lr=[9.990772951032987e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:16:42,921] [INFO] [timer.py:260:stop] epoch=2/micro_step=268/global_step=1680, RunningAvgSamplesPerSec=0.9136569170366045, CurrSamplesPerSec=0.911247350772675, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:18:10,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=0, lr=[9.99060134248499e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:18:10,698] [INFO] [timer.py:260:stop] epoch=2/micro_step=278/global_step=1690, RunningAvgSamplesPerSec=0.9136526605504879, CurrSamplesPerSec=0.9115537474553216, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:19:38,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=0, lr=[9.990428154283641e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:19:38,556] [INFO] [timer.py:260:stop] epoch=2/micro_step=288/global_step=1700, RunningAvgSamplesPerSec=0.9136436613127354, CurrSamplesPerSec=0.9111553754352263, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:21:06,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=0, lr=[9.990253386483757e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:21:06,392] [INFO] [timer.py:260:stop] epoch=2/micro_step=298/global_step=1710, RunningAvgSamplesPerSec=0.913635682929517, CurrSamplesPerSec=0.9129691538266558, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:22:34,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=0, lr=[9.990077039140655e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:22:34,316] [INFO] [timer.py:260:stop] epoch=2/micro_step=308/global_step=1720, RunningAvgSamplesPerSec=0.9136234454617039, CurrSamplesPerSec=0.9104404473685153, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 17:24:02,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=0, lr=[9.989899112310156e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:24:02,141] [INFO] [timer.py:260:stop] epoch=2/micro_step=318/global_step=1730, RunningAvgSamplesPerSec=0.9136171865945817, CurrSamplesPerSec=0.9109567898637014, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:25:29,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=0, lr=[9.989719606048578e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:25:29,930] [INFO] [timer.py:260:stop] epoch=2/micro_step=328/global_step=1740, RunningAvgSamplesPerSec=0.9136131407840857, CurrSamplesPerSec=0.9122570325183337, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:26:57,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=0, lr=[9.989538520412739e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:26:57,744] [INFO] [timer.py:260:stop] epoch=2/micro_step=338/global_step=1750, RunningAvgSamplesPerSec=0.9136072604317851, CurrSamplesPerSec=0.9130926780673794, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:28:25,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=0, lr=[9.989355855459954e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:28:25,535] [INFO] [timer.py:260:stop] epoch=2/micro_step=348/global_step=1760, RunningAvgSamplesPerSec=0.913602550667241, CurrSamplesPerSec=0.9114315057068041, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:29:53,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=0, lr=[9.989171611248048e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:29:53,374] [INFO] [timer.py:260:stop] epoch=2/micro_step=358/global_step=1770, RunningAvgSamplesPerSec=0.9135948578337122, CurrSamplesPerSec=0.9139948808882846, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:31:21,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=0, lr=[9.988985787835332e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:31:21,192] [INFO] [timer.py:260:stop] epoch=2/micro_step=368/global_step=1780, RunningAvgSamplesPerSec=0.9135884997547006, CurrSamplesPerSec=0.9123436737024223, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:32:49,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=0, lr=[9.98879838528063e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:32:49,085] [INFO] [timer.py:260:stop] epoch=2/micro_step=378/global_step=1790, RunningAvgSamplesPerSec=0.9135780154581015, CurrSamplesPerSec=0.9109936161493083, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:34:16,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=0, lr=[9.988609403643254e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:34:16,908] [INFO] [timer.py:260:stop] epoch=2/micro_step=388/global_step=1800, RunningAvgSamplesPerSec=0.9135722502338902, CurrSamplesPerSec=0.9130031867357261, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:35:44,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=0, lr=[9.988418842983025e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:35:44,688] [INFO] [timer.py:260:stop] epoch=2/micro_step=398/global_step=1810, RunningAvgSamplesPerSec=0.9135682184404116, CurrSamplesPerSec=0.9112313149949012, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 17:37:12,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=0, lr=[9.98822670336026e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:37:12,580] [INFO] [timer.py:260:stop] epoch=2/micro_step=408/global_step=1820, RunningAvgSamplesPerSec=0.913558798642346, CurrSamplesPerSec=0.913311983618191, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:38:40,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=0, lr=[9.988032984835776e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:38:40,391] [INFO] [timer.py:260:stop] epoch=2/micro_step=418/global_step=1830, RunningAvgSamplesPerSec=0.9135536942672051, CurrSamplesPerSec=0.9120210293240042, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:40:08,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=0, lr=[9.987837687470889e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:40:08,279] [INFO] [timer.py:260:stop] epoch=2/micro_step=428/global_step=1840, RunningAvgSamplesPerSec=0.9135442408938494, CurrSamplesPerSec=0.9110337846803146, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:41:36,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=0, lr=[9.987640811327417e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:41:36,137] [INFO] [timer.py:260:stop] epoch=2/micro_step=438/global_step=1850, RunningAvgSamplesPerSec=0.9135365917519319, CurrSamplesPerSec=0.9123676623039954, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:43:03,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=0, lr=[9.987442356467677e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:43:03,970] [INFO] [timer.py:260:stop] epoch=2/micro_step=448/global_step=1860, RunningAvgSamplesPerSec=0.9135299166318995, CurrSamplesPerSec=0.91188032362122, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:44:31,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=0, lr=[9.98724232295448e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:44:31,834] [INFO] [timer.py:260:stop] epoch=2/micro_step=458/global_step=1870, RunningAvgSamplesPerSec=0.9135217769085405, CurrSamplesPerSec=0.9098906887008835, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 17:45:59,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=0, lr=[9.987040710851148e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:45:59,677] [INFO] [timer.py:260:stop] epoch=2/micro_step=468/global_step=1880, RunningAvgSamplesPerSec=0.9135153077265955, CurrSamplesPerSec=0.910005483719969, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 17:47:27,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=0, lr=[9.986837520221494e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:47:27,502] [INFO] [timer.py:260:stop] epoch=2/micro_step=478/global_step=1890, RunningAvgSamplesPerSec=0.9135099701997028, CurrSamplesPerSec=0.9102123457861785, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 17:48:55,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=0, lr=[9.98663275112983e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:48:55,347] [INFO] [timer.py:260:stop] epoch=2/micro_step=488/global_step=1900, RunningAvgSamplesPerSec=0.9135036093981644, CurrSamplesPerSec=0.9128668219704632, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:50:23,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=0, lr=[9.986426403640977e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:50:23,201] [INFO] [timer.py:260:stop] epoch=2/micro_step=498/global_step=1910, RunningAvgSamplesPerSec=0.9134962255659371, CurrSamplesPerSec=0.912717339480346, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:51:50,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=0, lr=[9.986218477820244e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:51:50,958] [INFO] [timer.py:260:stop] epoch=2/micro_step=508/global_step=1920, RunningAvgSamplesPerSec=0.9134937320292675, CurrSamplesPerSec=0.9123148989676053, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:53:18,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=0, lr=[9.986008973733446e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:53:18,803] [INFO] [timer.py:260:stop] epoch=2/micro_step=518/global_step=1930, RunningAvgSamplesPerSec=0.9134873770676702, CurrSamplesPerSec=0.9132437500124176, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:54:46,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=0, lr=[9.985797891446898e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:54:46,564] [INFO] [timer.py:260:stop] epoch=2/micro_step=528/global_step=1940, RunningAvgSamplesPerSec=0.9134850050272169, CurrSamplesPerSec=0.912859818541453, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 17:56:14,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=0, lr=[9.985585231027413e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:56:14,458] [INFO] [timer.py:260:stop] epoch=2/micro_step=538/global_step=1950, RunningAvgSamplesPerSec=0.9134766730677608, CurrSamplesPerSec=0.907772585685795, MemAllocated=7.92GB, MaxMemAllocated=20.46GB
[2024-05-18 17:57:42,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=0, lr=[9.9853709925423e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:57:42,244] [INFO] [timer.py:260:stop] epoch=2/micro_step=548/global_step=1960, RunningAvgSamplesPerSec=0.9134734420782542, CurrSamplesPerSec=0.9124980712257117, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 17:59:10,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=0, lr=[9.985155176059375e-06], mom=[(0.9, 0.95)]
[2024-05-18 17:59:10,014] [INFO] [timer.py:260:stop] epoch=2/micro_step=558/global_step=1970, RunningAvgSamplesPerSec=0.9134707415699229, CurrSamplesPerSec=0.9136665149808447, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:00:37,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=0, lr=[9.984937781646948e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:00:37,846] [INFO] [timer.py:260:stop] epoch=2/micro_step=568/global_step=1980, RunningAvgSamplesPerSec=0.9134657036876989, CurrSamplesPerSec=0.9110624291830767, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 18:02:05,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=0, lr=[9.98471880937383e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:02:05,636] [INFO] [timer.py:260:stop] epoch=2/micro_step=578/global_step=1990, RunningAvgSamplesPerSec=0.9134625487516187, CurrSamplesPerSec=0.9132287623566256, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:03:33,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=0, lr=[9.984498259309332e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:03:33,407] [INFO] [timer.py:260:stop] epoch=2/micro_step=588/global_step=2000, RunningAvgSamplesPerSec=0.9134599408608586, CurrSamplesPerSec=0.9134904583482952, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
evaluating model ...
***** Evaluating perplexity, Epoch 3/20 *****
ppl: 1.2206162214279175, loss: 0.19932542741298676
saving model ... to step 2000
[2024-05-18 18:11:14,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=0, lr=[9.984276131523262e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:11:14,302] [INFO] [timer.py:260:stop] epoch=2/micro_step=598/global_step=2010, RunningAvgSamplesPerSec=0.9134565347891123, CurrSamplesPerSec=0.912620499971102, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:12:42,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=0, lr=[9.984052426085931e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:12:42,100] [INFO] [timer.py:260:stop] epoch=2/micro_step=608/global_step=2020, RunningAvgSamplesPerSec=0.9134530361682612, CurrSamplesPerSec=0.9126279465251623, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 18:14:09,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=0, lr=[9.983827143068144e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:14:09,821] [INFO] [timer.py:260:stop] epoch=2/micro_step=618/global_step=2030, RunningAvgSamplesPerSec=0.9134530603282579, CurrSamplesPerSec=0.9133339348836729, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:15:37,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=0, lr=[9.983600282541213e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:15:37,582] [INFO] [timer.py:260:stop] epoch=2/micro_step=628/global_step=2040, RunningAvgSamplesPerSec=0.9134517508450278, CurrSamplesPerSec=0.9117224934400653, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 18:17:05,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=0, lr=[9.983371844576944e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:17:05,354] [INFO] [timer.py:260:stop] epoch=2/micro_step=638/global_step=2050, RunningAvgSamplesPerSec=0.9134496830036511, CurrSamplesPerSec=0.9122927238155933, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:18:33,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=0, lr=[9.983141829247644e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:18:33,131] [INFO] [timer.py:260:stop] epoch=2/micro_step=648/global_step=2060, RunningAvgSamplesPerSec=0.913447510970117, CurrSamplesPerSec=0.9149271576954298, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:20:00,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=0, lr=[9.982910236626116e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:20:00,991] [INFO] [timer.py:260:stop] epoch=2/micro_step=658/global_step=2070, RunningAvgSamplesPerSec=0.9134415229473701, CurrSamplesPerSec=0.9124396853018257, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:21:28,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=0, lr=[9.982677066785667e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:21:28,812] [INFO] [timer.py:260:stop] epoch=2/micro_step=668/global_step=2080, RunningAvgSamplesPerSec=0.9134370958933694, CurrSamplesPerSec=0.9100879457373897, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:22:56,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=0, lr=[9.982442319800102e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:22:56,564] [INFO] [timer.py:260:stop] epoch=2/micro_step=678/global_step=2090, RunningAvgSamplesPerSec=0.9134354567912305, CurrSamplesPerSec=0.9121671345742369, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 18:24:24,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=0, lr=[9.982205995743723e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:24:24,371] [INFO] [timer.py:260:stop] epoch=2/micro_step=688/global_step=2100, RunningAvgSamplesPerSec=0.9134318385408356, CurrSamplesPerSec=0.9127891197285944, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:25:52,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=0, lr=[9.981968094691334e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:25:52,260] [INFO] [timer.py:260:stop] epoch=2/micro_step=698/global_step=2110, RunningAvgSamplesPerSec=0.9134244014389457, CurrSamplesPerSec=0.9106492866989054, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 4/20
[2024-05-18 18:27:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=0, lr=[9.981728616718234e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:27:15,684] [INFO] [timer.py:260:stop] epoch=3/micro_step=2/global_step=2120, RunningAvgSamplesPerSec=0.913636158123929, CurrSamplesPerSec=0.9136307907419793, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:28:43,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=0, lr=[9.981487561900228e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:28:43,413] [INFO] [timer.py:260:stop] epoch=3/micro_step=12/global_step=2130, RunningAvgSamplesPerSec=0.9136351163269479, CurrSamplesPerSec=0.914606498032779, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:30:11,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=0, lr=[9.981244930313613e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:30:11,197] [INFO] [timer.py:260:stop] epoch=3/micro_step=22/global_step=2140, RunningAvgSamplesPerSec=0.9136314777936206, CurrSamplesPerSec=0.9116808522315706, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:31:38,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=0, lr=[9.981000722035187e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:31:38,986] [INFO] [timer.py:260:stop] epoch=3/micro_step=32/global_step=2150, RunningAvgSamplesPerSec=0.9136277652186182, CurrSamplesPerSec=0.9130960324700323, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:33:06,798] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=0, lr=[9.980754937142254e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:33:06,798] [INFO] [timer.py:260:stop] epoch=3/micro_step=42/global_step=2160, RunningAvgSamplesPerSec=0.9136229862786648, CurrSamplesPerSec=0.9109782323421779, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:34:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=0, lr=[9.980507575712605e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:34:34,502] [INFO] [timer.py:260:stop] epoch=3/micro_step=52/global_step=2170, RunningAvgSamplesPerSec=0.9136229772517896, CurrSamplesPerSec=0.9122093162030637, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:36:02,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=0, lr=[9.98025863782454e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:36:02,287] [INFO] [timer.py:260:stop] epoch=3/micro_step=62/global_step=2180, RunningAvgSamplesPerSec=0.9136196654724323, CurrSamplesPerSec=0.9120818657006781, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:37:30,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=0, lr=[9.980008123556853e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:37:30,061] [INFO] [timer.py:260:stop] epoch=3/micro_step=72/global_step=2190, RunningAvgSamplesPerSec=0.9136165914090013, CurrSamplesPerSec=0.9123435000563376, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:38:57,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=0, lr=[9.979756032988837e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:38:57,926] [INFO] [timer.py:260:stop] epoch=3/micro_step=82/global_step=2200, RunningAvgSamplesPerSec=0.913610054605372, CurrSamplesPerSec=0.9087215153772068, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 18:40:25,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=0, lr=[9.979502366200287e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:40:25,729] [INFO] [timer.py:260:stop] epoch=3/micro_step=92/global_step=2210, RunningAvgSamplesPerSec=0.9136058080995683, CurrSamplesPerSec=0.9117091410856215, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:41:53,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=0, lr=[9.979247123271494e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:41:53,552] [INFO] [timer.py:260:stop] epoch=3/micro_step=102/global_step=2220, RunningAvgSamplesPerSec=0.9136010083290714, CurrSamplesPerSec=0.9133214302395706, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:43:21,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=0, lr=[9.978990304283249e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:43:21,413] [INFO] [timer.py:260:stop] epoch=3/micro_step=112/global_step=2230, RunningAvgSamplesPerSec=0.9135940010931307, CurrSamplesPerSec=0.9136037257692834, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:44:49,226] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=0, lr=[9.978731909316841e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:44:49,226] [INFO] [timer.py:260:stop] epoch=3/micro_step=122/global_step=2240, RunningAvgSamplesPerSec=0.9135896671870409, CurrSamplesPerSec=0.9102676565887621, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:46:17,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=0, lr=[9.97847193845406e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:46:17,050] [INFO] [timer.py:260:stop] epoch=3/micro_step=132/global_step=2250, RunningAvgSamplesPerSec=0.9135848583301366, CurrSamplesPerSec=0.9129051688909953, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:47:44,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=0, lr=[9.978210391777195e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:47:44,856] [INFO] [timer.py:260:stop] epoch=3/micro_step=142/global_step=2260, RunningAvgSamplesPerSec=0.913580916612869, CurrSamplesPerSec=0.9136277558030843, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:49:12,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=0, lr=[9.977947269369029e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:49:12,630] [INFO] [timer.py:260:stop] epoch=3/micro_step=152/global_step=2270, RunningAvgSamplesPerSec=0.9135778548907451, CurrSamplesPerSec=0.9123755264737902, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 18:50:40,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=0, lr=[9.977682571312847e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:50:40,435] [INFO] [timer.py:260:stop] epoch=3/micro_step=162/global_step=2280, RunningAvgSamplesPerSec=0.9135735297461759, CurrSamplesPerSec=0.9119633240762937, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:52:08,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=0, lr=[9.977416297692437e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:52:08,269] [INFO] [timer.py:260:stop] epoch=3/micro_step=172/global_step=2290, RunningAvgSamplesPerSec=0.9135685358333951, CurrSamplesPerSec=0.9137812445015269, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:53:36,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=0, lr=[9.977148448592077e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:53:36,019] [INFO] [timer.py:260:stop] epoch=3/micro_step=182/global_step=2300, RunningAvgSamplesPerSec=0.9135674561667692, CurrSamplesPerSec=0.9129769786869664, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:55:03,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=0, lr=[9.97687902409655e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:55:03,832] [INFO] [timer.py:260:stop] epoch=3/micro_step=192/global_step=2310, RunningAvgSamplesPerSec=0.913563319254057, CurrSamplesPerSec=0.9130549613696791, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:56:31,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=0, lr=[9.976608024291135e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:56:31,597] [INFO] [timer.py:260:stop] epoch=3/micro_step=202/global_step=2320, RunningAvgSamplesPerSec=0.9135611491467488, CurrSamplesPerSec=0.9145504592917174, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:57:59,392] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=0, lr=[9.97633544926161e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:57:59,393] [INFO] [timer.py:260:stop] epoch=3/micro_step=212/global_step=2330, RunningAvgSamplesPerSec=0.9135576836824129, CurrSamplesPerSec=0.9118840656276311, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 18:59:27,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=0, lr=[9.976061299094253e-06], mom=[(0.9, 0.95)]
[2024-05-18 18:59:27,213] [INFO] [timer.py:260:stop] epoch=3/micro_step=222/global_step=2340, RunningAvgSamplesPerSec=0.913553387661894, CurrSamplesPerSec=0.9125725222549895, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:00:55,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=0, lr=[9.975785573875841e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:00:55,017] [INFO] [timer.py:260:stop] epoch=3/micro_step=232/global_step=2350, RunningAvgSamplesPerSec=0.9135496345845231, CurrSamplesPerSec=0.913310293190768, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:02:22,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=0, lr=[9.975508273693643e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:02:22,836] [INFO] [timer.py:260:stop] epoch=3/micro_step=242/global_step=2360, RunningAvgSamplesPerSec=0.9135451433723811, CurrSamplesPerSec=0.9143139906305413, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:03:50,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=0, lr=[9.975229398635438e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:03:50,651] [INFO] [timer.py:260:stop] epoch=3/micro_step=252/global_step=2370, RunningAvgSamplesPerSec=0.9135408940257446, CurrSamplesPerSec=0.9139273666707068, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:05:18,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=0, lr=[9.974948948789492e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:05:18,507] [INFO] [timer.py:260:stop] epoch=3/micro_step=262/global_step=2380, RunningAvgSamplesPerSec=0.9135352541128261, CurrSamplesPerSec=0.9138071752248316, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:06:46,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=0, lr=[9.974666924244578e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:06:46,213] [INFO] [timer.py:260:stop] epoch=3/micro_step=272/global_step=2390, RunningAvgSamplesPerSec=0.9135356660349391, CurrSamplesPerSec=0.9146778776006439, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 19:08:14,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=0, lr=[9.974383325089962e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:08:14,036] [INFO] [timer.py:260:stop] epoch=3/micro_step=282/global_step=2400, RunningAvgSamplesPerSec=0.9135314062697582, CurrSamplesPerSec=0.9102678788332238, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:09:41,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=0, lr=[9.974098151415413e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:09:41,849] [INFO] [timer.py:260:stop] epoch=3/micro_step=292/global_step=2410, RunningAvgSamplesPerSec=0.9135274672070604, CurrSamplesPerSec=0.9138293245127815, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:11:09,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=0, lr=[9.973811403311192e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:11:09,698] [INFO] [timer.py:260:stop] epoch=3/micro_step=302/global_step=2420, RunningAvgSamplesPerSec=0.9135222463426999, CurrSamplesPerSec=0.9115603593980258, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:12:37,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=0, lr=[9.973523080868063e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:12:37,535] [INFO] [timer.py:260:stop] epoch=3/micro_step=312/global_step=2430, RunningAvgSamplesPerSec=0.9135177559322761, CurrSamplesPerSec=0.9121365361162572, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:14:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=0, lr=[9.97323318417729e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:14:05,356] [INFO] [timer.py:260:stop] epoch=3/micro_step=322/global_step=2440, RunningAvgSamplesPerSec=0.9135138017556388, CurrSamplesPerSec=0.9130376445357887, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:15:33,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=0, lr=[9.972941713330632e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:15:33,174] [INFO] [timer.py:260:stop] epoch=3/micro_step=332/global_step=2450, RunningAvgSamplesPerSec=0.9135103276706784, CurrSamplesPerSec=0.911051025585776, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:17:00,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=0, lr=[9.972648668420346e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:17:00,977] [INFO] [timer.py:260:stop] epoch=3/micro_step=342/global_step=2460, RunningAvgSamplesPerSec=0.9135073533551645, CurrSamplesPerSec=0.9127504349545023, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:18:28,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=0, lr=[9.972354049539188e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:18:28,731] [INFO] [timer.py:260:stop] epoch=3/micro_step=352/global_step=2470, RunningAvgSamplesPerSec=0.9135058643324439, CurrSamplesPerSec=0.9104971694468935, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:19:56,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=0, lr=[9.972057856780412e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:19:56,510] [INFO] [timer.py:260:stop] epoch=3/micro_step=362/global_step=2480, RunningAvgSamplesPerSec=0.9135034266165114, CurrSamplesPerSec=0.9126519252548948, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:21:24,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=0, lr=[9.971760090237773e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:21:24,251] [INFO] [timer.py:260:stop] epoch=3/micro_step=372/global_step=2490, RunningAvgSamplesPerSec=0.9135025921174349, CurrSamplesPerSec=0.9133310510785124, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:22:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=0, lr=[9.97146075000552e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:22:52,077] [INFO] [timer.py:260:stop] epoch=3/micro_step=382/global_step=2500, RunningAvgSamplesPerSec=0.9134982595321974, CurrSamplesPerSec=0.9122000661645091, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:24:19,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=0, lr=[9.971159836178401e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:24:19,935] [INFO] [timer.py:260:stop] epoch=3/micro_step=392/global_step=2510, RunningAvgSamplesPerSec=0.9134929270781376, CurrSamplesPerSec=0.9116468187565454, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:25:47,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=0, lr=[9.970857348851667e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:25:47,767] [INFO] [timer.py:260:stop] epoch=3/micro_step=402/global_step=2520, RunningAvgSamplesPerSec=0.913488718806285, CurrSamplesPerSec=0.9135026443157149, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:27:15,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=0, lr=[9.970553288121056e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:27:15,670] [INFO] [timer.py:260:stop] epoch=3/micro_step=412/global_step=2530, RunningAvgSamplesPerSec=0.9134819648016571, CurrSamplesPerSec=0.9100929072632312, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:28:43,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=0, lr=[9.970247654082816e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:28:43,462] [INFO] [timer.py:260:stop] epoch=3/micro_step=422/global_step=2540, RunningAvgSamplesPerSec=0.9134790357664203, CurrSamplesPerSec=0.9104964282591833, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:30:11,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=0, lr=[9.969940446833688e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:30:11,295] [INFO] [timer.py:260:stop] epoch=3/micro_step=432/global_step=2550, RunningAvgSamplesPerSec=0.9134747405194362, CurrSamplesPerSec=0.9129146567739197, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:31:39,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=0, lr=[9.96963166647091e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:31:39,078] [INFO] [timer.py:260:stop] epoch=3/micro_step=442/global_step=2560, RunningAvgSamplesPerSec=0.9134724897582356, CurrSamplesPerSec=0.9145804471410571, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 19:33:06,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=0, lr=[9.969321313092219e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:33:06,906] [INFO] [timer.py:260:stop] epoch=3/micro_step=452/global_step=2570, RunningAvgSamplesPerSec=0.9134681335914079, CurrSamplesPerSec=0.9106496574170543, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:34:34,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=0, lr=[9.969009386795849e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:34:34,752] [INFO] [timer.py:260:stop] epoch=3/micro_step=462/global_step=2580, RunningAvgSamplesPerSec=0.9134635496788405, CurrSamplesPerSec=0.9131438415984432, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:36:02,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=0, lr=[9.968695887680535e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:36:02,552] [INFO] [timer.py:260:stop] epoch=3/micro_step=472/global_step=2590, RunningAvgSamplesPerSec=0.9134609427903424, CurrSamplesPerSec=0.9125073273090423, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:37:30,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=0, lr=[9.968380815845504e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:37:30,402] [INFO] [timer.py:260:stop] epoch=3/micro_step=482/global_step=2600, RunningAvgSamplesPerSec=0.9134567392725531, CurrSamplesPerSec=0.9082356784129202, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 19:38:58,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=0, lr=[9.968064171390488e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:38:58,255] [INFO] [timer.py:260:stop] epoch=3/micro_step=492/global_step=2610, RunningAvgSamplesPerSec=0.9134518866295278, CurrSamplesPerSec=0.9119922749372615, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:40:26,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=0, lr=[9.967745954415711e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:40:26,019] [INFO] [timer.py:260:stop] epoch=3/micro_step=502/global_step=2620, RunningAvgSamplesPerSec=0.9134501604035444, CurrSamplesPerSec=0.9143468531793241, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:41:53,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=0, lr=[9.967426165021896e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:41:53,790] [INFO] [timer.py:260:stop] epoch=3/micro_step=512/global_step=2630, RunningAvgSamplesPerSec=0.9134483437951079, CurrSamplesPerSec=0.9122896977598729, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:43:21,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=0, lr=[9.967104803310266e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:43:21,571] [INFO] [timer.py:260:stop] epoch=3/micro_step=522/global_step=2640, RunningAvgSamplesPerSec=0.9134464859262296, CurrSamplesPerSec=0.9137780094857509, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:44:49,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=0, lr=[9.96678186938254e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:44:49,297] [INFO] [timer.py:260:stop] epoch=3/micro_step=532/global_step=2650, RunningAvgSamplesPerSec=0.9134463969537775, CurrSamplesPerSec=0.9133162594331339, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:46:17,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=0, lr=[9.966457363340936e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:46:17,227] [INFO] [timer.py:260:stop] epoch=3/micro_step=542/global_step=2660, RunningAvgSamplesPerSec=0.9134395768909409, CurrSamplesPerSec=0.9118872624653811, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 19:47:44,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=0, lr=[9.966131285288168e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:47:44,917] [INFO] [timer.py:260:stop] epoch=3/micro_step=552/global_step=2670, RunningAvgSamplesPerSec=0.9134407766124768, CurrSamplesPerSec=0.9134098401997074, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:49:12,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=0, lr=[9.965803635327445e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:49:12,662] [INFO] [timer.py:260:stop] epoch=3/micro_step=562/global_step=2680, RunningAvgSamplesPerSec=0.9134401460833343, CurrSamplesPerSec=0.9137421023487995, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:50:40,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=0, lr=[9.96547441356248e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:50:40,427] [INFO] [timer.py:260:stop] epoch=3/micro_step=572/global_step=2690, RunningAvgSamplesPerSec=0.9134390564843943, CurrSamplesPerSec=0.9124865572179139, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:52:08,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=0, lr=[9.965143620097479e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:52:08,243] [INFO] [timer.py:260:stop] epoch=3/micro_step=582/global_step=2700, RunningAvgSamplesPerSec=0.9134358833669153, CurrSamplesPerSec=0.9129020642600886, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:53:36,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=0, lr=[9.964811255037148e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:53:36,057] [INFO] [timer.py:260:stop] epoch=3/micro_step=592/global_step=2710, RunningAvgSamplesPerSec=0.9134324833216925, CurrSamplesPerSec=0.9093874083310186, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 19:55:03,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=0, lr=[9.964477318486687e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:55:03,844] [INFO] [timer.py:260:stop] epoch=3/micro_step=602/global_step=2720, RunningAvgSamplesPerSec=0.9134306053848036, CurrSamplesPerSec=0.9117012388559924, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:56:31,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=0, lr=[9.964141810551796e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:56:31,654] [INFO] [timer.py:260:stop] epoch=3/micro_step=612/global_step=2730, RunningAvgSamplesPerSec=0.9134274707355471, CurrSamplesPerSec=0.9132508339015335, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:57:59,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=0, lr=[9.963804731338674e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:57:59,431] [INFO] [timer.py:260:stop] epoch=3/micro_step=622/global_step=2740, RunningAvgSamplesPerSec=0.9134260837744905, CurrSamplesPerSec=0.9133486525177751, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 19:59:27,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=0, lr=[9.96346608095401e-06], mom=[(0.9, 0.95)]
[2024-05-18 19:59:27,203] [INFO] [timer.py:260:stop] epoch=3/micro_step=632/global_step=2750, RunningAvgSamplesPerSec=0.9134245919139503, CurrSamplesPerSec=0.912981723350128, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:00:55,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=0, lr=[9.963125859505e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:00:55,039] [INFO] [timer.py:260:stop] epoch=3/micro_step=642/global_step=2760, RunningAvgSamplesPerSec=0.9134207136152006, CurrSamplesPerSec=0.9135466408507892, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:02:22,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=0, lr=[9.962784067099333e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:02:22,875] [INFO] [timer.py:260:stop] epoch=3/micro_step=652/global_step=2770, RunningAvgSamplesPerSec=0.9134170342732902, CurrSamplesPerSec=0.9125710579342985, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:03:50,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=0, lr=[9.962440703845193e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:03:50,683] [INFO] [timer.py:260:stop] epoch=3/micro_step=662/global_step=2780, RunningAvgSamplesPerSec=0.9134146263291518, CurrSamplesPerSec=0.9116636617890364, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:05:18,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=0, lr=[9.962095769851265e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:05:18,463] [INFO] [timer.py:260:stop] epoch=3/micro_step=672/global_step=2790, RunningAvgSamplesPerSec=0.9134129097841571, CurrSamplesPerSec=0.9139799930464979, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:06:46,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=0, lr=[9.961749265226728e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:06:46,233] [INFO] [timer.py:260:stop] epoch=3/micro_step=682/global_step=2800, RunningAvgSamplesPerSec=0.9134113101193895, CurrSamplesPerSec=0.9150260593906824, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:08:13,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=0, lr=[9.961401190081261e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:08:13,998] [INFO] [timer.py:260:stop] epoch=3/micro_step=692/global_step=2810, RunningAvgSamplesPerSec=0.9134103615596666, CurrSamplesPerSec=0.9142673791942301, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:09:41,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=0, lr=[9.961051544525037e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:09:41,757] [INFO] [timer.py:260:stop] epoch=3/micro_step=702/global_step=2820, RunningAvgSamplesPerSec=0.9134094058105839, CurrSamplesPerSec=0.9141227172017405, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 5/20
[2024-05-18 20:11:05,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=0, lr=[9.960700328668729e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:11:05,219] [INFO] [timer.py:260:stop] epoch=4/micro_step=6/global_step=2830, RunningAvgSamplesPerSec=0.9135666917679942, CurrSamplesPerSec=0.9115410934054624, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:12:32,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=0, lr=[9.960347542623506e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:12:32,989] [INFO] [timer.py:260:stop] epoch=4/micro_step=16/global_step=2840, RunningAvgSamplesPerSec=0.9135647243011258, CurrSamplesPerSec=0.9099237522240697, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 20:14:00,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=0, lr=[9.959993186501031e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:14:00,763] [INFO] [timer.py:260:stop] epoch=4/micro_step=26/global_step=2850, RunningAvgSamplesPerSec=0.9135624209099225, CurrSamplesPerSec=0.9115945350130357, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:15:28,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=0, lr=[9.959637260413471e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:15:28,591] [INFO] [timer.py:260:stop] epoch=4/micro_step=36/global_step=2860, RunningAvgSamplesPerSec=0.9135588937625645, CurrSamplesPerSec=0.913225456687818, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:16:56,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=0, lr=[9.959279764473483e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:16:56,367] [INFO] [timer.py:260:stop] epoch=4/micro_step=46/global_step=2870, RunningAvgSamplesPerSec=0.9135564859867092, CurrSamplesPerSec=0.9139035448972556, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 20:18:24,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=0, lr=[9.958920698794226e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:18:24,190] [INFO] [timer.py:260:stop] epoch=4/micro_step=56/global_step=2880, RunningAvgSamplesPerSec=0.9135528324427137, CurrSamplesPerSec=0.9135728318688785, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:19:52,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=0, lr=[9.958560063489352e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:19:52,005] [INFO] [timer.py:260:stop] epoch=4/micro_step=66/global_step=2890, RunningAvgSamplesPerSec=0.9135491818803921, CurrSamplesPerSec=0.9097571266599113, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 20:21:19,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=0, lr=[9.958197858673009e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:21:19,783] [INFO] [timer.py:260:stop] epoch=4/micro_step=76/global_step=2900, RunningAvgSamplesPerSec=0.9135473052817038, CurrSamplesPerSec=0.9129056656339, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 20:22:47,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=0, lr=[9.957834084459847e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:22:47,588] [INFO] [timer.py:260:stop] epoch=4/micro_step=86/global_step=2910, RunningAvgSamplesPerSec=0.9135444539546328, CurrSamplesPerSec=0.9138574730785368, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:24:15,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=0, lr=[9.95746874096501e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:24:15,377] [INFO] [timer.py:260:stop] epoch=4/micro_step=96/global_step=2920, RunningAvgSamplesPerSec=0.9135418170967033, CurrSamplesPerSec=0.9136461896360789, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:25:43,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=0, lr=[9.957101828304138e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:25:43,224] [INFO] [timer.py:260:stop] epoch=4/micro_step=106/global_step=2930, RunningAvgSamplesPerSec=0.9135376907470598, CurrSamplesPerSec=0.9099382861299546, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:27:11,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=0, lr=[9.95673334659337e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:27:11,044] [INFO] [timer.py:260:stop] epoch=4/micro_step=116/global_step=2940, RunningAvgSamplesPerSec=0.9135340897053642, CurrSamplesPerSec=0.913562857714376, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 20:28:38,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=0, lr=[9.956363295949336e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:28:38,935] [INFO] [timer.py:260:stop] epoch=4/micro_step=126/global_step=2950, RunningAvgSamplesPerSec=0.9135284326383168, CurrSamplesPerSec=0.9111557713075707, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:30:06,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=0, lr=[9.95599167648917e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:30:06,640] [INFO] [timer.py:260:stop] epoch=4/micro_step=136/global_step=2960, RunningAvgSamplesPerSec=0.9135289468582146, CurrSamplesPerSec=0.9141180602846479, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 20:31:34,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=0, lr=[9.955618488330495e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:31:34,380] [INFO] [timer.py:260:stop] epoch=4/micro_step=146/global_step=2970, RunningAvgSamplesPerSec=0.9135282256236652, CurrSamplesPerSec=0.9117681024832196, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:33:02,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=0, lr=[9.95524373159144e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:33:02,089] [INFO] [timer.py:260:stop] epoch=4/micro_step=156/global_step=2980, RunningAvgSamplesPerSec=0.9135281834492391, CurrSamplesPerSec=0.9129926288099858, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:34:29,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=0, lr=[9.954867406390621e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:34:29,892] [INFO] [timer.py:260:stop] epoch=4/micro_step=166/global_step=2990, RunningAvgSamplesPerSec=0.9135254486671961, CurrSamplesPerSec=0.909756953997024, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 20:35:57,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=0, lr=[9.954489512847156e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:35:57,692] [INFO] [timer.py:260:stop] epoch=4/micro_step=176/global_step=3000, RunningAvgSamplesPerSec=0.9135228177495627, CurrSamplesPerSec=0.9105422606356081, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
saving model ... to step 3000
[2024-05-18 20:37:26,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=0, lr=[9.954110051080658e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:37:26,044] [INFO] [timer.py:260:stop] epoch=4/micro_step=186/global_step=3010, RunningAvgSamplesPerSec=0.9135203602275498, CurrSamplesPerSec=0.9143044985523744, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 20:38:53,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=0, lr=[9.953729021211238e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:38:53,903] [INFO] [timer.py:260:stop] epoch=4/micro_step=196/global_step=3020, RunningAvgSamplesPerSec=0.9135158727729532, CurrSamplesPerSec=0.9129369863656246, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:40:21,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=0, lr=[9.9533464233595e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:40:21,753] [INFO] [timer.py:260:stop] epoch=4/micro_step=206/global_step=3030, RunningAvgSamplesPerSec=0.913511503993772, CurrSamplesPerSec=0.9129895981093517, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:41:49,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=0, lr=[9.952962257646545e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:41:49,656] [INFO] [timer.py:260:stop] epoch=4/micro_step=216/global_step=3040, RunningAvgSamplesPerSec=0.9135055971340361, CurrSamplesPerSec=0.9101594611178884, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 20:43:17,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=0, lr=[9.952576524193972e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:43:17,452] [INFO] [timer.py:260:stop] epoch=4/micro_step=226/global_step=3050, RunningAvgSamplesPerSec=0.913503095355816, CurrSamplesPerSec=0.9139454889768763, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 20:44:45,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=0, lr=[9.952189223123877e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:44:45,274] [INFO] [timer.py:260:stop] epoch=4/micro_step=236/global_step=3060, RunningAvgSamplesPerSec=0.9134995902544609, CurrSamplesPerSec=0.9112176800784537, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:46:13,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=0, lr=[9.951800354558849e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:46:13,058] [INFO] [timer.py:260:stop] epoch=4/micro_step=246/global_step=3070, RunningAvgSamplesPerSec=0.9134975800215629, CurrSamplesPerSec=0.9122826039702352, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:47:40,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=0, lr=[9.951409918621977e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:47:40,877] [INFO] [timer.py:260:stop] epoch=4/micro_step=256/global_step=3080, RunningAvgSamplesPerSec=0.9134942254501697, CurrSamplesPerSec=0.9125406557273794, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:49:08,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=0, lr=[9.951017915436843e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:49:08,682] [INFO] [timer.py:260:stop] epoch=4/micro_step=266/global_step=3090, RunningAvgSamplesPerSec=0.9134916492184839, CurrSamplesPerSec=0.9143144390800547, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:50:36,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=0, lr=[9.950624345127523e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:50:36,396] [INFO] [timer.py:260:stop] epoch=4/micro_step=276/global_step=3100, RunningAvgSamplesPerSec=0.9134918106116361, CurrSamplesPerSec=0.9134458952931274, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:52:04,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=0, lr=[9.950229207818596e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:52:04,218] [INFO] [timer.py:260:stop] epoch=4/micro_step=286/global_step=3110, RunningAvgSamplesPerSec=0.9134886384507908, CurrSamplesPerSec=0.9118983896180697, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:53:32,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=0, lr=[9.949832503635133e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:53:32,046] [INFO] [timer.py:260:stop] epoch=4/micro_step=296/global_step=3120, RunningAvgSamplesPerSec=0.9134852035004228, CurrSamplesPerSec=0.9127168181154847, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:54:59,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=0, lr=[9.9494342327027e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:54:59,904] [INFO] [timer.py:260:stop] epoch=4/micro_step=306/global_step=3130, RunningAvgSamplesPerSec=0.9134809369637419, CurrSamplesPerSec=0.9118362396459793, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:56:27,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=0, lr=[9.949034395147357e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:56:27,771] [INFO] [timer.py:260:stop] epoch=4/micro_step=316/global_step=3140, RunningAvgSamplesPerSec=0.9134766085757998, CurrSamplesPerSec=0.9104766389935512, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:57:55,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=0, lr=[9.948632991095668e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:57:55,639] [INFO] [timer.py:260:stop] epoch=4/micro_step=326/global_step=3150, RunningAvgSamplesPerSec=0.91347235973887, CurrSamplesPerSec=0.9098067576237565, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 20:59:23,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=0, lr=[9.948230020674685e-06], mom=[(0.9, 0.95)]
[2024-05-18 20:59:23,415] [INFO] [timer.py:260:stop] epoch=4/micro_step=336/global_step=3160, RunningAvgSamplesPerSec=0.9134713344012302, CurrSamplesPerSec=0.9123658265236237, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:00:51,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=0, lr=[9.94782548401196e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:00:51,208] [INFO] [timer.py:260:stop] epoch=4/micro_step=346/global_step=3170, RunningAvgSamplesPerSec=0.9134689340463998, CurrSamplesPerSec=0.9140430331825439, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 21:02:18,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=0, lr=[9.947419381235538e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:02:18,989] [INFO] [timer.py:260:stop] epoch=4/micro_step=356/global_step=3180, RunningAvgSamplesPerSec=0.9134670308820205, CurrSamplesPerSec=0.9141167653214816, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:03:46,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=0, lr=[9.947011712473959e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:03:46,797] [INFO] [timer.py:260:stop] epoch=4/micro_step=366/global_step=3190, RunningAvgSamplesPerSec=0.9134641974269357, CurrSamplesPerSec=0.914085164376843, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:05:14,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=0, lr=[9.946602477856262e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:05:14,578] [INFO] [timer.py:260:stop] epoch=4/micro_step=376/global_step=3200, RunningAvgSamplesPerSec=0.9134624592438825, CurrSamplesPerSec=0.9133045756149784, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:06:42,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=0, lr=[9.946191677511983e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:06:42,410] [INFO] [timer.py:260:stop] epoch=4/micro_step=386/global_step=3210, RunningAvgSamplesPerSec=0.913459287079409, CurrSamplesPerSec=0.9090602753062025, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:08:10,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=0, lr=[9.94577931157115e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:08:10,190] [INFO] [timer.py:260:stop] epoch=4/micro_step=396/global_step=3220, RunningAvgSamplesPerSec=0.9134574321255082, CurrSamplesPerSec=0.9130404519549192, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:09:38,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=0, lr=[9.945365380164284e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:09:38,045] [INFO] [timer.py:260:stop] epoch=4/micro_step=406/global_step=3230, RunningAvgSamplesPerSec=0.9134536666917752, CurrSamplesPerSec=0.912059206052816, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:11:05,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=0, lr=[9.944949883422409e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:11:05,888] [INFO] [timer.py:260:stop] epoch=4/micro_step=416/global_step=3240, RunningAvgSamplesPerSec=0.9134500779864744, CurrSamplesPerSec=0.9132087298734832, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 21:12:33,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=0, lr=[9.944532821477037e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:12:33,765] [INFO] [timer.py:260:stop] epoch=4/micro_step=426/global_step=3250, RunningAvgSamplesPerSec=0.9134454513700672, CurrSamplesPerSec=0.9111386501429579, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:14:01,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=0, lr=[9.944114194460181e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:14:01,615] [INFO] [timer.py:260:stop] epoch=4/micro_step=436/global_step=3260, RunningAvgSamplesPerSec=0.9134416278124065, CurrSamplesPerSec=0.9099037164291233, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:15:29,375] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=0, lr=[9.943694002504346e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:15:29,376] [INFO] [timer.py:260:stop] epoch=4/micro_step=446/global_step=3270, RunningAvgSamplesPerSec=0.9134405417086752, CurrSamplesPerSec=0.9112976147144995, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:16:57,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=0, lr=[9.943272245742534e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:16:57,184] [INFO] [timer.py:260:stop] epoch=4/micro_step=456/global_step=3280, RunningAvgSamplesPerSec=0.9134378472454829, CurrSamplesPerSec=0.9119167289478333, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:18:24,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=0, lr=[9.942848924308241e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:18:24,984] [INFO] [timer.py:260:stop] epoch=4/micro_step=466/global_step=3290, RunningAvgSamplesPerSec=0.9134357995271162, CurrSamplesPerSec=0.9125886052728416, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:19:52,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=0, lr=[9.942424038335462e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:19:52,823] [INFO] [timer.py:260:stop] epoch=4/micro_step=476/global_step=3300, RunningAvgSamplesPerSec=0.9134324708487724, CurrSamplesPerSec=0.9114936500373961, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:21:20,687] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=0, lr=[9.94199758795868e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:21:20,688] [INFO] [timer.py:260:stop] epoch=4/micro_step=486/global_step=3310, RunningAvgSamplesPerSec=0.9134286572568807, CurrSamplesPerSec=0.9116639837942497, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:22:48,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=0, lr=[9.941569573312882e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:22:48,521] [INFO] [timer.py:260:stop] epoch=4/micro_step=496/global_step=3320, RunningAvgSamplesPerSec=0.9134255331869481, CurrSamplesPerSec=0.913207188949644, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:24:16,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=0, lr=[9.941139994533542e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:24:16,322] [INFO] [timer.py:260:stop] epoch=4/micro_step=506/global_step=3330, RunningAvgSamplesPerSec=0.913422911852033, CurrSamplesPerSec=0.9143894110741995, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 21:25:44,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=0, lr=[9.940708851756633e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:25:44,128] [INFO] [timer.py:260:stop] epoch=4/micro_step=516/global_step=3340, RunningAvgSamplesPerSec=0.9134206269750176, CurrSamplesPerSec=0.9135843484328925, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:27:11,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=0, lr=[9.940276145118626e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:27:11,857] [INFO] [timer.py:260:stop] epoch=4/micro_step=526/global_step=3350, RunningAvgSamplesPerSec=0.9134204334963124, CurrSamplesPerSec=0.9131588264669503, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 21:28:39,674] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=0, lr=[9.939841874756481e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:28:39,674] [INFO] [timer.py:260:stop] epoch=4/micro_step=536/global_step=3360, RunningAvgSamplesPerSec=0.913418367030451, CurrSamplesPerSec=0.9117363416567987, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:30:07,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=0, lr=[9.939406040807655e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:30:07,539] [INFO] [timer.py:260:stop] epoch=4/micro_step=546/global_step=3370, RunningAvgSamplesPerSec=0.9134145477321176, CurrSamplesPerSec=0.9116831558992088, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:31:35,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=0, lr=[9.938968643410103e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:31:35,261] [INFO] [timer.py:260:stop] epoch=4/micro_step=556/global_step=3380, RunningAvgSamplesPerSec=0.9134145667800324, CurrSamplesPerSec=0.9135115477382727, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:33:03,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=0, lr=[9.938529682702271e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:33:03,047] [INFO] [timer.py:260:stop] epoch=4/micro_step=566/global_step=3390, RunningAvgSamplesPerSec=0.9134129799827513, CurrSamplesPerSec=0.9132102210950532, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:34:30,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=0, lr=[9.938089158823101e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:34:30,834] [INFO] [timer.py:260:stop] epoch=4/micro_step=576/global_step=3400, RunningAvgSamplesPerSec=0.9134114256097592, CurrSamplesPerSec=0.9108927899450284, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:35:58,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=0, lr=[9.937647071912033e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:35:58,666] [INFO] [timer.py:260:stop] epoch=4/micro_step=586/global_step=3410, RunningAvgSamplesPerSec=0.9134083919776658, CurrSamplesPerSec=0.9123669180678191, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:37:26,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=0, lr=[9.937203422108995e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:37:26,437] [INFO] [timer.py:260:stop] epoch=4/micro_step=596/global_step=3420, RunningAvgSamplesPerSec=0.9134071739992542, CurrSamplesPerSec=0.9130158317257897, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:38:54,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=0, lr=[9.936758209554416e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:38:54,263] [INFO] [timer.py:260:stop] epoch=4/micro_step=606/global_step=3430, RunningAvgSamplesPerSec=0.9134041588697437, CurrSamplesPerSec=0.9100344338124454, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:40:22,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=0, lr=[9.936311434389216e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:40:22,021] [INFO] [timer.py:260:stop] epoch=4/micro_step=616/global_step=3440, RunningAvgSamplesPerSec=0.9134033340596275, CurrSamplesPerSec=0.9136460154938254, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:41:49,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=0, lr=[9.935863096754811e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:41:49,764] [INFO] [timer.py:260:stop] epoch=4/micro_step=626/global_step=3450, RunningAvgSamplesPerSec=0.9134032505945605, CurrSamplesPerSec=0.9126779408712314, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:43:17,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=0, lr=[9.935413196793111e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:43:17,545] [INFO] [timer.py:260:stop] epoch=4/micro_step=636/global_step=3460, RunningAvgSamplesPerSec=0.913401867001672, CurrSamplesPerSec=0.9115210853703727, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:44:45,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=0, lr=[9.934961734646523e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:44:45,458] [INFO] [timer.py:260:stop] epoch=4/micro_step=646/global_step=3470, RunningAvgSamplesPerSec=0.9133967644822535, CurrSamplesPerSec=0.9082811605330957, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 21:46:13,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=0, lr=[9.934508710457944e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:46:13,300] [INFO] [timer.py:260:stop] epoch=4/micro_step=656/global_step=3480, RunningAvgSamplesPerSec=0.9133937423991793, CurrSamplesPerSec=0.9129042250809657, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:47:41,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=0, lr=[9.934054124370769e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:47:41,126] [INFO] [timer.py:260:stop] epoch=4/micro_step=666/global_step=3490, RunningAvgSamplesPerSec=0.9133910690954817, CurrSamplesPerSec=0.9132226729852784, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:49:08,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=0, lr=[9.933597976528883e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:49:08,910] [INFO] [timer.py:260:stop] epoch=4/micro_step=676/global_step=3500, RunningAvgSamplesPerSec=0.913389545677754, CurrSamplesPerSec=0.911282789863648, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:50:36,706] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=0, lr=[9.933140267076675e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:50:36,706] [INFO] [timer.py:260:stop] epoch=4/micro_step=686/global_step=3510, RunningAvgSamplesPerSec=0.9133877040548134, CurrSamplesPerSec=0.9127322855263152, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:52:04,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=0, lr=[9.932680996159016e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:52:04,600] [INFO] [timer.py:260:stop] epoch=4/micro_step=696/global_step=3520, RunningAvgSamplesPerSec=0.913383376698874, CurrSamplesPerSec=0.9142466783647538, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 21:53:28,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=0, lr=[9.93222016392128e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:53:28,086] [INFO] [timer.py:260:stop] epoch=4/micro_step=706/global_step=3530, RunningAvgSamplesPerSec=0.913508499824232, CurrSamplesPerSec=1.7883007284697445, MemAllocated=7.34GB, MaxMemAllocated=20.46GB
Beginning of Epoch 6/20
[2024-05-18 21:54:55,868] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=0, lr=[9.931757770509332e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:54:55,869] [INFO] [timer.py:260:stop] epoch=5/micro_step=10/global_step=3540, RunningAvgSamplesPerSec=0.9135069094459753, CurrSamplesPerSec=0.9126122592595947, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:56:23,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=0, lr=[9.931293816069528e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:56:23,653] [INFO] [timer.py:260:stop] epoch=5/micro_step=20/global_step=3550, RunningAvgSamplesPerSec=0.9135048800455154, CurrSamplesPerSec=0.9136408658886197, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:57:51,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=0, lr=[9.930828300748726e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:57:51,418] [INFO] [timer.py:260:stop] epoch=5/micro_step=30/global_step=3560, RunningAvgSamplesPerSec=0.9135034150309663, CurrSamplesPerSec=0.9107258340420722, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 21:59:19,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=0, lr=[9.930361224694272e-06], mom=[(0.9, 0.95)]
[2024-05-18 21:59:19,254] [INFO] [timer.py:260:stop] epoch=5/micro_step=40/global_step=3570, RunningAvgSamplesPerSec=0.9135003795309689, CurrSamplesPerSec=0.9109309711945476, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:00:47,002] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=0, lr=[9.929892588054007e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:00:47,003] [INFO] [timer.py:260:stop] epoch=5/micro_step=50/global_step=3580, RunningAvgSamplesPerSec=0.9134993494391587, CurrSamplesPerSec=0.9114439091373235, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:02:14,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=0, lr=[9.929422390976265e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:02:14,773] [INFO] [timer.py:260:stop] epoch=5/micro_step=60/global_step=3590, RunningAvgSamplesPerSec=0.9134980420876178, CurrSamplesPerSec=0.9131607648440734, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:03:42,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=0, lr=[9.928950633609878e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:03:42,575] [INFO] [timer.py:260:stop] epoch=5/micro_step=70/global_step=3600, RunningAvgSamplesPerSec=0.9134957173749858, CurrSamplesPerSec=0.9127743952913482, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:05:10,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=0, lr=[9.92847731610417e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:05:10,390] [INFO] [timer.py:260:stop] epoch=5/micro_step=80/global_step=3610, RunningAvgSamplesPerSec=0.913493251348382, CurrSamplesPerSec=0.9125055405973667, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:06:38,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=0, lr=[9.928002438608955e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:06:38,257] [INFO] [timer.py:260:stop] epoch=5/micro_step=90/global_step=3620, RunningAvgSamplesPerSec=0.9134893725824261, CurrSamplesPerSec=0.9108616587691865, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:08:06,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=0, lr=[9.927526001274546e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:08:06,116] [INFO] [timer.py:260:stop] epoch=5/micro_step=100/global_step=3630, RunningAvgSamplesPerSec=0.9134855333758253, CurrSamplesPerSec=0.9095880717493482, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:09:33,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=0, lr=[9.927048004251748e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:09:33,930] [INFO] [timer.py:260:stop] epoch=5/micro_step=110/global_step=3640, RunningAvgSamplesPerSec=0.9134829751884658, CurrSamplesPerSec=0.9135998701362031, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:11:01,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=0, lr=[9.926568447691858e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:11:01,716] [INFO] [timer.py:260:stop] epoch=5/micro_step=120/global_step=3650, RunningAvgSamplesPerSec=0.9134814213686784, CurrSamplesPerSec=0.9124843239310821, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:12:29,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=0, lr=[9.926087331746668e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:12:29,556] [INFO] [timer.py:260:stop] epoch=5/micro_step=130/global_step=3660, RunningAvgSamplesPerSec=0.9134782907419838, CurrSamplesPerSec=0.914440520666801, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:13:57,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=0, lr=[9.925604656568464e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:13:57,369] [INFO] [timer.py:260:stop] epoch=5/micro_step=140/global_step=3670, RunningAvgSamplesPerSec=0.913476032412942, CurrSamplesPerSec=0.9142392302811839, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 22:15:25,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=0, lr=[9.925120422310023e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:15:25,118] [INFO] [timer.py:260:stop] epoch=5/micro_step=150/global_step=3680, RunningAvgSamplesPerSec=0.9134750562650641, CurrSamplesPerSec=0.9130334210174083, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:16:52,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=0, lr=[9.924634629124624e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:16:52,901] [INFO] [timer.py:260:stop] epoch=5/micro_step=160/global_step=3690, RunningAvgSamplesPerSec=0.9134732571266222, CurrSamplesPerSec=0.9125646050516439, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:18:20,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=0, lr=[9.924147277166025e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:18:20,733] [INFO] [timer.py:260:stop] epoch=5/micro_step=170/global_step=3700, RunningAvgSamplesPerSec=0.9134702638100904, CurrSamplesPerSec=0.9146620948507155, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 22:19:48,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=0, lr=[9.923658366588492e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:19:48,627] [INFO] [timer.py:260:stop] epoch=5/micro_step=180/global_step=3710, RunningAvgSamplesPerSec=0.9134659057234342, CurrSamplesPerSec=0.9116649993506434, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:21:16,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=0, lr=[9.923167897546773e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:21:16,503] [INFO] [timer.py:260:stop] epoch=5/micro_step=190/global_step=3720, RunningAvgSamplesPerSec=0.9134618389309203, CurrSamplesPerSec=0.9118268732795447, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:22:44,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=0, lr=[9.922675870196116e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:22:44,335] [INFO] [timer.py:260:stop] epoch=5/micro_step=200/global_step=3730, RunningAvgSamplesPerSec=0.9134587825446355, CurrSamplesPerSec=0.9104649783059834, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:24:12,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=0, lr=[9.92218228469226e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:24:12,105] [INFO] [timer.py:260:stop] epoch=5/micro_step=210/global_step=3740, RunningAvgSamplesPerSec=0.9134574746901054, CurrSamplesPerSec=0.9132276190398948, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:25:39,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=0, lr=[9.921687141191439e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:25:39,973] [INFO] [timer.py:260:stop] epoch=5/micro_step=220/global_step=3750, RunningAvgSamplesPerSec=0.913453854938382, CurrSamplesPerSec=0.9146441685015967, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 22:27:07,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=0, lr=[9.921190439850374e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:27:07,792] [INFO] [timer.py:260:stop] epoch=5/micro_step=230/global_step=3760, RunningAvgSamplesPerSec=0.913451309208771, CurrSamplesPerSec=0.91150744178084, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:28:35,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=0, lr=[9.920692180826289e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:28:35,604] [INFO] [timer.py:260:stop] epoch=5/micro_step=240/global_step=3770, RunningAvgSamplesPerSec=0.9134489336633257, CurrSamplesPerSec=0.912742812603316, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:30:03,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=0, lr=[9.920192364276894e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:30:03,415] [INFO] [timer.py:260:stop] epoch=5/micro_step=250/global_step=3780, RunningAvgSamplesPerSec=0.9134465674806607, CurrSamplesPerSec=0.9152462448219725, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 22:31:31,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=0, lr=[9.919690990360394e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:31:31,264] [INFO] [timer.py:260:stop] epoch=5/micro_step=260/global_step=3790, RunningAvgSamplesPerSec=0.913443311173493, CurrSamplesPerSec=0.9119691983746099, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:32:59,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=0, lr=[9.919188059235483e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:32:59,047] [INFO] [timer.py:260:stop] epoch=5/micro_step=270/global_step=3800, RunningAvgSamplesPerSec=0.9134416134520805, CurrSamplesPerSec=0.9132803885754706, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:34:26,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=0, lr=[9.918683571061357e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:34:26,825] [INFO] [timer.py:260:stop] epoch=5/micro_step=280/global_step=3810, RunningAvgSamplesPerSec=0.9134403418619224, CurrSamplesPerSec=0.9137442173825985, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:35:54,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=0, lr=[9.918177525997697e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:35:54,676] [INFO] [timer.py:260:stop] epoch=5/micro_step=290/global_step=3820, RunningAvgSamplesPerSec=0.9134371948794637, CurrSamplesPerSec=0.9108855447713049, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:37:22,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=0, lr=[9.91766992420468e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:37:22,568] [INFO] [timer.py:260:stop] epoch=5/micro_step=300/global_step=3830, RunningAvgSamplesPerSec=0.9134328109392503, CurrSamplesPerSec=0.9111182639306787, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:38:50,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=0, lr=[9.917160765842972e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:38:50,424] [INFO] [timer.py:260:stop] epoch=5/micro_step=310/global_step=3840, RunningAvgSamplesPerSec=0.9134296508808654, CurrSamplesPerSec=0.9116538283547534, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:40:18,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=0, lr=[9.91665005107374e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:40:18,280] [INFO] [timer.py:260:stop] epoch=5/micro_step=320/global_step=3850, RunningAvgSamplesPerSec=0.9134264396897329, CurrSamplesPerSec=0.9108604224677713, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:41:46,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=0, lr=[9.916137780058634e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:41:46,083] [INFO] [timer.py:260:stop] epoch=5/micro_step=330/global_step=3860, RunningAvgSamplesPerSec=0.9134247412279519, CurrSamplesPerSec=0.9146408525780061, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:43:13,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=0, lr=[9.915623952959803e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:43:13,916] [INFO] [timer.py:260:stop] epoch=5/micro_step=340/global_step=3870, RunningAvgSamplesPerSec=0.9134223550561476, CurrSamplesPerSec=0.9126704686769348, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:44:41,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=0, lr=[9.915108569939884e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:44:41,699] [INFO] [timer.py:260:stop] epoch=5/micro_step=350/global_step=3880, RunningAvgSamplesPerSec=0.9134206713364409, CurrSamplesPerSec=0.9135726328811233, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:46:09,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=0, lr=[9.914591631162013e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:46:09,523] [INFO] [timer.py:260:stop] epoch=5/micro_step=360/global_step=3890, RunningAvgSamplesPerSec=0.9134181450708639, CurrSamplesPerSec=0.9137538968975141, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:47:37,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=0, lr=[9.914073136789812e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:47:37,274] [INFO] [timer.py:260:stop] epoch=5/micro_step=370/global_step=3900, RunningAvgSamplesPerSec=0.9134174665130986, CurrSamplesPerSec=0.9121631174797089, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:49:05,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=0, lr=[9.913553086987396e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:49:05,098] [INFO] [timer.py:260:stop] epoch=5/micro_step=380/global_step=3910, RunningAvgSamplesPerSec=0.9134148994867195, CurrSamplesPerSec=0.9118053660552228, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:50:32,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=0, lr=[9.913031481919378e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:50:32,944] [INFO] [timer.py:260:stop] epoch=5/micro_step=390/global_step=3920, RunningAvgSamplesPerSec=0.9134120689694126, CurrSamplesPerSec=0.9134840173254276, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:52:00,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=0, lr=[9.912508321750856e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:52:00,768] [INFO] [timer.py:260:stop] epoch=5/micro_step=400/global_step=3930, RunningAvgSamplesPerSec=0.9134097376015927, CurrSamplesPerSec=0.9132902322725134, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:53:28,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=0, lr=[9.911983606647426e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:53:28,570] [INFO] [timer.py:260:stop] epoch=5/micro_step=410/global_step=3940, RunningAvgSamplesPerSec=0.9134081105031955, CurrSamplesPerSec=0.9120979810149932, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 22:54:56,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=0, lr=[9.911457336775172e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:54:56,365] [INFO] [timer.py:260:stop] epoch=5/micro_step=420/global_step=3950, RunningAvgSamplesPerSec=0.9134062913523431, CurrSamplesPerSec=0.9114412353153751, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:56:24,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=0, lr=[9.910929512300673e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:56:24,201] [INFO] [timer.py:260:stop] epoch=5/micro_step=430/global_step=3960, RunningAvgSamplesPerSec=0.9134036541388988, CurrSamplesPerSec=0.9124948204742448, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:57:51,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=0, lr=[9.910400133390998e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:57:51,991] [INFO] [timer.py:260:stop] epoch=5/micro_step=440/global_step=3970, RunningAvgSamplesPerSec=0.9134022291952237, CurrSamplesPerSec=0.9126213687294806, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 22:59:19,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=0, lr=[9.909869200213711e-06], mom=[(0.9, 0.95)]
[2024-05-18 22:59:19,762] [INFO] [timer.py:260:stop] epoch=5/micro_step=450/global_step=3980, RunningAvgSamplesPerSec=0.9134010450290057, CurrSamplesPerSec=0.912978816927575, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:00:47,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=0, lr=[9.909336712936863e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:00:47,536] [INFO] [timer.py:260:stop] epoch=5/micro_step=460/global_step=3990, RunningAvgSamplesPerSec=0.9133999979081605, CurrSamplesPerSec=0.9134440551711581, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:02:15,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=0, lr=[9.908802671729004e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:02:15,449] [INFO] [timer.py:260:stop] epoch=5/micro_step=470/global_step=4000, RunningAvgSamplesPerSec=0.9133954655214195, CurrSamplesPerSec=0.9122480543272419, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
evaluating model ...
***** Evaluating perplexity, Epoch 6/20 *****
ppl: 1.216862678527832, loss: 0.19624635577201843
saving model ... to step 4000
[2024-05-18 23:09:56,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=0, lr=[9.908267076759167e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:09:56,321] [INFO] [timer.py:260:stop] epoch=5/micro_step=480/global_step=4010, RunningAvgSamplesPerSec=0.913393101351153, CurrSamplesPerSec=0.91312570137092, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:11:24,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=0, lr=[9.907729928196885e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:11:24,216] [INFO] [timer.py:260:stop] epoch=5/micro_step=490/global_step=4020, RunningAvgSamplesPerSec=0.9133890755312556, CurrSamplesPerSec=0.9118097021075022, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:12:51,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=0, lr=[9.907191226212179e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:12:51,996] [INFO] [timer.py:260:stop] epoch=5/micro_step=500/global_step=4030, RunningAvgSamplesPerSec=0.9133879133586482, CurrSamplesPerSec=0.9129574043676916, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:14:19,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=0, lr=[9.90665097097556e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:14:19,740] [INFO] [timer.py:260:stop] epoch=5/micro_step=510/global_step=4040, RunningAvgSamplesPerSec=0.9133872601356642, CurrSamplesPerSec=0.9135073198344132, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:15:47,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=0, lr=[9.906109162658034e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:15:47,592] [INFO] [timer.py:260:stop] epoch=5/micro_step=520/global_step=4050, RunningAvgSamplesPerSec=0.913384397284929, CurrSamplesPerSec=0.9114298469901907, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:17:15,363] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=0, lr=[9.905565801431097e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:17:15,364] [INFO] [timer.py:260:stop] epoch=5/micro_step=530/global_step=4060, RunningAvgSamplesPerSec=0.9133833469830012, CurrSamplesPerSec=0.9117279434930501, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:18:43,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=0, lr=[9.905020887466735e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:18:43,264] [INFO] [timer.py:260:stop] epoch=5/micro_step=540/global_step=4070, RunningAvgSamplesPerSec=0.9133795480959397, CurrSamplesPerSec=0.9114883513456857, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:20:11,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=0, lr=[9.904474420937431e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:20:11,074] [INFO] [timer.py:260:stop] epoch=5/micro_step=550/global_step=4080, RunningAvgSamplesPerSec=0.913377592323747, CurrSamplesPerSec=0.9104465243960114, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 23:21:38,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=0, lr=[9.903926402016153e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:21:38,878] [INFO] [timer.py:260:stop] epoch=5/micro_step=560/global_step=4090, RunningAvgSamplesPerSec=0.9133757303866435, CurrSamplesPerSec=0.9127974629595318, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:23:06,713] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=0, lr=[9.903376830876363e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:23:06,713] [INFO] [timer.py:260:stop] epoch=5/micro_step=570/global_step=4100, RunningAvgSamplesPerSec=0.9133735445134641, CurrSamplesPerSec=0.9123791981199912, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 23:24:34,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=0, lr=[9.902825707692017e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:24:34,539] [INFO] [timer.py:260:stop] epoch=5/micro_step=580/global_step=4110, RunningAvgSamplesPerSec=0.9133712691951024, CurrSamplesPerSec=0.91255728362222, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:26:02,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=0, lr=[9.902273032637558e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:26:02,379] [INFO] [timer.py:260:stop] epoch=5/micro_step=590/global_step=4120, RunningAvgSamplesPerSec=0.9133684440804204, CurrSamplesPerSec=0.9141704097522533, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 23:27:30,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=0, lr=[9.90171880588792e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:27:30,172] [INFO] [timer.py:260:stop] epoch=5/micro_step=600/global_step=4130, RunningAvgSamplesPerSec=0.9133671365467427, CurrSamplesPerSec=0.9120305236274537, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:28:57,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=0, lr=[9.901163027618532e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:28:57,983] [INFO] [timer.py:260:stop] epoch=5/micro_step=610/global_step=4140, RunningAvgSamplesPerSec=0.9133652051598838, CurrSamplesPerSec=0.9152718842675234, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 23:30:25,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=0, lr=[9.900605698005312e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:30:25,795] [INFO] [timer.py:260:stop] epoch=5/micro_step=620/global_step=4150, RunningAvgSamplesPerSec=0.9133633900339696, CurrSamplesPerSec=0.9101167529630898, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 23:31:53,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=0, lr=[9.90004681722467e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:31:53,646] [INFO] [timer.py:260:stop] epoch=5/micro_step=630/global_step=4160, RunningAvgSamplesPerSec=0.9133605390975107, CurrSamplesPerSec=0.9127124237781782, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:33:21,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=0, lr=[9.899486385453502e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:33:21,461] [INFO] [timer.py:260:stop] epoch=5/micro_step=640/global_step=4170, RunningAvgSamplesPerSec=0.9133586600278444, CurrSamplesPerSec=0.913324214544211, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:34:49,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=0, lr=[9.898924402869204e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:34:49,254] [INFO] [timer.py:260:stop] epoch=5/micro_step=650/global_step=4180, RunningAvgSamplesPerSec=0.9133573889095916, CurrSamplesPerSec=0.9136848508596285, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:36:17,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=0, lr=[9.898360869649654e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:36:17,139] [INFO] [timer.py:260:stop] epoch=5/micro_step=660/global_step=4190, RunningAvgSamplesPerSec=0.9133540333876712, CurrSamplesPerSec=0.9111305103929696, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:37:44,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=0, lr=[9.897795785973227e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:37:44,968] [INFO] [timer.py:260:stop] epoch=5/micro_step=670/global_step=4200, RunningAvgSamplesPerSec=0.9133517869968236, CurrSamplesPerSec=0.9141762128930261, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:39:12,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=0, lr=[9.897229152018789e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:39:12,709] [INFO] [timer.py:260:stop] epoch=5/micro_step=680/global_step=4210, RunningAvgSamplesPerSec=0.9133515503063863, CurrSamplesPerSec=0.9141279469512942, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:40:40,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=0, lr=[9.896660967965688e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:40:40,520] [INFO] [timer.py:260:stop] epoch=5/micro_step=690/global_step=4220, RunningAvgSamplesPerSec=0.9133499359103894, CurrSamplesPerSec=0.9121161052257567, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:42:08,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=0, lr=[9.896091233993772e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:42:08,323] [INFO] [timer.py:260:stop] epoch=5/micro_step=700/global_step=4230, RunningAvgSamplesPerSec=0.9133483528890123, CurrSamplesPerSec=0.9135843235587913, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 7/20
[2024-05-18 23:43:31,872] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=0, lr=[9.895519950283378e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:43:31,872] [INFO] [timer.py:260:stop] epoch=6/micro_step=4/global_step=4240, RunningAvgSamplesPerSec=0.9134512292138129, CurrSamplesPerSec=0.9115961943291373, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:44:59,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=0, lr=[9.89494711701533e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:44:59,692] [INFO] [timer.py:260:stop] epoch=6/micro_step=14/global_step=4250, RunningAvgSamplesPerSec=0.9134490056553547, CurrSamplesPerSec=0.9132646540155801, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:46:27,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=0, lr=[9.894372734370945e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:46:27,616] [INFO] [timer.py:260:stop] epoch=6/micro_step=24/global_step=4260, RunningAvgSamplesPerSec=0.9134441105513093, CurrSamplesPerSec=0.9115244034738538, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:47:55,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=0, lr=[9.893796802532027e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:47:55,447] [INFO] [timer.py:260:stop] epoch=6/micro_step=34/global_step=4270, RunningAvgSamplesPerSec=0.9134417082561727, CurrSamplesPerSec=0.9095161284158222, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-18 23:49:23,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=0, lr=[9.89321932168088e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:49:23,367] [INFO] [timer.py:260:stop] epoch=6/micro_step=44/global_step=4280, RunningAvgSamplesPerSec=0.913437050258547, CurrSamplesPerSec=0.9133890041400592, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:50:51,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=0, lr=[9.892640292000284e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:50:51,179] [INFO] [timer.py:260:stop] epoch=6/micro_step=54/global_step=4290, RunningAvgSamplesPerSec=0.9134349122968374, CurrSamplesPerSec=0.9119414882131436, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:52:19,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=0, lr=[9.892059713673521e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:52:19,044] [INFO] [timer.py:260:stop] epoch=6/micro_step=64/global_step=4300, RunningAvgSamplesPerSec=0.9134316183888549, CurrSamplesPerSec=0.9115561000082124, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:53:46,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=0, lr=[9.891477586884359e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:53:46,905] [INFO] [timer.py:260:stop] epoch=6/micro_step=74/global_step=4310, RunningAvgSamplesPerSec=0.9134284993450852, CurrSamplesPerSec=0.9112173831338153, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:55:14,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=0, lr=[9.890893911817056e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:55:14,854] [INFO] [timer.py:260:stop] epoch=6/micro_step=84/global_step=4320, RunningAvgSamplesPerSec=0.9134236192772043, CurrSamplesPerSec=0.9132600058370155, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-18 23:56:42,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=0, lr=[9.890308688656358e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:56:42,701] [INFO] [timer.py:260:stop] epoch=6/micro_step=94/global_step=4330, RunningAvgSamplesPerSec=0.9134206891017741, CurrSamplesPerSec=0.9106846545694685, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:58:10,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=0, lr=[9.889721917587504e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:58:10,577] [INFO] [timer.py:260:stop] epoch=6/micro_step=104/global_step=4340, RunningAvgSamplesPerSec=0.9134174465093207, CurrSamplesPerSec=0.9126570637180594, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-18 23:59:38,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=0, lr=[9.889133598796222e-06], mom=[(0.9, 0.95)]
[2024-05-18 23:59:38,327] [INFO] [timer.py:260:stop] epoch=6/micro_step=114/global_step=4350, RunningAvgSamplesPerSec=0.9134171485863646, CurrSamplesPerSec=0.9133416665546122, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:01:06,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=0, lr=[9.888543732468732e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:01:06,231] [INFO] [timer.py:260:stop] epoch=6/micro_step=124/global_step=4360, RunningAvgSamplesPerSec=0.9134132799545207, CurrSamplesPerSec=0.9091231312231656, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:02:34,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=0, lr=[9.887952318791739e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:02:34,053] [INFO] [timer.py:260:stop] epoch=6/micro_step=134/global_step=4370, RunningAvgSamplesPerSec=0.913411086448413, CurrSamplesPerSec=0.910923972707816, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:04:01,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=0, lr=[9.887359357952441e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:04:01,803] [INFO] [timer.py:260:stop] epoch=6/micro_step=144/global_step=4380, RunningAvgSamplesPerSec=0.9134106652871719, CurrSamplesPerSec=0.9116642562603772, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:05:29,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=0, lr=[9.886764850138529e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:05:29,613] [INFO] [timer.py:260:stop] epoch=6/micro_step=154/global_step=4390, RunningAvgSamplesPerSec=0.9134086606513435, CurrSamplesPerSec=0.9145041228331602, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:06:57,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=0, lr=[9.886168795538175e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:06:57,346] [INFO] [timer.py:260:stop] epoch=6/micro_step=164/global_step=4400, RunningAvgSamplesPerSec=0.9134085263522788, CurrSamplesPerSec=0.9122926246003333, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:08:25,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=0, lr=[9.88557119434005e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:08:25,188] [INFO] [timer.py:260:stop] epoch=6/micro_step=174/global_step=4410, RunningAvgSamplesPerSec=0.9134060857733269, CurrSamplesPerSec=0.9139360294416858, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 00:09:53,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=0, lr=[9.884972046733306e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:09:53,012] [INFO] [timer.py:260:stop] epoch=6/micro_step=184/global_step=4420, RunningAvgSamplesPerSec=0.9134042672652467, CurrSamplesPerSec=0.9123300054770636, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:11:20,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=0, lr=[9.88437135290759e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:11:20,772] [INFO] [timer.py:260:stop] epoch=6/micro_step=194/global_step=4430, RunningAvgSamplesPerSec=0.9134035879747721, CurrSamplesPerSec=0.9150958323776777, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 00:12:48,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=0, lr=[9.883769113053039e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:12:48,591] [INFO] [timer.py:260:stop] epoch=6/micro_step=204/global_step=4440, RunningAvgSamplesPerSec=0.9134015402497202, CurrSamplesPerSec=0.9123836636754677, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:14:16,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=0, lr=[9.883165327360275e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:14:16,407] [INFO] [timer.py:260:stop] epoch=6/micro_step=214/global_step=4450, RunningAvgSamplesPerSec=0.9133996210695736, CurrSamplesPerSec=0.9127120762052818, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:15:44,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=0, lr=[9.882559996020414e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:15:44,235] [INFO] [timer.py:260:stop] epoch=6/micro_step=224/global_step=4460, RunningAvgSamplesPerSec=0.9133975533705384, CurrSamplesPerSec=0.9123508180557868, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 00:17:12,005] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=0, lr=[9.881953119225055e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:17:12,006] [INFO] [timer.py:260:stop] epoch=6/micro_step=234/global_step=4470, RunningAvgSamplesPerSec=0.9133965682610934, CurrSamplesPerSec=0.9137072679066646, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:18:39,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=0, lr=[9.881344697166293e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:18:39,785] [INFO] [timer.py:260:stop] epoch=6/micro_step=244/global_step=4480, RunningAvgSamplesPerSec=0.9133955581089472, CurrSamplesPerSec=0.9126319180703498, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 00:20:07,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=0, lr=[9.88073473003671e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:20:07,596] [INFO] [timer.py:260:stop] epoch=6/micro_step=254/global_step=4490, RunningAvgSamplesPerSec=0.9133935833065162, CurrSamplesPerSec=0.913000677653607, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:21:35,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=0, lr=[9.880123218029374e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:21:35,440] [INFO] [timer.py:260:stop] epoch=6/micro_step=264/global_step=4500, RunningAvgSamplesPerSec=0.9133912082822253, CurrSamplesPerSec=0.9136158650072476, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:23:03,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=0, lr=[9.879510161337845e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:23:03,122] [INFO] [timer.py:260:stop] epoch=6/micro_step=274/global_step=4510, RunningAvgSamplesPerSec=0.9133922794556458, CurrSamplesPerSec=0.9135692003559918, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:24:30,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=0, lr=[9.878895560156172e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:24:30,862] [INFO] [timer.py:260:stop] epoch=6/micro_step=284/global_step=4520, RunningAvgSamplesPerSec=0.9133921546349089, CurrSamplesPerSec=0.9147132598675256, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 00:25:58,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=0, lr=[9.87827941467889e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:25:58,689] [INFO] [timer.py:260:stop] epoch=6/micro_step=294/global_step=4530, RunningAvgSamplesPerSec=0.9133899743543792, CurrSamplesPerSec=0.9138768868928907, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:27:26,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=0, lr=[9.877661725101028e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:27:26,494] [INFO] [timer.py:260:stop] epoch=6/micro_step=304/global_step=4540, RunningAvgSamplesPerSec=0.9133884453424993, CurrSamplesPerSec=0.9136907971167455, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:28:54,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=0, lr=[9.877042491618097e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:28:54,342] [INFO] [timer.py:260:stop] epoch=6/micro_step=314/global_step=4550, RunningAvgSamplesPerSec=0.9133860896186898, CurrSamplesPerSec=0.9141566618329469, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:30:22,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=0, lr=[9.876421714426104e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:30:22,176] [INFO] [timer.py:260:stop] epoch=6/micro_step=324/global_step=4560, RunningAvgSamplesPerSec=0.9133841379416957, CurrSamplesPerSec=0.913418070456527, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:31:49,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=0, lr=[9.875799393721538e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:31:49,992] [INFO] [timer.py:260:stop] epoch=6/micro_step=334/global_step=4570, RunningAvgSamplesPerSec=0.91338250048502, CurrSamplesPerSec=0.9138574979675144, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:33:17,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=0, lr=[9.87517552970138e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:33:17,827] [INFO] [timer.py:260:stop] epoch=6/micro_step=344/global_step=4580, RunningAvgSamplesPerSec=0.9133803467774418, CurrSamplesPerSec=0.912580116942778, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:34:45,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=0, lr=[9.8745501225631e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:34:45,567] [INFO] [timer.py:260:stop] epoch=6/micro_step=354/global_step=4590, RunningAvgSamplesPerSec=0.9133800746014028, CurrSamplesPerSec=0.9137307310996208, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:36:13,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=0, lr=[9.873923172504653e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:36:13,310] [INFO] [timer.py:260:stop] epoch=6/micro_step=364/global_step=4600, RunningAvgSamplesPerSec=0.9133797240728067, CurrSamplesPerSec=0.9144200611923748, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:37:41,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=0, lr=[9.87329467972449e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:37:41,127] [INFO] [timer.py:260:stop] epoch=6/micro_step=374/global_step=4610, RunningAvgSamplesPerSec=0.9133779161185571, CurrSamplesPerSec=0.9127966186970844, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:39:08,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=0, lr=[9.872664644421539e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:39:08,918] [INFO] [timer.py:260:stop] epoch=6/micro_step=384/global_step=4620, RunningAvgSamplesPerSec=0.9133766153944068, CurrSamplesPerSec=0.9121603898430996, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:40:36,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=0, lr=[9.872033066795226e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:40:36,715] [INFO] [timer.py:260:stop] epoch=6/micro_step=394/global_step=4630, RunningAvgSamplesPerSec=0.913375289098455, CurrSamplesPerSec=0.9140730126645727, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:42:04,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=0, lr=[9.87139994704546e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:42:04,556] [INFO] [timer.py:260:stop] epoch=6/micro_step=404/global_step=4640, RunningAvgSamplesPerSec=0.9133730259599099, CurrSamplesPerSec=0.9117485551916923, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 00:43:32,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=0, lr=[9.870765285372642e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:43:32,422] [INFO] [timer.py:260:stop] epoch=6/micro_step=414/global_step=4650, RunningAvgSamplesPerSec=0.9133702821735808, CurrSamplesPerSec=0.9135936016925306, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:45:00,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=0, lr=[9.870129081977654e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:45:00,217] [INFO] [timer.py:260:stop] epoch=6/micro_step=424/global_step=4660, RunningAvgSamplesPerSec=0.9133688980348375, CurrSamplesPerSec=0.9115178415761422, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 00:46:28,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=0, lr=[9.869491337061877e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:46:28,018] [INFO] [timer.py:260:stop] epoch=6/micro_step=434/global_step=4670, RunningAvgSamplesPerSec=0.9133675125125118, CurrSamplesPerSec=0.9131718982464081, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:47:55,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=0, lr=[9.868852050827167e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:47:55,796] [INFO] [timer.py:260:stop] epoch=6/micro_step=444/global_step=4680, RunningAvgSamplesPerSec=0.9133665709513517, CurrSamplesPerSec=0.9138653131735036, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:49:23,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=0, lr=[9.868211223475879e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:49:23,625] [INFO] [timer.py:260:stop] epoch=6/micro_step=454/global_step=4690, RunningAvgSamplesPerSec=0.9133643395373315, CurrSamplesPerSec=0.9111090607453793, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:50:51,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=0, lr=[9.86756885521085e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:50:51,413] [INFO] [timer.py:260:stop] epoch=6/micro_step=464/global_step=4700, RunningAvgSamplesPerSec=0.9133633035070928, CurrSamplesPerSec=0.9127994991283304, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:52:19,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=0, lr=[9.866924946235406e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:52:19,309] [INFO] [timer.py:260:stop] epoch=6/micro_step=474/global_step=4710, RunningAvgSamplesPerSec=0.9133599812278107, CurrSamplesPerSec=0.9115770754112897, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:53:47,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=0, lr=[9.866279496753361e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:53:47,187] [INFO] [timer.py:260:stop] epoch=6/micro_step=484/global_step=4720, RunningAvgSamplesPerSec=0.9133571593296881, CurrSamplesPerSec=0.9137185639276159, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:55:15,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=0, lr=[9.865632506969016e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:55:15,083] [INFO] [timer.py:260:stop] epoch=6/micro_step=494/global_step=4730, RunningAvgSamplesPerSec=0.9133537853785638, CurrSamplesPerSec=0.9101779527704721, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:56:42,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=0, lr=[9.86498397708716e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:56:42,879] [INFO] [timer.py:260:stop] epoch=6/micro_step=504/global_step=4740, RunningAvgSamplesPerSec=0.9133522375499283, CurrSamplesPerSec=0.912450106380893, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 00:58:10,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=0, lr=[9.864333907313068e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:58:10,659] [INFO] [timer.py:260:stop] epoch=6/micro_step=514/global_step=4750, RunningAvgSamplesPerSec=0.9133512783162178, CurrSamplesPerSec=0.9134072045596927, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 00:59:38,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=0, lr=[9.863682297852506e-06], mom=[(0.9, 0.95)]
[2024-05-19 00:59:38,415] [INFO] [timer.py:260:stop] epoch=6/micro_step=524/global_step=4760, RunningAvgSamplesPerSec=0.9133508526356556, CurrSamplesPerSec=0.9140415641388688, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:01:06,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=0, lr=[9.863029148911724e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:01:06,160] [INFO] [timer.py:260:stop] epoch=6/micro_step=534/global_step=4770, RunningAvgSamplesPerSec=0.913350768577494, CurrSamplesPerSec=0.9108257332183048, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:02:34,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=0, lr=[9.862374460697462e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:02:34,063] [INFO] [timer.py:260:stop] epoch=6/micro_step=544/global_step=4780, RunningAvgSamplesPerSec=0.9133475380651407, CurrSamplesPerSec=0.9146205087911088, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 01:04:01,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=0, lr=[9.861718233416942e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:04:01,875] [INFO] [timer.py:260:stop] epoch=6/micro_step=554/global_step=4790, RunningAvgSamplesPerSec=0.9133456830492711, CurrSamplesPerSec=0.9145617512435511, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:05:29,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=0, lr=[9.86106046727788e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:05:29,700] [INFO] [timer.py:260:stop] epoch=6/micro_step=564/global_step=4800, RunningAvgSamplesPerSec=0.913343760418281, CurrSamplesPerSec=0.9121075760956737, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:06:57,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=0, lr=[9.860401162488476e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:06:57,523] [INFO] [timer.py:260:stop] epoch=6/micro_step=574/global_step=4810, RunningAvgSamplesPerSec=0.9133420446026381, CurrSamplesPerSec=0.9137364788947945, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:08:25,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=0, lr=[9.859740319257413e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:08:25,352] [INFO] [timer.py:260:stop] epoch=6/micro_step=584/global_step=4820, RunningAvgSamplesPerSec=0.9133402235107864, CurrSamplesPerSec=0.9129937466964467, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:09:53,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=0, lr=[9.85907793779387e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:09:53,194] [INFO] [timer.py:260:stop] epoch=6/micro_step=594/global_step=4830, RunningAvgSamplesPerSec=0.9133379224264029, CurrSamplesPerSec=0.911266653846345, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:11:21,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=0, lr=[9.858414018307503e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:11:21,052] [INFO] [timer.py:260:stop] epoch=6/micro_step=604/global_step=4840, RunningAvgSamplesPerSec=0.9133353109984539, CurrSamplesPerSec=0.9108108742697341, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:12:48,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=0, lr=[9.857748561008463e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:12:48,854] [INFO] [timer.py:260:stop] epoch=6/micro_step=614/global_step=4850, RunningAvgSamplesPerSec=0.9133338849730046, CurrSamplesPerSec=0.9138011527951228, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:14:16,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=0, lr=[9.857081566107383e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:14:16,679] [INFO] [timer.py:260:stop] epoch=6/micro_step=624/global_step=4860, RunningAvgSamplesPerSec=0.9133322446359785, CurrSamplesPerSec=0.9128389827338433, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:15:44,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=0, lr=[9.856413033815385e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:15:44,461] [INFO] [timer.py:260:stop] epoch=6/micro_step=634/global_step=4870, RunningAvgSamplesPerSec=0.9133313521396311, CurrSamplesPerSec=0.9116789449026584, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 01:17:12,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=0, lr=[9.855742964344074e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:17:12,339] [INFO] [timer.py:260:stop] epoch=6/micro_step=644/global_step=4880, RunningAvgSamplesPerSec=0.9133284585855902, CurrSamplesPerSec=0.9115451793127058, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 01:18:40,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=0, lr=[9.855071357905546e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:18:40,222] [INFO] [timer.py:260:stop] epoch=6/micro_step=654/global_step=4890, RunningAvgSamplesPerSec=0.9133257822945837, CurrSamplesPerSec=0.9106224969330594, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 01:20:08,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=0, lr=[9.854398214712382e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:20:08,021] [INFO] [timer.py:260:stop] epoch=6/micro_step=664/global_step=4900, RunningAvgSamplesPerSec=0.9133247458609955, CurrSamplesPerSec=0.9138538393023665, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:21:35,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=0, lr=[9.853723534977649e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:21:35,847] [INFO] [timer.py:260:stop] epoch=6/micro_step=674/global_step=4910, RunningAvgSamplesPerSec=0.9133229497687252, CurrSamplesPerSec=0.9132969688642525, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:23:03,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=0, lr=[9.853047318914898e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:23:03,621] [INFO] [timer.py:260:stop] epoch=6/micro_step=684/global_step=4920, RunningAvgSamplesPerSec=0.9133222290087835, CurrSamplesPerSec=0.9125971434015594, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:24:31,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=0, lr=[9.852369566738174e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:24:31,493] [INFO] [timer.py:260:stop] epoch=6/micro_step=694/global_step=4930, RunningAvgSamplesPerSec=0.9133197894612591, CurrSamplesPerSec=0.9090854708153563, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 01:25:59,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=0, lr=[9.851690278661998e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:25:59,268] [INFO] [timer.py:260:stop] epoch=6/micro_step=704/global_step=4940, RunningAvgSamplesPerSec=0.913318848619903, CurrSamplesPerSec=0.9126061532862143, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 8/20
[2024-05-19 01:27:22,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=0, lr=[9.851009454901384e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:27:22,803] [INFO] [timer.py:260:stop] epoch=7/micro_step=8/global_step=4950, RunningAvgSamplesPerSec=0.913407440827369, CurrSamplesPerSec=0.9148077257263227, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:28:50,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=0, lr=[9.850327095671831e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:28:50,597] [INFO] [timer.py:260:stop] epoch=7/micro_step=18/global_step=4960, RunningAvgSamplesPerSec=0.9134060023211633, CurrSamplesPerSec=0.9140888497960558, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 01:30:18,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=0, lr=[9.849643201189321e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:30:18,409] [INFO] [timer.py:260:stop] epoch=7/micro_step=28/global_step=4970, RunningAvgSamplesPerSec=0.9134042105195577, CurrSamplesPerSec=0.9141980811841255, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:31:46,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=0, lr=[9.848957771670326e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:31:46,264] [INFO] [timer.py:260:stop] epoch=7/micro_step=38/global_step=4980, RunningAvgSamplesPerSec=0.9134018418902909, CurrSamplesPerSec=0.9109870866242976, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:33:14,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=0, lr=[9.848270807331801e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:33:14,076] [INFO] [timer.py:260:stop] epoch=7/micro_step=48/global_step=4990, RunningAvgSamplesPerSec=0.9134000178261773, CurrSamplesPerSec=0.9096984743809607, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:34:41,939] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=0, lr=[9.847582308391189e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:34:41,940] [INFO] [timer.py:260:stop] epoch=7/micro_step=58/global_step=5000, RunningAvgSamplesPerSec=0.9133974334849501, CurrSamplesPerSec=0.9130800806419419, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
saving model ... to step 5000
[2024-05-19 01:36:10,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=0, lr=[9.846892275066418e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:36:10,267] [INFO] [timer.py:260:stop] epoch=7/micro_step=68/global_step=5010, RunningAvgSamplesPerSec=0.9133968450214586, CurrSamplesPerSec=0.9139014042344352, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:37:38,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=0, lr=[9.846200707575897e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:37:38,086] [INFO] [timer.py:260:stop] epoch=7/micro_step=78/global_step=5020, RunningAvgSamplesPerSec=0.9133952811578842, CurrSamplesPerSec=0.9131946877758869, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:39:05,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=0, lr=[9.845507606138529e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:39:05,908] [INFO] [timer.py:260:stop] epoch=7/micro_step=88/global_step=5030, RunningAvgSamplesPerSec=0.9133936013675873, CurrSamplesPerSec=0.9123736162371155, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:40:33,696] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=0, lr=[9.844812970973699e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:40:33,696] [INFO] [timer.py:260:stop] epoch=7/micro_step=98/global_step=5040, RunningAvgSamplesPerSec=0.9133923611002909, CurrSamplesPerSec=0.9121105265615811, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:42:01,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=0, lr=[9.844116802301273e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:42:01,627] [INFO] [timer.py:260:stop] epoch=7/micro_step=108/global_step=5050, RunningAvgSamplesPerSec=0.9133885265233755, CurrSamplesPerSec=0.9110796464348352, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:43:29,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=0, lr=[9.843419100341608e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:43:29,434] [INFO] [timer.py:260:stop] epoch=7/micro_step=118/global_step=5060, RunningAvgSamplesPerSec=0.9133871490775948, CurrSamplesPerSec=0.9123137579379506, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:44:57,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=0, lr=[9.842719865315549e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:44:57,309] [INFO] [timer.py:260:stop] epoch=7/micro_step=128/global_step=5070, RunningAvgSamplesPerSec=0.913384426788149, CurrSamplesPerSec=0.9117907724450995, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:46:25,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=0, lr=[9.842019097444414e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:46:25,142] [INFO] [timer.py:260:stop] epoch=7/micro_step=138/global_step=5080, RunningAvgSamplesPerSec=0.913382662741952, CurrSamplesPerSec=0.9108807476889828, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 01:47:52,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=0, lr=[9.841316796950019e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:47:52,886] [INFO] [timer.py:260:stop] epoch=7/micro_step=148/global_step=5090, RunningAvgSamplesPerSec=0.9133822025570284, CurrSamplesPerSec=0.9142373620518346, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:49:20,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=0, lr=[9.840612964054658e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:49:20,625] [INFO] [timer.py:260:stop] epoch=7/micro_step=158/global_step=5100, RunningAvgSamplesPerSec=0.9133819214334082, CurrSamplesPerSec=0.9114085317811539, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:50:48,506] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=0, lr=[9.839907598981115e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:50:48,507] [INFO] [timer.py:260:stop] epoch=7/micro_step=168/global_step=5110, RunningAvgSamplesPerSec=0.9133790670490706, CurrSamplesPerSec=0.9110219613088627, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:52:16,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=0, lr=[9.839200701952653e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:52:16,322] [INFO] [timer.py:260:stop] epoch=7/micro_step=178/global_step=5120, RunningAvgSamplesPerSec=0.9133776236643564, CurrSamplesPerSec=0.9137463075432661, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:53:44,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=0, lr=[9.838492273193025e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:53:44,166] [INFO] [timer.py:260:stop] epoch=7/micro_step=188/global_step=5130, RunningAvgSamplesPerSec=0.9133756497013937, CurrSamplesPerSec=0.9135031417090461, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:55:11,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=0, lr=[9.837782312926465e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:55:11,965] [INFO] [timer.py:260:stop] epoch=7/micro_step=198/global_step=5140, RunningAvgSamplesPerSec=0.9133742167920389, CurrSamplesPerSec=0.9130810745090306, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:56:39,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=0, lr=[9.837070821377697e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:56:39,838] [INFO] [timer.py:260:stop] epoch=7/micro_step=208/global_step=5150, RunningAvgSamplesPerSec=0.91337149033277, CurrSamplesPerSec=0.9113087522319363, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 01:58:07,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=0, lr=[9.836357798771922e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:58:07,691] [INFO] [timer.py:260:stop] epoch=7/micro_step=218/global_step=5160, RunningAvgSamplesPerSec=0.9133692933226165, CurrSamplesPerSec=0.915372283885825, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 01:59:35,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=0, lr=[9.835643245334833e-06], mom=[(0.9, 0.95)]
[2024-05-19 01:59:35,487] [INFO] [timer.py:260:stop] epoch=7/micro_step=228/global_step=5170, RunningAvgSamplesPerSec=0.9133680723623239, CurrSamplesPerSec=0.9132680593956815, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:01:03,317] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=0, lr=[9.834927161292604e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:01:03,317] [INFO] [timer.py:260:stop] epoch=7/micro_step=238/global_step=5180, RunningAvgSamplesPerSec=0.913366160314585, CurrSamplesPerSec=0.9151431023851779, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 02:02:31,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=0, lr=[9.834209546871892e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:02:31,206] [INFO] [timer.py:260:stop] epoch=7/micro_step=248/global_step=5190, RunningAvgSamplesPerSec=0.9133631677904832, CurrSamplesPerSec=0.9117734044279542, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:03:59,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=0, lr=[9.833490402299844e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:03:59,059] [INFO] [timer.py:260:stop] epoch=7/micro_step=258/global_step=5200, RunningAvgSamplesPerSec=0.913360788417183, CurrSamplesPerSec=0.9125190900022303, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:05:26,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=0, lr=[9.832769727804083e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:05:26,889] [INFO] [timer.py:260:stop] epoch=7/micro_step=268/global_step=5210, RunningAvgSamplesPerSec=0.9133589500158823, CurrSamplesPerSec=0.9133516110183726, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:06:54,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=0, lr=[9.832047523612726e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:06:54,657] [INFO] [timer.py:260:stop] epoch=7/micro_step=278/global_step=5220, RunningAvgSamplesPerSec=0.9133583883049855, CurrSamplesPerSec=0.9119596805621996, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:08:22,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=0, lr=[9.831323789954366e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:08:22,437] [INFO] [timer.py:260:stop] epoch=7/micro_step=288/global_step=5230, RunningAvgSamplesPerSec=0.9133576402402954, CurrSamplesPerSec=0.912955591053183, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:09:50,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=0, lr=[9.830598527058083e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:09:50,298] [INFO] [timer.py:260:stop] epoch=7/micro_step=298/global_step=5240, RunningAvgSamplesPerSec=0.913355128183842, CurrSamplesPerSec=0.9135441287807836, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:11:18,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=0, lr=[9.829871735153442e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:11:18,214] [INFO] [timer.py:260:stop] epoch=7/micro_step=308/global_step=5250, RunningAvgSamplesPerSec=0.9133518774071578, CurrSamplesPerSec=0.9105688479992398, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:12:46,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=0, lr=[9.829143414470495e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:12:46,055] [INFO] [timer.py:260:stop] epoch=7/micro_step=318/global_step=5260, RunningAvgSamplesPerSec=0.9133500591438755, CurrSamplesPerSec=0.911812848868409, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:14:13,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=0, lr=[9.828413565239768e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:14:13,850] [INFO] [timer.py:260:stop] epoch=7/micro_step=328/global_step=5270, RunningAvgSamplesPerSec=0.913349187375162, CurrSamplesPerSec=0.9140857371089596, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:15:41,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=0, lr=[9.82768218769228e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:15:41,667] [INFO] [timer.py:260:stop] epoch=7/micro_step=338/global_step=5280, RunningAvgSamplesPerSec=0.9133477648658214, CurrSamplesPerSec=0.9122068858798587, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:17:09,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=0, lr=[9.82694928205953e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:17:09,454] [INFO] [timer.py:260:stop] epoch=7/micro_step=348/global_step=5290, RunningAvgSamplesPerSec=0.9133467983823873, CurrSamplesPerSec=0.9132974411751505, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:18:37,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=0, lr=[9.826214848573503e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:18:37,263] [INFO] [timer.py:260:stop] epoch=7/micro_step=358/global_step=5300, RunningAvgSamplesPerSec=0.913345343231135, CurrSamplesPerSec=0.9132921960657466, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:20:05,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=0, lr=[9.825478887466666e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:20:05,053] [INFO] [timer.py:260:stop] epoch=7/micro_step=368/global_step=5310, RunningAvgSamplesPerSec=0.9133442947815157, CurrSamplesPerSec=0.9139987647528653, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:21:32,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=0, lr=[9.824741398971966e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:21:32,913] [INFO] [timer.py:260:stop] epoch=7/micro_step=378/global_step=5320, RunningAvgSamplesPerSec=0.9133419152383647, CurrSamplesPerSec=0.9131410832434101, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:23:00,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=0, lr=[9.82400238332284e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:23:00,772] [INFO] [timer.py:260:stop] epoch=7/micro_step=388/global_step=5330, RunningAvgSamplesPerSec=0.9133397687927233, CurrSamplesPerSec=0.9108632659660434, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:24:28,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=0, lr=[9.823261840753209e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:24:28,545] [INFO] [timer.py:260:stop] epoch=7/micro_step=398/global_step=5340, RunningAvgSamplesPerSec=0.9133390070340889, CurrSamplesPerSec=0.9117687961921086, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:25:56,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=0, lr=[9.822519771497466e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:25:56,384] [INFO] [timer.py:260:stop] epoch=7/micro_step=408/global_step=5350, RunningAvgSamplesPerSec=0.9133373171749299, CurrSamplesPerSec=0.9114189045632235, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:27:24,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=0, lr=[9.821776175790501e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:27:24,188] [INFO] [timer.py:260:stop] epoch=7/micro_step=418/global_step=5360, RunningAvgSamplesPerSec=0.9133360609458069, CurrSamplesPerSec=0.9106923167343516, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:28:52,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=0, lr=[9.821031053867676e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:28:52,047] [INFO] [timer.py:260:stop] epoch=7/micro_step=428/global_step=5370, RunningAvgSamplesPerSec=0.9133338643268178, CurrSamplesPerSec=0.9122374642571808, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:30:19,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=0, lr=[9.820284405964846e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:30:19,810] [INFO] [timer.py:260:stop] epoch=7/micro_step=438/global_step=5380, RunningAvgSamplesPerSec=0.9133335252778335, CurrSamplesPerSec=0.9130873856155348, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:31:47,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=0, lr=[9.819536232318342e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:31:47,608] [INFO] [timer.py:260:stop] epoch=7/micro_step=448/global_step=5390, RunningAvgSamplesPerSec=0.913332338528829, CurrSamplesPerSec=0.9117488772568783, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:33:15,443] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=0, lr=[9.81878653316498e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:33:15,444] [INFO] [timer.py:260:stop] epoch=7/micro_step=458/global_step=5400, RunningAvgSamplesPerSec=0.9133305132569993, CurrSamplesPerSec=0.9095692835300007, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:34:43,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=0, lr=[9.81803530874206e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:34:43,326] [INFO] [timer.py:260:stop] epoch=7/micro_step=468/global_step=5410, RunningAvgSamplesPerSec=0.9133279420286529, CurrSamplesPerSec=0.911863472582175, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:36:11,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=0, lr=[9.817282559287362e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:36:11,134] [INFO] [timer.py:260:stop] epoch=7/micro_step=478/global_step=5420, RunningAvgSamplesPerSec=0.9133268009349529, CurrSamplesPerSec=0.9100450715214508, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:37:38,979] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=0, lr=[9.816528285039153e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:37:38,980] [INFO] [timer.py:260:stop] epoch=7/micro_step=488/global_step=5430, RunningAvgSamplesPerSec=0.9133249773666612, CurrSamplesPerSec=0.910956913519853, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:39:06,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=0, lr=[9.815772486236179e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:39:06,819] [INFO] [timer.py:260:stop] epoch=7/micro_step=498/global_step=5440, RunningAvgSamplesPerSec=0.9133230346083826, CurrSamplesPerSec=0.9137418535219374, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:40:34,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=0, lr=[9.815015163117667e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:40:34,590] [INFO] [timer.py:260:stop] epoch=7/micro_step=508/global_step=5450, RunningAvgSamplesPerSec=0.9133222887563318, CurrSamplesPerSec=0.9123501978817891, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 02:42:02,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=0, lr=[9.814256315923335e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:42:02,435] [INFO] [timer.py:260:stop] epoch=7/micro_step=518/global_step=5460, RunningAvgSamplesPerSec=0.9133203905113598, CurrSamplesPerSec=0.9116140509339387, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:43:30,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=0, lr=[9.813495944893372e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:43:30,173] [INFO] [timer.py:260:stop] epoch=7/micro_step=528/global_step=5470, RunningAvgSamplesPerSec=0.913320321407122, CurrSamplesPerSec=0.9137437943750554, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:44:58,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=0, lr=[9.81273405026846e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:44:58,037] [INFO] [timer.py:260:stop] epoch=7/micro_step=538/global_step=5480, RunningAvgSamplesPerSec=0.9133182550277249, CurrSamplesPerSec=0.9089381104385947, MemAllocated=7.92GB, MaxMemAllocated=20.46GB
[2024-05-19 02:46:25,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=0, lr=[9.811970632289753e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:46:25,877] [INFO] [timer.py:260:stop] epoch=7/micro_step=548/global_step=5490, RunningAvgSamplesPerSec=0.9133164060353874, CurrSamplesPerSec=0.9142518348013924, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:47:53,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=0, lr=[9.811205691198897e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:47:53,639] [INFO] [timer.py:260:stop] epoch=7/micro_step=558/global_step=5500, RunningAvgSamplesPerSec=0.9133159294954353, CurrSamplesPerSec=0.9120507027774731, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 02:49:21,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=0, lr=[9.810439227238011e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:49:21,455] [INFO] [timer.py:260:stop] epoch=7/micro_step=568/global_step=5510, RunningAvgSamplesPerSec=0.9133147093002619, CurrSamplesPerSec=0.9112109246358102, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:50:49,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=0, lr=[9.809671240649705e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:50:49,257] [INFO] [timer.py:260:stop] epoch=7/micro_step=578/global_step=5520, RunningAvgSamplesPerSec=0.9133136221841929, CurrSamplesPerSec=0.9112743258078534, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:52:17,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=0, lr=[9.808901731677065e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:52:17,047] [INFO] [timer.py:260:stop] epoch=7/micro_step=588/global_step=5530, RunningAvgSamplesPerSec=0.9133126147194752, CurrSamplesPerSec=0.9133616054226316, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:53:44,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=0, lr=[9.808130700563658e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:53:44,828] [INFO] [timer.py:260:stop] epoch=7/micro_step=598/global_step=5540, RunningAvgSamplesPerSec=0.9133118412991007, CurrSamplesPerSec=0.913486628539967, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 02:55:12,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=0, lr=[9.807358147553536e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:55:12,632] [INFO] [timer.py:260:stop] epoch=7/micro_step=608/global_step=5550, RunningAvgSamplesPerSec=0.9133107510515834, CurrSamplesPerSec=0.9125442294327597, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:56:40,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=0, lr=[9.806584072891234e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:56:40,364] [INFO] [timer.py:260:stop] epoch=7/micro_step=618/global_step=5560, RunningAvgSamplesPerSec=0.9133108069638599, CurrSamplesPerSec=0.9134661868594433, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 02:58:08,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=0, lr=[9.805808476821765e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:58:08,168] [INFO] [timer.py:260:stop] epoch=7/micro_step=628/global_step=5570, RunningAvgSamplesPerSec=0.9133098092272423, CurrSamplesPerSec=0.9109004308845076, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 02:59:36,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=0, lr=[9.805031359590626e-06], mom=[(0.9, 0.95)]
[2024-05-19 02:59:36,005] [INFO] [timer.py:260:stop] epoch=7/micro_step=638/global_step=5580, RunningAvgSamplesPerSec=0.9133081396812904, CurrSamplesPerSec=0.9097393920571398, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 03:01:03,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=0, lr=[9.804252721443793e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:01:03,817] [INFO] [timer.py:260:stop] epoch=7/micro_step=648/global_step=5590, RunningAvgSamplesPerSec=0.9133069504217031, CurrSamplesPerSec=0.9149331949762596, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 03:02:31,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=0, lr=[9.803472562627726e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:02:31,677] [INFO] [timer.py:260:stop] epoch=7/micro_step=658/global_step=5600, RunningAvgSamplesPerSec=0.9133050017018852, CurrSamplesPerSec=0.9123119719842209, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:03:59,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=0, lr=[9.802690883389363e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:03:59,503] [INFO] [timer.py:260:stop] epoch=7/micro_step=668/global_step=5610, RunningAvgSamplesPerSec=0.9133035616065027, CurrSamplesPerSec=0.9120528099883637, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 03:05:27,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=0, lr=[9.801907683976128e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:05:27,264] [INFO] [timer.py:260:stop] epoch=7/micro_step=678/global_step=5620, RunningAvgSamplesPerSec=0.9133030280888106, CurrSamplesPerSec=0.9097446211031844, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 03:06:55,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=0, lr=[9.801122964635925e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:06:55,039] [INFO] [timer.py:260:stop] epoch=7/micro_step=688/global_step=5630, RunningAvgSamplesPerSec=0.9133025487249576, CurrSamplesPerSec=0.9131886237115026, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:08:22,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=0, lr=[9.800336725617136e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:08:22,934] [INFO] [timer.py:260:stop] epoch=7/micro_step=698/global_step=5640, RunningAvgSamplesPerSec=0.9132999120566636, CurrSamplesPerSec=0.9127777970162719, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
Beginning of Epoch 9/20
[2024-05-19 03:09:46,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=0, lr=[9.799548967168624e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:09:46,422] [INFO] [timer.py:260:stop] epoch=8/micro_step=2/global_step=5650, RunningAvgSamplesPerSec=0.9133783397923038, CurrSamplesPerSec=0.9132180749423578, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:11:14,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=0, lr=[9.798759689539739e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:11:14,231] [INFO] [timer.py:260:stop] epoch=8/micro_step=12/global_step=5660, RunningAvgSamplesPerSec=0.9133769622825013, CurrSamplesPerSec=0.9136500705378112, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:12:42,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=0, lr=[9.797968892980303e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:12:42,052] [INFO] [timer.py:260:stop] epoch=8/micro_step=22/global_step=5670, RunningAvgSamplesPerSec=0.913375408408886, CurrSamplesPerSec=0.9128657292297835, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:14:09,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=0, lr=[9.797176577740625e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:14:09,910] [INFO] [timer.py:260:stop] epoch=8/micro_step=32/global_step=5680, RunningAvgSamplesPerSec=0.9133731826277849, CurrSamplesPerSec=0.9105307218076003, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:15:37,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=0, lr=[9.796382744071496e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:15:37,760] [INFO] [timer.py:260:stop] epoch=8/micro_step=42/global_step=5690, RunningAvgSamplesPerSec=0.9133711642174234, CurrSamplesPerSec=0.9103888453108537, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:17:05,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=0, lr=[9.795587392224182e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:17:05,542] [INFO] [timer.py:260:stop] epoch=8/micro_step=52/global_step=5700, RunningAvgSamplesPerSec=0.913370165810439, CurrSamplesPerSec=0.9131020953047634, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:18:33,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=0, lr=[9.794790522450431e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:18:33,380] [INFO] [timer.py:260:stop] epoch=8/micro_step=62/global_step=5710, RunningAvgSamplesPerSec=0.9133683827172855, CurrSamplesPerSec=0.9125962002283283, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:20:01,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=0, lr=[9.793992135002476e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:20:01,176] [INFO] [timer.py:260:stop] epoch=8/micro_step=72/global_step=5720, RunningAvgSamplesPerSec=0.9133672902714614, CurrSamplesPerSec=0.911622967114971, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:21:29,163] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=0, lr=[9.793192230133025e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:21:29,163] [INFO] [timer.py:260:stop] epoch=8/micro_step=82/global_step=5730, RunningAvgSamplesPerSec=0.9133629981901188, CurrSamplesPerSec=0.9068167151459008, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
[2024-05-19 03:22:56,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=0, lr=[9.792390808095268e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:22:56,982] [INFO] [timer.py:260:stop] epoch=8/micro_step=92/global_step=5740, RunningAvgSamplesPerSec=0.9133615309537024, CurrSamplesPerSec=0.9127281889700039, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:24:24,881] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=0, lr=[9.791587869142878e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:24:24,882] [INFO] [timer.py:260:stop] epoch=8/micro_step=102/global_step=5750, RunningAvgSamplesPerSec=0.9133587006164192, CurrSamplesPerSec=0.9112438367113564, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:25:52,674] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=0, lr=[9.790783413530006e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:25:52,675] [INFO] [timer.py:260:stop] epoch=8/micro_step=112/global_step=5760, RunningAvgSamplesPerSec=0.9133576691431368, CurrSamplesPerSec=0.9144997361928165, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:27:20,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=0, lr=[9.789977441511278e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:27:20,486] [INFO] [timer.py:260:stop] epoch=8/micro_step=122/global_step=5770, RunningAvgSamplesPerSec=0.9133564423508107, CurrSamplesPerSec=0.9119514765656166, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:28:48,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=0, lr=[9.789169953341809e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:28:48,278] [INFO] [timer.py:260:stop] epoch=8/micro_step=132/global_step=5780, RunningAvgSamplesPerSec=0.9133555458966345, CurrSamplesPerSec=0.9135113736473411, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:30:16,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=0, lr=[9.788360949277188e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:30:16,027] [INFO] [timer.py:260:stop] epoch=8/micro_step=142/global_step=5790, RunningAvgSamplesPerSec=0.913355449659929, CurrSamplesPerSec=0.9150396587982832, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:31:43,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=0, lr=[9.787550429573487e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:31:43,785] [INFO] [timer.py:260:stop] epoch=8/micro_step=152/global_step=5800, RunningAvgSamplesPerSec=0.9133549037632884, CurrSamplesPerSec=0.9138626251257893, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:33:11,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=0, lr=[9.786738394487257e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:33:11,513] [INFO] [timer.py:260:stop] epoch=8/micro_step=162/global_step=5810, RunningAvgSamplesPerSec=0.9133549667287673, CurrSamplesPerSec=0.9120052637632907, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:34:39,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=0, lr=[9.785924844275523e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:34:39,327] [INFO] [timer.py:260:stop] epoch=8/micro_step=172/global_step=5820, RunningAvgSamplesPerSec=0.9133537336202459, CurrSamplesPerSec=0.91186523199978, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:36:07,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=0, lr=[9.7851097791958e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:36:07,085] [INFO] [timer.py:260:stop] epoch=8/micro_step=182/global_step=5830, RunningAvgSamplesPerSec=0.9133535398906127, CurrSamplesPerSec=0.9131535083976167, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:37:34,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=0, lr=[9.784293199506076e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:37:34,865] [INFO] [timer.py:260:stop] epoch=8/micro_step=192/global_step=5840, RunningAvgSamplesPerSec=0.913352843802878, CurrSamplesPerSec=0.9125956541815593, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:39:02,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=0, lr=[9.783475105464816e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:39:02,613] [INFO] [timer.py:260:stop] epoch=8/micro_step=202/global_step=5850, RunningAvgSamplesPerSec=0.9133526464547468, CurrSamplesPerSec=0.9145013811780138, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:40:30,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=0, lr=[9.782655497330972e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:40:30,388] [INFO] [timer.py:260:stop] epoch=8/micro_step=212/global_step=5860, RunningAvgSamplesPerSec=0.9133519802009975, CurrSamplesPerSec=0.914058794575354, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:41:58,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=0, lr=[9.781834375363968e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:41:58,197] [INFO] [timer.py:260:stop] epoch=8/micro_step=222/global_step=5870, RunningAvgSamplesPerSec=0.9133508043275358, CurrSamplesPerSec=0.91286498418082, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:43:26,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=0, lr=[9.781011739823715e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:43:26,010] [INFO] [timer.py:260:stop] epoch=8/micro_step=232/global_step=5880, RunningAvgSamplesPerSec=0.913349477436405, CurrSamplesPerSec=0.9128192653365822, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:44:53,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=0, lr=[9.780187590970589e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:44:53,864] [INFO] [timer.py:260:stop] epoch=8/micro_step=242/global_step=5890, RunningAvgSamplesPerSec=0.9133473626597042, CurrSamplesPerSec=0.912185013553741, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:46:21,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=0, lr=[9.779361929065462e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:46:21,710] [INFO] [timer.py:260:stop] epoch=8/micro_step=252/global_step=5900, RunningAvgSamplesPerSec=0.9133454143805786, CurrSamplesPerSec=0.9131131030342645, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:47:49,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=0, lr=[9.778534754369677e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:47:49,562] [INFO] [timer.py:260:stop] epoch=8/micro_step=262/global_step=5910, RunningAvgSamplesPerSec=0.91334351879557, CurrSamplesPerSec=0.9127721605953437, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:49:17,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=0, lr=[9.777706067145052e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:49:17,270] [INFO] [timer.py:260:stop] epoch=8/micro_step=272/global_step=5920, RunningAvgSamplesPerSec=0.9133439525396356, CurrSamplesPerSec=0.9128669213106548, MemAllocated=7.89GB, MaxMemAllocated=20.46GB
[2024-05-19 03:50:45,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=0, lr=[9.77687586765389e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:50:45,056] [INFO] [timer.py:260:stop] epoch=8/micro_step=282/global_step=5930, RunningAvgSamplesPerSec=0.913343182790356, CurrSamplesPerSec=0.9116440942068282, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:52:12,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=0, lr=[9.77604415615897e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:52:12,865] [INFO] [timer.py:260:stop] epoch=8/micro_step=292/global_step=5940, RunningAvgSamplesPerSec=0.9133419570519703, CurrSamplesPerSec=0.9139960759200246, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:53:40,670] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=0, lr=[9.775210932923552e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:53:40,671] [INFO] [timer.py:260:stop] epoch=8/micro_step=302/global_step=5950, RunningAvgSamplesPerSec=0.9133408677090843, CurrSamplesPerSec=0.9139081000619795, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
--- Logging error ---
Traceback (most recent call last):
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/logging/__init__.py", line 1114, in emit
    self.flush()
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/logging/__init__.py", line 1094, in flush
    self.stream.flush()
OSError: [Errno 28] No space left on device
Call stack:
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/service/streams.py", line 49, in run
    self._target(**self._kwargs)
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/internal/internal.py", line 174, in wandb_internal
    logger.error(f"Thread {thread.name}:", exc_info=exc_info)
Message: 'Thread SenderThread:'
Arguments: ()
Thread SenderThread:
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/internal/internal_util.py", line 49, in run
    self._run()
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/internal/internal_util.py", line 100, in _run
    self._process(record)
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/internal/internal.py", line 328, in _process
    self._sm.send(record)
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/wandb/sdk/internal/sender.py", line 386, in se[2024-05-19 03:55:08,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=0, lr=[9.77437619821137e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:55:08,494] [INFO] [timer.py:260:stop] epoch=8/micro_step=312/global_step=5960, RunningAvgSamplesPerSec=0.9133395692234199, CurrSamplesPerSec=0.912652446545622, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:56:36,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=0, lr=[9.773539952286639e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:56:36,272] [INFO] [timer.py:260:stop] epoch=8/micro_step=322/global_step=5970, RunningAvgSamplesPerSec=0.9133389854814292, CurrSamplesPerSec=0.9132630880463937, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:58:04,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=0, lr=[9.772702195414053e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:58:04,094] [INFO] [timer.py:260:stop] epoch=8/micro_step=332/global_step=5980, RunningAvgSamplesPerSec=0.9133377487190962, CurrSamplesPerSec=0.9130421165390168, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 03:59:31,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=0, lr=[9.771862927858784e-06], mom=[(0.9, 0.95)]
[2024-05-19 03:59:31,846] [INFO] [timer.py:260:stop] epoch=8/micro_step=342/global_step=5990, RunningAvgSamplesPerSec=0.913337695563878, CurrSamplesPerSec=0.912442513856893, MemAllocated=7.9GB, MaxMemAllocated=20.46GB
[2024-05-19 04:00:59,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=0, lr=[9.771022149886482e-06], mom=[(0.9, 0.95)]
[2024-05-19 04:00:59,571] [INFO] [timer.py:260:stop] epoch=8/micro_step=352/global_step=6000, RunningAvgSamplesPerSec=0.9133377841814958, CurrSamplesPerSec=0.9126744654168042, MemAllocated=7.91GB, MaxMemAllocated=20.46GB
evaluating model ...
***** Evaluating perplexity, Epoch 9/20 *****
ppl: 1.2152347564697266, loss: 0.19490811228752136
saving model ... to step 6000
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 370, in <module>
    main()
  File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 370, in <module>
    main()
  File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 338, in main
    save_PEFT_model(model,os.path.join(args.output_dir, f'peft_checkpoint-{total_steps}'))
  File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 338, in main
    save_PEFT_model(model,os.path.join(args.output_dir, f'peft_checkpoint-{total_steps}'))
  File "/home/chanho/Model/SHARE/Refactorizing/training/utils/utils.py", line 186, in save_PEFT_model
    model.save_pretrained(save_dir)
  File "/home/chanho/Model/SHARE/Refactorizing/training/utils/utils.py", line 186, in save_PEFT_model
    model.save_pretrained(save_dir)
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/peft/peft_model.py", line 250, in save_pretrained
    safe_save_file(
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/peft/peft_model.py", line 250, in save_pretrained
    safe_save_file(
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/safetensors/torch.py", line 281, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
  File "/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/safetensors/torch.py", line 281, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
safetensors_rust.SafetensorError: Error while serializing: IoError(Os { code: 28, kind: StorageFull, message: "No space left on device" })
safetensors_rust.SafetensorError: Error while serializing: IoError(Os { code: 28, kind: StorageFull, message: "No space left on device" })
[rank1]: Traceback (most recent call last):
[rank1]:   File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 370, in <module>
[rank1]:     main()
[rank1]:   File "/home/chanho/Model/SHARE/Refactorizing/training/EPISODE/main.py", line 338, in main
[rank1]:     save_PEFT_model(model,os.path.join([2024-05-19 19:12:47,912] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 4072852
[2024-05-19 19:12:47,913] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 4072853
[2024-05-19 19:12:48,344] [ERROR] [launch.py:325:sigkill_handler] ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'quan_llama', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/val_data.json', '--per_device_train_batch_size', '4', '--per_device_eval_batch_size', '4', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '20', '--num_train_samples', '5644', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_data.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '600', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '2000', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-18-13.10.44'] exits with return code = -15
