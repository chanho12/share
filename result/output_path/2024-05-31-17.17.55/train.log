[2024-05-31 17:17:57,297] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-31 17:17:57,868] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-31 17:17:57,868] [INFO] [runner.py:568:main] cmd = /home/chanho/anaconda3/envs/COMEDY/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=12341 --enable_each_rank_log=None training/EPISODE/main.py --model_name gemma --model_name_or_path /home/chanho/Model/SHARE/Refactorizing/result/output_path --train_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json --valid_data_path /home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json --per_device_train_batch_size 1 --per_device_eval_batch_size 1 --data_output_path /home/chanho/Model/SHARE/Refactorizing/result/output_path/data --max_seq_len 2048 --learning_rate 1e-5 --weight_decay 0.1 --num_train_epochs 50 --num_train_samples 14255 /home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json --gradient_accumulation_steps 1 --lr_scheduler_type cosine --num_warmup_steps 1000 --seed 42 --zero_stage 2 --save_interval 1000 --eval_interval 100 --output_dir /home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55
[2024-05-31 17:17:59,326] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[2024-05-31 17:17:59,908] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-05-31 17:17:59,908] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-05-31 17:17:59,908] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-05-31 17:17:59,908] [INFO] [launch.py:164:main] dist_world_size=2
[2024-05-31 17:17:59,908] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-05-31 17:17:59,908] [INFO] [launch.py:256:main] process 1475670 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=0', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55']
[2024-05-31 17:17:59,908] [INFO] [launch.py:256:main] process 1475671 spawned with command: ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55']
[2024-05-31 17:18:02,501] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-31 17:18:02,503] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55', seed=42, local_rank=1, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', num_train_samples=14255, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json']
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Namespace(data_path=['Dahoas/rm-static'], data_split='6,2,2', data_output_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', model_name_or_path='/home/chanho/Model/SHARE/Refactorizing/result/output_path', model_name='gemma', per_device_train_batch_size=1, per_device_eval_batch_size=1, max_seq_len=2048, learning_rate=1e-05, weight_decay=0.1, num_train_epochs=50, gradient_accumulation_steps=1, lr_scheduler_type=<SchedulerType.COSINE: 'cosine'>, num_warmup_steps=1000, output_dir='/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55', seed=42, local_rank=0, gradient_checkpointing=False, offload=False, zero_stage=2, lora_dim=0, lora_module_name='decoder.layers.', only_optimize_lora=False, save_interval=1000, log_interval=10, eval_interval=100, train_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', valid_data_path='/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', num_train_samples=14255, deepspeed=False, deepspeed_config=None, deepscale=False, deepscale_config=None)
['/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json']
[2024-05-31 17:18:02,921] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-31 17:18:02,921] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-05-31 17:18:03,132] [INFO] [comm.py:637:init_distributed] cdb=None
This model is gemma
This model is gemma
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.20s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.19s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.22s/it]
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
trainable params: 1,843,200 || all params: 2,508,015,616 || trainable%: 0.073492365368111
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Using /home/chanho/.cache/torch_extensions/py311_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/chanho/.cache/torch_extensions/py311_cu121/fused_adam/build.ninja...
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.08524680137634277 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.10218477249145508 seconds
[2024-05-31 17:18:08,776] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.2, git-hash=unknown, git-branch=unknown
[2024-05-31 17:18:08,776] [INFO] [comm.py:662:init_distributed] Distributed backend already initialized
[2024-05-31 17:18:12,529] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-05-31 17:18:12,530] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-05-31 17:18:12,530] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-31 17:18:12,532] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-31 17:18:12,532] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-05-31 17:18:12,532] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-05-31 17:18:12,532] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 500,000,000
[2024-05-31 17:18:12,532] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 500,000,000
[2024-05-31 17:18:12,532] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-05-31 17:18:12,532] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-05-31 17:18:13,055] [INFO] [utils.py:779:see_memory_usage] Before initializing optimizer states
[2024-05-31 17:18:13,055] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 17:18:13,055] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.77 GB, percent = 18.1%
[2024-05-31 17:18:13,160] [INFO] [utils.py:779:see_memory_usage] After initializing optimizer states
[2024-05-31 17:18:13,160] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 17:18:13,160] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.78 GB, percent = 18.1%
[2024-05-31 17:18:13,160] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-05-31 17:18:13,261] [INFO] [utils.py:779:see_memory_usage] After initializing ZeRO optimizer
[2024-05-31 17:18:13,262] [INFO] [utils.py:780:see_memory_usage] MA 4.68 GB         Max_MA 4.68 GB         CA 4.74 GB         Max_CA 5 GB 
[2024-05-31 17:18:13,262] [INFO] [utils.py:787:see_memory_usage] CPU Virtual Memory:  used = 22.8 GB, percent = 18.2%
[2024-05-31 17:18:13,262] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[2024-05-31 17:18:13,262] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-05-31 17:18:13,262] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f094df0f010>
[2024-05-31 17:18:13,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.95)]
[2024-05-31 17:18:13,263] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-31 17:18:13,263] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-31 17:18:13,263] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-31 17:18:13,263] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-31 17:18:13,263] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0968167110>
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   gradient_clipping ............ 1.0
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-31 17:18:13,264] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   steps_per_print .............. 10
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   train_batch_size ............. 2
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   world_size ................... 2
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=DeepSpeedZeroOffloadParamConfig(device='none', nvme_path=None, buffer_count=5, buffer_size=100,000,000, max_in_cpu=1,000,000,000, pin_memory=False) offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='none', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False, ratio=1.0) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=30000000 param_persistence_threshold=10000 model_persistence_threshold=sys.maxsize max_live_parameters=30000000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=False pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-31 17:18:13,265] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-05-31 17:18:13,265] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 2, 
    "train_micro_batch_size_per_gpu": 1, 
    "steps_per_print": 10, 
    "zero_optimization": {
        "stage": 2, 
        "offload_param": {
            "device": "none"
        }, 
        "offload_optimizer": {
            "device": "none"
        }, 
        "stage3_param_persistence_threshold": 1.000000e+04, 
        "stage3_max_live_parameters": 3.000000e+07, 
        "stage3_prefetch_bucket_size": 3.000000e+07, 
        "memory_efficient_linear": false
    }, 
    "bf16": {
        "enabled": true
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": false, 
    "wall_clock_breakdown": false, 
    "hybrid_engine": {
        "enabled": false, 
        "inference_tp_size": 1, 
        "release_inference_cache": false, 
        "pin_parameters": true, 
        "tp_gather_partition_size": 8
    }
}
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: cksgh0984 (organization-chanho). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240531_171814-pp5c43ka
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run upbeat-puddle-292
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/pp5c43ka
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/chanho/Model/SHARE/Refactorizing/wandb/run-20240531_171814-egdjruyj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-moon-293
wandb: ⭐️ View project at https://wandb.ai/organization-chanho/Shared%20Memory
wandb: 🚀 View run at https://wandb.ai/organization-chanho/Shared%20Memory/runs/egdjruyj
***** Running training *****
***** Evaluating perplexity, Epoch 0/50 *****
Beginning of Epoch 1/50
[2024-05-31 17:18:24,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[1.0000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:24,071] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=3.3832076628455248, CurrSamplesPerSec=3.3806602207183825, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:30,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[2.0000000000000002e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:30,009] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=3.38080456842148, CurrSamplesPerSec=3.3658841727037268, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:35,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[3.0000000000000004e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:35,967] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=3.3761134546259473, CurrSamplesPerSec=3.363935117811403, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:41,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[4.0000000000000003e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:41,942] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=3.371715632016263, CurrSamplesPerSec=3.353541071504243, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:47,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[5.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:47,929] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=3.367667749739862, CurrSamplesPerSec=3.3526993508512635, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:53,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[6.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:53,926] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=3.363963609428203, CurrSamplesPerSec=3.3453736253875834, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:18:59,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[7.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:18:59,924] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=3.3611025651856847, CurrSamplesPerSec=3.3403780947924857, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:19:05,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[8.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:19:05,947] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=3.357360907333033, CurrSamplesPerSec=3.3282170532178568, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:19:11,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[9.000000000000001e-07], mom=[(0.9, 0.95)]
[2024-05-31 17:19:11,974] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=3.3541016812948157, CurrSamplesPerSec=3.3162242060495752, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:19:18,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[1.0000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:19:18,022] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=3.3504884429886563, CurrSamplesPerSec=3.308649630012657, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 1267336.25, loss: 14.052138328552246
[2024-05-31 17:22:02,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[1.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:02,631] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=3.344995231283798, CurrSamplesPerSec=3.2865608288992663, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:08,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[1.2000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:08,731] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=3.3402517351087253, CurrSamplesPerSec=3.2869961078486036, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:14,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[1.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:14,828] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=3.336330778908216, CurrSamplesPerSec=3.290313420038392, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:20,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[1.4000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:20,919] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=3.333243748328253, CurrSamplesPerSec=3.288061611017736, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:27,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[1.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:27,009] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=3.3306496728022985, CurrSamplesPerSec=3.2952404746247947, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:33,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[1.6000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:33,114] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=3.3279404179476657, CurrSamplesPerSec=3.2876595504525885, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:39,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.7000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:39,209] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=3.325827976767609, CurrSamplesPerSec=3.296689597984716, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:45,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.8000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:45,308] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=3.32385558455, CurrSamplesPerSec=3.2979662442944364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:51,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[1.9000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:51,409] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=3.322057875447733, CurrSamplesPerSec=3.2826510690735087, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:22:57,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[2.0000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:22:57,503] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=3.320612331261088, CurrSamplesPerSec=3.2893302925833097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 834647.75, loss: 13.634538650512695
[2024-05-31 17:25:42,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[2.1000000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:25:42,515] [INFO] [timer.py:260:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=3.3191613830914015, CurrSamplesPerSec=3.280641939271068, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:25:48,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[2.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:25:48,602] [INFO] [timer.py:260:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=3.3181574061750947, CurrSamplesPerSec=3.29687487718184, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:25:54,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[2.3000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:25:54,699] [INFO] [timer.py:260:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=3.3170159082241404, CurrSamplesPerSec=3.296942256598909, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:00,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[2.4000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:00,793] [INFO] [timer.py:260:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=3.316025598141737, CurrSamplesPerSec=3.297573424459476, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:06,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[2.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:06,895] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=3.3150136411739948, CurrSamplesPerSec=3.298234660172378, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:12,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[2.6e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:12,992] [INFO] [timer.py:260:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=3.3141184956404044, CurrSamplesPerSec=3.3023376478179105, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:19,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[2.7000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:19,091] [INFO] [timer.py:260:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=3.313284669157579, CurrSamplesPerSec=3.283760032005336, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:25,179] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[2.8000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:25,180] [INFO] [timer.py:260:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=3.3126807150409276, CurrSamplesPerSec=3.291242899505094, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:31,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[2.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:31,276] [INFO] [timer.py:260:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=3.312006628665839, CurrSamplesPerSec=3.2855966717140346, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:26:37,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:26:37,369] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=3.311399168624347, CurrSamplesPerSec=3.28834775245883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 349548.0, loss: 12.764284133911133
[2024-05-31 17:29:22,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[3.1000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:22,249] [INFO] [timer.py:260:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=3.3107526612281095, CurrSamplesPerSec=3.2903147106180266, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:28,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[3.2000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:28,334] [INFO] [timer.py:260:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=3.310321169836933, CurrSamplesPerSec=3.2922594730961285, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:34,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[3.3000000000000006e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:34,425] [INFO] [timer.py:260:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=3.3098558012409294, CurrSamplesPerSec=3.2958360279332113, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:40,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[3.4000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:40,517] [INFO] [timer.py:260:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=3.3093871560742563, CurrSamplesPerSec=3.299402193856902, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:46,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[3.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:46,609] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=3.3089356342389844, CurrSamplesPerSec=3.2932572814066545, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:52,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[3.6000000000000003e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:52,694] [INFO] [timer.py:260:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=3.308606153555635, CurrSamplesPerSec=3.279273545787858, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:29:58,786] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[3.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:29:58,786] [INFO] [timer.py:260:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=3.3082074808864292, CurrSamplesPerSec=3.2846317939336607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:30:04,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=0, lr=[3.8000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:30:04,878] [INFO] [timer.py:260:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=3.3078536693193827, CurrSamplesPerSec=3.288190497394882, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:30:10,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=0, lr=[3.900000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:30:10,972] [INFO] [timer.py:260:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=3.3074550213977747, CurrSamplesPerSec=3.2883980256929615, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:30:17,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[4.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:30:17,062] [INFO] [timer.py:260:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=3.3071346543156457, CurrSamplesPerSec=3.301451265995903, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 101350.578125, loss: 11.52633285522461
[2024-05-31 17:33:01,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[4.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:01,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=3.306820888971721, CurrSamplesPerSec=3.299752615163365, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:08,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[4.2000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:08,061] [INFO] [timer.py:260:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=3.306532057045835, CurrSamplesPerSec=3.301591599735042, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:14,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[4.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:14,157] [INFO] [timer.py:260:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=3.306190868452862, CurrSamplesPerSec=3.3003601884546914, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:20,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[4.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:20,254] [INFO] [timer.py:260:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=3.305862870986491, CurrSamplesPerSec=3.292039829695987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:26,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[4.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:26,357] [INFO] [timer.py:260:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=3.305505229571403, CurrSamplesPerSec=3.2913991552373907, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:32,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[4.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:32,452] [INFO] [timer.py:260:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=3.3052250993566643, CurrSamplesPerSec=3.300095321309132, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:38,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[4.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:38,548] [INFO] [timer.py:260:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=3.3049386027833343, CurrSamplesPerSec=3.289626975182136, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:44,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[4.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:44,643] [INFO] [timer.py:260:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=3.30466780329526, CurrSamplesPerSec=3.2899469363903413, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:50,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[4.9000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:50,736] [INFO] [timer.py:260:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=3.304465695263292, CurrSamplesPerSec=3.283252360400459, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:33:56,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:33:56,837] [INFO] [timer.py:260:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=3.3041868881047467, CurrSamplesPerSec=3.280098036072207, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 27130.705078125, loss: 10.208406448364258
[2024-05-31 17:36:41,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[5.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:36:41,660] [INFO] [timer.py:260:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=3.303958056069742, CurrSamplesPerSec=3.296716805513308, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:36:47,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[5.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:36:47,749] [INFO] [timer.py:260:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=3.3037849456135606, CurrSamplesPerSec=3.288213698015847, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:36:53,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[5.300000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:36:53,849] [INFO] [timer.py:260:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=3.30355202341146, CurrSamplesPerSec=3.289645035850924, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:36:59,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[5.400000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:36:59,946] [INFO] [timer.py:260:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=3.3033354822901195, CurrSamplesPerSec=3.28338986606713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:06,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[5.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:06,045] [INFO] [timer.py:260:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=3.3031082110232717, CurrSamplesPerSec=3.2874559803613432, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:12,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[5.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:12,141] [INFO] [timer.py:260:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=3.302911736047327, CurrSamplesPerSec=3.2880190807305394, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:18,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[5.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:18,231] [INFO] [timer.py:260:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=3.3027882654867544, CurrSamplesPerSec=3.293466742833362, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:24,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[5.8e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:24,328] [INFO] [timer.py:260:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=3.30259773708434, CurrSamplesPerSec=3.294342373136954, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:30,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[5.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:30,428] [INFO] [timer.py:260:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=3.3024107760703196, CurrSamplesPerSec=3.288508890051884, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:37:36,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[6e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:37:36,521] [INFO] [timer.py:260:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=3.3022628000167553, CurrSamplesPerSec=3.2946063175820566, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 9893.701171875, loss: 9.199577331542969
[2024-05-31 17:40:21,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=0, lr=[6.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:21,282] [INFO] [timer.py:260:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=3.3020244304015023, CurrSamplesPerSec=3.2960212111960727, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:27,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=0, lr=[6.200000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:27,375] [INFO] [timer.py:260:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=3.3019018926797403, CurrSamplesPerSec=3.295258596984672, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:33,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=0, lr=[6.300000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:33,465] [INFO] [timer.py:260:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=3.3017975658169227, CurrSamplesPerSec=3.2912855132334378, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:39,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=0, lr=[6.4000000000000006e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:39,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=3.3016840358071873, CurrSamplesPerSec=3.3007718556013046, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:45,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[6.5000000000000004e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:45,652] [INFO] [timer.py:260:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=3.301557375442286, CurrSamplesPerSec=3.298798864930505, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:51,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=0, lr=[6.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:51,741] [INFO] [timer.py:260:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=3.301477418700011, CurrSamplesPerSec=3.286773302740503, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:40:57,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=0, lr=[6.700000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:40:57,828] [INFO] [timer.py:260:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=3.3014194346324595, CurrSamplesPerSec=3.298346188795007, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:41:03,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=0, lr=[6.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:41:03,911] [INFO] [timer.py:260:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=3.30138072608168, CurrSamplesPerSec=3.310429306462446, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:41:10,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=0, lr=[6.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:41:10,004] [INFO] [timer.py:260:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=3.3012680251361015, CurrSamplesPerSec=3.2897353421696405, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:41:16,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:41:16,085] [INFO] [timer.py:260:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=3.301236620378593, CurrSamplesPerSec=3.302403950629726, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 3300.787109375, loss: 8.101892471313477
[2024-05-31 17:44:00,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=0, lr=[7.100000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:00,827] [INFO] [timer.py:260:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=3.3010899006061947, CurrSamplesPerSec=3.295760924569162, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:06,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=0, lr=[7.2000000000000005e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:06,924] [INFO] [timer.py:260:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=3.3009781256983093, CurrSamplesPerSec=3.2802250161985542, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:13,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=0, lr=[7.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:13,030] [INFO] [timer.py:260:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=3.300847048355329, CurrSamplesPerSec=3.2872743346671407, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:19,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=0, lr=[7.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:19,119] [INFO] [timer.py:260:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=3.30078066033884, CurrSamplesPerSec=3.2916264627900125, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:25,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[7.500000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:25,204] [INFO] [timer.py:260:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=3.3007354480278273, CurrSamplesPerSec=3.2901972720169943, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:31,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[7.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:31,292] [INFO] [timer.py:260:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=3.300678087898198, CurrSamplesPerSec=3.287048915799183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:37,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[7.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:37,387] [INFO] [timer.py:260:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=3.3005788924403783, CurrSamplesPerSec=3.2921741962955915, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:43,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=0, lr=[7.800000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:43,472] [INFO] [timer.py:260:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=3.3005472391887376, CurrSamplesPerSec=3.2938055578351197, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:49,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=0, lr=[7.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:49,559] [INFO] [timer.py:260:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=3.3005193694245722, CurrSamplesPerSec=3.2986068839468423, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:44:55,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[8.000000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:44:55,650] [INFO] [timer.py:260:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=3.300457067440372, CurrSamplesPerSec=3.2968321185956073, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 987.342529296875, loss: 6.895016670227051
[2024-05-31 17:47:40,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=0, lr=[8.1e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:47:40,422] [INFO] [timer.py:260:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=3.3003592853094146, CurrSamplesPerSec=3.2931034347390167, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:47:46,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=0, lr=[8.2e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:47:46,512] [INFO] [timer.py:260:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=3.3002866486072904, CurrSamplesPerSec=3.2910517969613724, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:47:52,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=0, lr=[8.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:47:52,610] [INFO] [timer.py:260:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=3.300187894217253, CurrSamplesPerSec=3.2862222152578093, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:47:58,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=0, lr=[8.400000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:47:58,706] [INFO] [timer.py:260:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=3.300100447756367, CurrSamplesPerSec=3.293506827995449, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:04,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[8.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:04,796] [INFO] [timer.py:260:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=3.300031035520879, CurrSamplesPerSec=3.3049931407057547, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:10,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=0, lr=[8.6e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:10,891] [INFO] [timer.py:260:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=3.2999421045025366, CurrSamplesPerSec=3.288470215589308, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:16,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=0, lr=[8.700000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:16,981] [INFO] [timer.py:260:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=3.299890881300649, CurrSamplesPerSec=3.2934628636759102, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:23,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=0, lr=[8.8e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:23,076] [INFO] [timer.py:260:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=3.29979232865628, CurrSamplesPerSec=3.283740750469058, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:29,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=0, lr=[8.900000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:29,173] [INFO] [timer.py:260:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=3.2997043240419828, CurrSamplesPerSec=3.291603213985396, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:48:35,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=0, lr=[9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:48:35,270] [INFO] [timer.py:260:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=3.299621979642871, CurrSamplesPerSec=3.2912454821238843, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 403.22821044921875, loss: 5.9994916915893555
[2024-05-31 17:51:20,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=0, lr=[9.100000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:20,308] [INFO] [timer.py:260:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=3.2995344492872656, CurrSamplesPerSec=3.2940422524149846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:26,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=0, lr=[9.200000000000002e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:26,402] [INFO] [timer.py:260:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=3.299452901799196, CurrSamplesPerSec=3.280301978635786, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:32,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=0, lr=[9.3e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:32,495] [INFO] [timer.py:260:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=3.2994050494002334, CurrSamplesPerSec=3.2946477244699017, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:38,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=0, lr=[9.4e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:38,586] [INFO] [timer.py:260:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=3.2993549578432493, CurrSamplesPerSec=3.2984629128727065, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:44,685] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=0, lr=[9.5e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:44,686] [INFO] [timer.py:260:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=3.2992738629401823, CurrSamplesPerSec=3.2915864233863057, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:50,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=0, lr=[9.600000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:50,781] [INFO] [timer.py:260:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=3.2991986284638, CurrSamplesPerSec=3.2780049229033015, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:51:56,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=0, lr=[9.7e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:51:56,878] [INFO] [timer.py:260:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=3.299119161255065, CurrSamplesPerSec=3.298084238163555, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:52:02,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=0, lr=[9.800000000000001e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:52:02,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=3.299081921925746, CurrSamplesPerSec=3.2939452423257776, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:52:09,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=0, lr=[9.9e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:52:09,061] [INFO] [timer.py:260:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=3.2990483853733292, CurrSamplesPerSec=3.292054041029175, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:52:15,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=0, lr=[1e-05], mom=[(0.9, 0.95)]
[2024-05-31 17:52:15,153] [INFO] [timer.py:260:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=3.299009430999764, CurrSamplesPerSec=3.2828835936595, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 271.4058837890625, loss: 5.603612422943115
saving model ... to step 1000
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/chanho/anaconda3/envs/COMEDY/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-31 17:55:00,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=0, lr=[9.999999980465383e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:00,821] [INFO] [timer.py:260:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=3.2987347207929987, CurrSamplesPerSec=3.2925838237048852, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:06,910] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=0, lr=[9.999999921861532e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:06,910] [INFO] [timer.py:260:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=3.298708758610614, CurrSamplesPerSec=3.2854808564504023, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:12,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=0, lr=[9.999999824188446e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:13,000] [INFO] [timer.py:260:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=3.2986746332288286, CurrSamplesPerSec=3.29281905017613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:19,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=0, lr=[9.999999687446127e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:19,089] [INFO] [timer.py:260:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=3.2986461908413176, CurrSamplesPerSec=3.302803123812674, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:25,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=0, lr=[9.999999511634576e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:25,179] [INFO] [timer.py:260:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=3.2986138397481906, CurrSamplesPerSec=3.294231115111445, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:31,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=0, lr=[9.999999296753795e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:31,263] [INFO] [timer.py:260:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=3.298609767468722, CurrSamplesPerSec=3.292504991582898, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:37,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=0, lr=[9.999999042803785e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:37,360] [INFO] [timer.py:260:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=3.2985440963523094, CurrSamplesPerSec=3.2810820684338426, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:43,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=0, lr=[9.999998749784548e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:43,451] [INFO] [timer.py:260:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=3.2985069807062386, CurrSamplesPerSec=3.3040727977694004, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:49,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=0, lr=[9.999998417696084e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:49,540] [INFO] [timer.py:260:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=3.2984719667245894, CurrSamplesPerSec=3.294678780318824, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:55:55,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=0, lr=[9.9999980465384e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:55:55,637] [INFO] [timer.py:260:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=3.298406769237441, CurrSamplesPerSec=3.284095566988071, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 215.67745971679688, loss: 5.373775005340576
[2024-05-31 17:58:40,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=0, lr=[9.999997636311497e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:58:40,970] [INFO] [timer.py:260:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=3.298328555656187, CurrSamplesPerSec=3.295077382355252, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:58:47,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=0, lr=[9.999997187015375e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:58:47,068] [INFO] [timer.py:260:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=3.2982700778241414, CurrSamplesPerSec=3.28784768193751, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:58:53,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=0, lr=[9.999996698650042e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:58:53,168] [INFO] [timer.py:260:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=3.2982052651378178, CurrSamplesPerSec=3.2841032812422313, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:58:59,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=0, lr=[9.999996171215501e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:58:59,265] [INFO] [timer.py:260:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=3.2981489778371618, CurrSamplesPerSec=3.2828347736111776, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:05,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=0, lr=[9.999995604711755e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:05,367] [INFO] [timer.py:260:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=3.2980703836004337, CurrSamplesPerSec=3.287470152146165, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:11,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=0, lr=[9.999994999138809e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:11,464] [INFO] [timer.py:260:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=3.2980256981392264, CurrSamplesPerSec=3.289861779345809, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:17,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=0, lr=[9.999994354496668e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:17,561] [INFO] [timer.py:260:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=3.297972267674289, CurrSamplesPerSec=3.291892555831168, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:23,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=0, lr=[9.999993670785335e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:23,660] [INFO] [timer.py:260:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=3.2979085712834326, CurrSamplesPerSec=3.289788238173131, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:29,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=0, lr=[9.999992948004818e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:29,752] [INFO] [timer.py:260:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=3.2978764972020507, CurrSamplesPerSec=3.289648906020037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 17:59:35,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=0, lr=[9.999992186155122e-06], mom=[(0.9, 0.95)]
[2024-05-31 17:59:35,845] [INFO] [timer.py:260:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=3.2978487913190073, CurrSamplesPerSec=3.2925902855216207, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 183.20370483398438, loss: 5.210597515106201
[2024-05-31 18:02:21,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=0, lr=[9.999991385236252e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:21,271] [INFO] [timer.py:260:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=3.2977787915015684, CurrSamplesPerSec=3.275347843827053, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:27,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=0, lr=[9.999990545248215e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:27,371] [INFO] [timer.py:260:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=3.297712750719558, CurrSamplesPerSec=3.2795543131927203, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:33,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=0, lr=[9.999989666191017e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:33,467] [INFO] [timer.py:260:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=3.297662127067809, CurrSamplesPerSec=3.2837009026782846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:39,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=0, lr=[9.999988748064664e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:39,555] [INFO] [timer.py:260:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=3.29765556651411, CurrSamplesPerSec=3.28993145296343, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:45,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=0, lr=[9.999987790869166e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:45,640] [INFO] [timer.py:260:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=3.297651632132615, CurrSamplesPerSec=3.296541907808049, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:51,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=0, lr=[9.999986794604528e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:51,733] [INFO] [timer.py:260:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=3.2976244552238656, CurrSamplesPerSec=3.296430501168089, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:02:57,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=0, lr=[9.999985759270759e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:02:57,829] [INFO] [timer.py:260:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=3.2975866347166223, CurrSamplesPerSec=3.2933878684279336, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:03:03,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=0, lr=[9.999984684867866e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:03:03,931] [INFO] [timer.py:260:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=3.2975196114319334, CurrSamplesPerSec=3.2802788895254147, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:03:10,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=0, lr=[9.99998357139586e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:03:10,028] [INFO] [timer.py:260:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=3.297491041238005, CurrSamplesPerSec=3.293839184500131, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:03:16,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=0, lr=[9.999982418854746e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:03:16,126] [INFO] [timer.py:260:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=3.297465214539211, CurrSamplesPerSec=3.284314151556902, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 165.64529418945312, loss: 5.1098480224609375
[2024-05-31 18:06:01,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=0, lr=[9.999981227244537e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:01,484] [INFO] [timer.py:260:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=3.2974247047617555, CurrSamplesPerSec=3.286671569412975, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:07,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=0, lr=[9.999979996565238e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:07,582] [INFO] [timer.py:260:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=3.297375597144531, CurrSamplesPerSec=3.2864037446929877, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:13,674] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=0, lr=[9.999978726816862e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:13,675] [INFO] [timer.py:260:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=3.297353899104393, CurrSamplesPerSec=3.2954074667703774, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:19,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=0, lr=[9.999977417999417e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:19,767] [INFO] [timer.py:260:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=3.297334356481491, CurrSamplesPerSec=3.285479569660004, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:25,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=0, lr=[9.999976070112914e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:25,861] [INFO] [timer.py:260:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=3.297310339899088, CurrSamplesPerSec=3.2912416081972187, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:31,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=0, lr=[9.999974683157362e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:31,963] [INFO] [timer.py:260:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=3.297249258249506, CurrSamplesPerSec=3.2855246079236973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:38,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=0, lr=[9.999973257132776e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:38,063] [INFO] [timer.py:260:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=3.2972030216479107, CurrSamplesPerSec=3.287130063030108, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:44,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=0, lr=[9.999971792039162e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:44,157] [INFO] [timer.py:260:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=3.2971772786340328, CurrSamplesPerSec=3.2864668340861987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:50,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=0, lr=[9.999970287876536e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:50,247] [INFO] [timer.py:260:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=3.2971669346153503, CurrSamplesPerSec=3.2840839956747816, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:06:56,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=0, lr=[9.999968744644907e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:06:56,343] [INFO] [timer.py:260:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=3.297133210495241, CurrSamplesPerSec=3.28927741130515, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 152.389404296875, loss: 5.026438236236572
[2024-05-31 18:09:41,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=0, lr=[9.999967162344287e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:09:41,832] [INFO] [timer.py:260:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=3.2970880664127433, CurrSamplesPerSec=3.283850015502031, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:09:47,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=0, lr=[9.99996554097469e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:09:47,925] [INFO] [timer.py:260:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=3.297068857230089, CurrSamplesPerSec=3.2940008607447013, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:09:54,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=0, lr=[9.999963880536127e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:09:54,017] [INFO] [timer.py:260:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=3.2970421430137735, CurrSamplesPerSec=3.291860260692669, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:00,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=0, lr=[9.999962181028612e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:00,109] [INFO] [timer.py:260:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=3.2970200748906144, CurrSamplesPerSec=3.284769415170948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:06,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=0, lr=[9.999960442452157e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:06,212] [INFO] [timer.py:260:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=3.296968712113158, CurrSamplesPerSec=3.2878463932924644, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:12,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=0, lr=[9.999958664806778e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:12,315] [INFO] [timer.py:260:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=3.2969104008712455, CurrSamplesPerSec=3.2853174421341578, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:18,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=0, lr=[9.999956848092488e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:18,407] [INFO] [timer.py:260:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=3.2968971113082666, CurrSamplesPerSec=3.2952404746247947, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:24,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=0, lr=[9.999954992309298e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:24,500] [INFO] [timer.py:260:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=3.296870444698853, CurrSamplesPerSec=3.290536705379057, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:30,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=0, lr=[9.999953097457226e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:30,590] [INFO] [timer.py:260:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=3.2968603873444398, CurrSamplesPerSec=3.2935805355174823, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:10:36,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=0, lr=[9.999951163536287e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:10:36,684] [INFO] [timer.py:260:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=3.2968472484034823, CurrSamplesPerSec=3.2945674995699465, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 142.8118896484375, loss: 4.961525917053223
[2024-05-31 18:13:22,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=0, lr=[9.999949190546493e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:22,225] [INFO] [timer.py:260:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=3.2968026176736402, CurrSamplesPerSec=3.2873915646975096, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:28,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=0, lr=[9.999947178487864e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:28,322] [INFO] [timer.py:260:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=3.2967648290322935, CurrSamplesPerSec=3.2921729042568306, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:34,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=0, lr=[9.999945127360413e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:34,412] [INFO] [timer.py:260:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=3.29675475588183, CurrSamplesPerSec=3.2945959660227198, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:40,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=0, lr=[9.999943037164155e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:40,509] [INFO] [timer.py:260:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=3.296721470717039, CurrSamplesPerSec=3.284460748096439, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:46,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=0, lr=[9.999940907899109e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:46,606] [INFO] [timer.py:260:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=3.2966852726751665, CurrSamplesPerSec=3.300316040977921, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:52,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=0, lr=[9.999938739565288e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:52,701] [INFO] [timer.py:260:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=3.296662095702788, CurrSamplesPerSec=3.2967090318878856, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:13:58,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=0, lr=[9.999936532162712e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:13:58,793] [INFO] [timer.py:260:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=3.2966435532733347, CurrSamplesPerSec=3.2859415921951616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:14:04,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=0, lr=[9.999934285691398e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:14:04,888] [INFO] [timer.py:260:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=3.2966117907739743, CurrSamplesPerSec=3.2925140377002426, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:14:10,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=0, lr=[9.999932000151363e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:14:10,976] [INFO] [timer.py:260:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=3.29661253200548, CurrSamplesPerSec=3.2987677313610324, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:14:17,066] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=0, lr=[9.999929675542623e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:14:17,066] [INFO] [timer.py:260:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=3.296607718664756, CurrSamplesPerSec=3.2921083036117946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 134.84048461914062, loss: 4.904088973999023
[2024-05-31 18:17:02,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=0, lr=[9.999927311865201e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:02,471] [INFO] [timer.py:260:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=3.2965994218711505, CurrSamplesPerSec=3.2930387975705195, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:08,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=0, lr=[9.99992490911911e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:08,560] [INFO] [timer.py:260:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=3.2965931469181466, CurrSamplesPerSec=3.293915493709894, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:14,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=0, lr=[9.999922467304373e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:14,644] [INFO] [timer.py:260:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=3.296609346826999, CurrSamplesPerSec=3.301635781344276, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:20,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=0, lr=[9.999919986421005e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:20,727] [INFO] [timer.py:260:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=3.296616743847825, CurrSamplesPerSec=3.2927066025601017, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:26,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=0, lr=[9.999917466469029e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:26,809] [INFO] [timer.py:260:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=3.2966354979408767, CurrSamplesPerSec=3.2896089147116587, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:32,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=0, lr=[9.999914907448464e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:32,906] [INFO] [timer.py:260:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=3.2966096557089473, CurrSamplesPerSec=3.297546202789896, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:38,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=0, lr=[9.999912309359328e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:38,993] [INFO] [timer.py:260:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=3.2966139718341174, CurrSamplesPerSec=3.296475840171021, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:45,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=0, lr=[9.999909672201644e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:45,086] [INFO] [timer.py:260:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=3.296603379692411, CurrSamplesPerSec=3.282992801655936, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:51,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=0, lr=[9.99990699597543e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:51,176] [INFO] [timer.py:260:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=3.296599323140481, CurrSamplesPerSec=3.2966325931905183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:17:57,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=0, lr=[9.99990428068071e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:17:57,268] [INFO] [timer.py:260:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=3.2965847626290805, CurrSamplesPerSec=3.2852994289523245, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 128.5732879638672, loss: 4.856493949890137
[2024-05-31 18:20:42,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=0, lr=[9.999901526317501e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:20:42,716] [INFO] [timer.py:260:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=3.296552989876705, CurrSamplesPerSec=3.2903263258802986, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:20:48,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=0, lr=[9.999898732885829e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:20:48,808] [INFO] [timer.py:260:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=3.2965406688929586, CurrSamplesPerSec=3.2944872785768595, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:20:54,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=0, lr=[9.999895900385711e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:20:54,900] [INFO] [timer.py:260:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=3.2965322038080074, CurrSamplesPerSec=3.2952715416494804, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:00,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=0, lr=[9.999893028817175e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:01,000] [INFO] [timer.py:260:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=3.2965023256425514, CurrSamplesPerSec=3.2916471286698243, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:07,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=0, lr=[9.999890118180237e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:07,099] [INFO] [timer.py:260:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=3.296468773192406, CurrSamplesPerSec=3.2875307056940546, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:13,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=0, lr=[9.999887168474926e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:13,194] [INFO] [timer.py:260:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=3.2964439325242743, CurrSamplesPerSec=3.293927134408638, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:19,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=0, lr=[9.999884179701262e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:19,283] [INFO] [timer.py:260:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=3.2964360637013286, CurrSamplesPerSec=3.2970562895791016, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:25,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=0, lr=[9.999881151859267e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:25,372] [INFO] [timer.py:260:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=3.2964346197311403, CurrSamplesPerSec=3.2922129579299964, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:31,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=0, lr=[9.999878084948967e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:31,470] [INFO] [timer.py:260:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=3.2964042669880156, CurrSamplesPerSec=3.294698190521713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:21:37,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=0, lr=[9.999874978970385e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:21:37,571] [INFO] [timer.py:260:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=3.2963856691595117, CurrSamplesPerSec=3.28994048494475, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 124.10472106933594, loss: 4.82111930847168
[2024-05-31 18:24:22,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=0, lr=[9.999871833923545e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:22,908] [INFO] [timer.py:260:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=3.296349945119032, CurrSamplesPerSec=3.2854731357231315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:29,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=0, lr=[9.999868649808472e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:29,003] [INFO] [timer.py:260:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=3.296326031685407, CurrSamplesPerSec=3.295650865477809, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:35,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=0, lr=[9.999865426625191e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:35,102] [INFO] [timer.py:260:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=3.296298166316804, CurrSamplesPerSec=3.2915928812887607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:41,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=0, lr=[9.999862164373726e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:41,198] [INFO] [timer.py:260:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=3.296270567276056, CurrSamplesPerSec=3.301231693620049, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:47,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=0, lr=[9.999858863054105e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:47,288] [INFO] [timer.py:260:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=3.2962605975496944, CurrSamplesPerSec=3.292751839183419, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:53,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=0, lr=[9.999855522666351e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:53,372] [INFO] [timer.py:260:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=3.2962766339486165, CurrSamplesPerSec=3.2975565728967413, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:24:59,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=0, lr=[9.999852143210492e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:24:59,466] [INFO] [timer.py:260:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=3.2962606747618994, CurrSamplesPerSec=3.288497287617596, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:25:05,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=0, lr=[9.999848724686555e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:25:05,559] [INFO] [timer.py:260:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=3.2962483658622204, CurrSamplesPerSec=3.2891097502018294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:25:11,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=0, lr=[9.999845267094564e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:25:11,647] [INFO] [timer.py:260:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=3.2962462234454057, CurrSamplesPerSec=3.2912170735401087, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:25:17,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=0, lr=[9.999841770434547e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:25:17,746] [INFO] [timer.py:260:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=3.29622059981734, CurrSamplesPerSec=3.29176337907904, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 119.23680114746094, loss: 4.7811079025268555
[2024-05-31 18:28:03,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=0, lr=[9.999838234706532e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:03,234] [INFO] [timer.py:260:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=3.2961943375846228, CurrSamplesPerSec=3.2872369774032553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:09,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=0, lr=[9.999834659910549e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:09,328] [INFO] [timer.py:260:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=3.2961871250495887, CurrSamplesPerSec=3.2972312418710157, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:15,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=0, lr=[9.99983104604662e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:15,416] [INFO] [timer.py:260:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=3.296185367632458, CurrSamplesPerSec=3.29596293449886, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:21,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=0, lr=[9.999827393114778e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:21,512] [INFO] [timer.py:260:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=3.296166081252619, CurrSamplesPerSec=3.3055023483206325, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:27,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=0, lr=[9.99982370111505e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:27,608] [INFO] [timer.py:260:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=3.2961476985303655, CurrSamplesPerSec=3.2920501651988645, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:33,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=0, lr=[9.999819970047467e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:33,705] [INFO] [timer.py:260:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=3.296125711614007, CurrSamplesPerSec=3.2822439092338307, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:39,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=0, lr=[9.999816199912053e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:39,794] [INFO] [timer.py:260:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=3.2961299294612054, CurrSamplesPerSec=3.2927725191966344, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:45,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=0, lr=[9.999812390708843e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:45,894] [INFO] [timer.py:260:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=3.296104243827086, CurrSamplesPerSec=3.297114604946807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:51,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=0, lr=[9.999808542437864e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:51,984] [INFO] [timer.py:260:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=3.2961019023529423, CurrSamplesPerSec=3.3027862187571118, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:28:58,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=0, lr=[9.999804655099145e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:28:58,072] [INFO] [timer.py:260:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=3.2961015911775022, CurrSamplesPerSec=3.275608753222949, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 114.9181900024414, loss: 4.7442169189453125
saving model ... to step 2000
[2024-05-31 18:31:44,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=0, lr=[9.99980072869272e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:31:44,180] [INFO] [timer.py:260:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=3.296105383901127, CurrSamplesPerSec=3.292464930803589, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:31:50,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=0, lr=[9.999796763218615e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:31:50,276] [INFO] [timer.py:260:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=3.296089178893163, CurrSamplesPerSec=3.2901417819682077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:31:56,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=0, lr=[9.999792758676865e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:31:56,374] [INFO] [timer.py:260:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=3.296065572727872, CurrSamplesPerSec=3.2882704120231905, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:02,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=0, lr=[9.9997887150675e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:02,463] [INFO] [timer.py:260:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=3.296066200868712, CurrSamplesPerSec=3.2908219868094206, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:08,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=0, lr=[9.999784632390551e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:08,561] [INFO] [timer.py:260:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=3.2960474408087097, CurrSamplesPerSec=3.2878244864812323, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:14,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=0, lr=[9.999780510646051e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:14,655] [INFO] [timer.py:260:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=3.296035560127399, CurrSamplesPerSec=3.2944407004381273, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:20,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=0, lr=[9.999776349834031e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:20,753] [INFO] [timer.py:260:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=3.296013389499419, CurrSamplesPerSec=3.2872434182502457, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:26,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=0, lr=[9.999772149954522e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:26,844] [INFO] [timer.py:260:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=3.296005805157221, CurrSamplesPerSec=3.288042278932616, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:32,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=0, lr=[9.999767911007564e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:32,939] [INFO] [timer.py:260:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=3.2959897026973612, CurrSamplesPerSec=3.2894554087189345, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:32:39,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=0, lr=[9.99976363299318e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:32:39,031] [INFO] [timer.py:260:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=3.295981016041846, CurrSamplesPerSec=3.3013161410773524, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 111.07579040527344, loss: 4.710212707519531
[2024-05-31 18:35:24,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=0, lr=[9.99975931591141e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:24,437] [INFO] [timer.py:260:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=3.295974256702413, CurrSamplesPerSec=3.2970148221281734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:35:30,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=0, lr=[9.999754959762287e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:30,525] [INFO] [timer.py:260:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=3.2959739207612855, CurrSamplesPerSec=3.2936361416208007, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:35:36,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=0, lr=[9.999750564545842e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:36,611] [INFO] [timer.py:260:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=3.295981208427698, CurrSamplesPerSec=3.294347548111739, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:35:42,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=0, lr=[9.999746130262113e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:42,705] [INFO] [timer.py:260:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=3.295973299495708, CurrSamplesPerSec=3.280032625904358, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:35:48,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=0, lr=[9.999741656911134e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:48,797] [INFO] [timer.py:260:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=3.29597155891015, CurrSamplesPerSec=3.294722777107028, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:35:54,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=0, lr=[9.999737144492938e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:35:54,893] [INFO] [timer.py:260:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=3.2959585735812356, CurrSamplesPerSec=3.290033388202469, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:36:00,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=0, lr=[9.999732593007562e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:36:00,994] [INFO] [timer.py:260:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=3.2959351385065414, CurrSamplesPerSec=3.291004024792944, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:36:07,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=0, lr=[9.99972800245504e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:36:07,085] [INFO] [timer.py:260:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=3.2959347078175134, CurrSamplesPerSec=3.305727699974543, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:36:13,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=0, lr=[9.999723372835409e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:36:13,183] [INFO] [timer.py:260:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=3.2959200249664025, CurrSamplesPerSec=3.3012213003854294, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:36:19,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=0, lr=[9.999718704148705e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:36:19,270] [INFO] [timer.py:260:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=3.2959231330113234, CurrSamplesPerSec=3.288033257370689, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 105.92646026611328, loss: 4.66274356842041
[2024-05-31 18:39:04,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=0, lr=[9.999713996394965e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:04,670] [INFO] [timer.py:260:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=3.295894875485517, CurrSamplesPerSec=3.290452808488973, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:10,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=0, lr=[9.999709249574226e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:10,763] [INFO] [timer.py:260:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=3.295884522574841, CurrSamplesPerSec=3.284400307586775, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:16,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=0, lr=[9.999704463686523e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:16,855] [INFO] [timer.py:260:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=3.2958767746723945, CurrSamplesPerSec=3.2890800888630283, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:22,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=0, lr=[9.999699638731895e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:22,947] [INFO] [timer.py:260:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=3.295867052955992, CurrSamplesPerSec=3.2877420163983255, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:29,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=0, lr=[9.99969477471038e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:29,036] [INFO] [timer.py:260:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=3.295863241535945, CurrSamplesPerSec=3.2944407004381273, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:35,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=0, lr=[9.999689871622014e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:35,123] [INFO] [timer.py:260:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=3.295866643955984, CurrSamplesPerSec=3.2944626955061804, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:41,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=0, lr=[9.999684929466837e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:41,207] [INFO] [timer.py:260:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=3.2958764773978415, CurrSamplesPerSec=3.290330197652613, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:47,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=0, lr=[9.99967994824489e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:47,293] [INFO] [timer.py:260:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=3.295883381123307, CurrSamplesPerSec=3.30072120331449, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:53,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=0, lr=[9.999674927956206e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:53,382] [INFO] [timer.py:260:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=3.295888004765814, CurrSamplesPerSec=3.29397369802639, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:39:59,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=0, lr=[9.999669868600829e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:39:59,465] [INFO] [timer.py:260:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=3.2959002193305404, CurrSamplesPerSec=3.3006536693502535, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 101.84122467041016, loss: 4.623414993286133
[2024-05-31 18:42:44,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=0, lr=[9.999664770178797e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:42:44,690] [INFO] [timer.py:260:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=3.295905225990619, CurrSamplesPerSec=3.290601244359644, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:42:50,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=0, lr=[9.999659632690148e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:42:50,777] [INFO] [timer.py:260:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=3.295911358742945, CurrSamplesPerSec=3.28962826522333, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:42:56,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=0, lr=[9.999654456134926e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:42:56,865] [INFO] [timer.py:260:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=3.29591334307533, CurrSamplesPerSec=3.284694815311959, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:02,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=0, lr=[9.99964924051317e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:02,959] [INFO] [timer.py:260:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=3.2959057487887917, CurrSamplesPerSec=3.290419250930806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:09,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=0, lr=[9.999643985824921e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:09,046] [INFO] [timer.py:260:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=3.295911862729687, CurrSamplesPerSec=3.297443801486887, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:15,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=0, lr=[9.999638692070217e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:15,133] [INFO] [timer.py:260:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=3.2959213149616566, CurrSamplesPerSec=3.293126704740848, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:21,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=0, lr=[9.999633359249101e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:21,216] [INFO] [timer.py:260:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=3.295931224987962, CurrSamplesPerSec=3.2837356087642924, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:27,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=0, lr=[9.999627987361618e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:27,304] [INFO] [timer.py:260:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=3.2959327785739423, CurrSamplesPerSec=3.2856931906711564, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:33,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=0, lr=[9.999622576407806e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:33,395] [INFO] [timer.py:260:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=3.2959362366939606, CurrSamplesPerSec=3.2855722211451277, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:43:39,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=0, lr=[9.999617126387709e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:43:39,475] [INFO] [timer.py:260:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=3.2959551174450494, CurrSamplesPerSec=3.301491545755876, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 98.59984588623047, loss: 4.59106969833374
[2024-05-31 18:46:24,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=0, lr=[9.999611637301369e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:24,816] [INFO] [timer.py:260:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=3.2959589924526536, CurrSamplesPerSec=3.2907329117305655, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:46:30,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=0, lr=[9.999606109148828e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:30,903] [INFO] [timer.py:260:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=3.2959623378709666, CurrSamplesPerSec=3.285446113463439, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:46:36,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=0, lr=[9.999600541930133e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:36,984] [INFO] [timer.py:260:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=3.295975853229032, CurrSamplesPerSec=3.3029500750472884, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:46:43,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=0, lr=[9.999594935645321e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:43,067] [INFO] [timer.py:260:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=3.295986275739278, CurrSamplesPerSec=3.2943928298346363, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:46:49,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=0, lr=[9.999589290294442e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:49,157] [INFO] [timer.py:260:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=3.29598908734019, CurrSamplesPerSec=3.295491616512406, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:46:55,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=0, lr=[9.999583605877536e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:46:55,243] [INFO] [timer.py:260:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=3.295994083640305, CurrSamplesPerSec=3.286129527110562, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:47:01,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=0, lr=[9.99957788239465e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:47:01,335] [INFO] [timer.py:260:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=3.295992510216123, CurrSamplesPerSec=3.3062071629296517, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:47:07,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=0, lr=[9.99957211984583e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:47:07,423] [INFO] [timer.py:260:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=3.295995049402414, CurrSamplesPerSec=3.3016617710785474, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:47:13,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=0, lr=[9.999566318231117e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:47:13,509] [INFO] [timer.py:260:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=3.2959982354818385, CurrSamplesPerSec=3.2845070444594016, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:47:19,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=0, lr=[9.999560477550557e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:47:19,596] [INFO] [timer.py:260:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=3.2959993166258057, CurrSamplesPerSec=3.281957545001383, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 95.69881439208984, loss: 4.561205863952637
[2024-05-31 18:50:04,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=0, lr=[9.999554597804198e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:04,968] [INFO] [timer.py:260:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=3.2959868681781743, CurrSamplesPerSec=3.2866252120107493, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:11,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=0, lr=[9.999548678992084e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:11,058] [INFO] [timer.py:260:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=3.29598573062031, CurrSamplesPerSec=3.2935507934887593, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:17,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=0, lr=[9.999542721114264e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:17,146] [INFO] [timer.py:260:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=3.295989144926113, CurrSamplesPerSec=3.2965406123387315, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:23,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=0, lr=[9.999536724170781e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:23,234] [INFO] [timer.py:260:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=3.2959897958151254, CurrSamplesPerSec=3.2782431953442, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:29,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=0, lr=[9.999530688161683e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:29,320] [INFO] [timer.py:260:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=3.2959931922794503, CurrSamplesPerSec=3.2976524994771625, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:35,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=0, lr=[9.99952461308702e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:35,407] [INFO] [timer.py:260:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=3.295996759134504, CurrSamplesPerSec=3.2928449012885443, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:41,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=0, lr=[9.999518498946833e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:41,489] [INFO] [timer.py:260:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=3.2960086862727165, CurrSamplesPerSec=3.294141855384774, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:47,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=0, lr=[9.999512345741177e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:47,574] [INFO] [timer.py:260:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=3.29601336248434, CurrSamplesPerSec=3.2902888992176913, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:53,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=0, lr=[9.999506153470096e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:53,665] [INFO] [timer.py:260:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=3.2960070491586118, CurrSamplesPerSec=3.289482496970743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:50:59,760] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=0, lr=[9.99949992213364e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:50:59,761] [INFO] [timer.py:260:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=3.2959920082866105, CurrSamplesPerSec=3.284064710333836, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 93.71821594238281, loss: 4.540292739868164
[2024-05-31 18:53:45,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=0, lr=[9.999493651731855e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:53:45,145] [INFO] [timer.py:260:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=3.2959702438011607, CurrSamplesPerSec=3.2917000861713097, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:53:51,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=0, lr=[9.999487342264795e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:53:51,236] [INFO] [timer.py:260:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=3.295972764867937, CurrSamplesPerSec=3.296666277603354, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:53:57,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=0, lr=[9.999480993732504e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:53:57,327] [INFO] [timer.py:260:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=3.2959712954471714, CurrSamplesPerSec=3.2913694525924915, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:03,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=0, lr=[9.999474606135034e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:03,419] [INFO] [timer.py:260:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=3.295964224605105, CurrSamplesPerSec=3.2908478065743143, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:09,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=0, lr=[9.999468179472436e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:09,509] [INFO] [timer.py:260:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=3.295961410607505, CurrSamplesPerSec=3.3048082499180556, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:15,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=0, lr=[9.999461713744759e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:15,603] [INFO] [timer.py:260:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=3.295956772714891, CurrSamplesPerSec=3.2899895165658264, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:21,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=0, lr=[9.999455208952052e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:21,690] [INFO] [timer.py:260:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=3.2959650867100496, CurrSamplesPerSec=3.3001978873655013, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:27,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=0, lr=[9.999448665094367e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:27,774] [INFO] [timer.py:260:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=3.295975434002209, CurrSamplesPerSec=3.300587436800378, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:33,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=0, lr=[9.999442082171758e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:33,857] [INFO] [timer.py:260:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=3.2959879528526406, CurrSamplesPerSec=3.2971742183437422, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:54:39,947] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=0, lr=[9.999435460184273e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:54:39,948] [INFO] [timer.py:260:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=3.2959851399766773, CurrSamplesPerSec=3.285271122922818, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 91.81025695800781, loss: 4.519721508026123
[2024-05-31 18:57:25,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=0, lr=[9.999428799131963e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:25,304] [INFO] [timer.py:260:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=3.2959721746563453, CurrSamplesPerSec=3.29104663233576, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:57:31,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=0, lr=[9.999422099014883e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:31,400] [INFO] [timer.py:260:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=3.295963484332322, CurrSamplesPerSec=3.2913539557731846, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:57:37,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=0, lr=[9.999415359833085e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:37,495] [INFO] [timer.py:260:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=3.2959562894912056, CurrSamplesPerSec=3.2947357175624807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:57:43,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=0, lr=[9.99940858158662e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:43,586] [INFO] [timer.py:260:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=3.2959524022498363, CurrSamplesPerSec=3.282827065315227, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:57:49,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=0, lr=[9.99940176427554e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:49,680] [INFO] [timer.py:260:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=3.2959463515122636, CurrSamplesPerSec=3.289068482397819, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:57:55,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=0, lr=[9.999394907899901e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:57:55,766] [INFO] [timer.py:260:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=3.2959515404738604, CurrSamplesPerSec=3.2967077362872126, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:58:01,847] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=0, lr=[9.999388012459758e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:58:01,848] [INFO] [timer.py:260:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=3.2959630037409835, CurrSamplesPerSec=3.29880016217532, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:58:07,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=0, lr=[9.99938107795516e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:58:07,937] [INFO] [timer.py:260:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=3.295964450944196, CurrSamplesPerSec=3.282573996369395, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:58:14,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=0, lr=[9.999374104386164e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:58:14,022] [INFO] [timer.py:260:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=3.2959703720254248, CurrSamplesPerSec=3.300861474994088, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 18:58:20,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=0, lr=[9.999367091752826e-06], mom=[(0.9, 0.95)]
[2024-05-31 18:58:20,103] [INFO] [timer.py:260:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=3.2959821862701264, CurrSamplesPerSec=3.2922452599892464, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 90.77163696289062, loss: 4.508344650268555
[2024-05-31 19:01:05,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=0, lr=[9.999360040055195e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:05,465] [INFO] [timer.py:260:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=3.295972703865031, CurrSamplesPerSec=3.3012693696441398, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:11,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=0, lr=[9.999352949293332e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:11,547] [INFO] [timer.py:260:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=3.2959853198413906, CurrSamplesPerSec=3.2810140524235814, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:17,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=0, lr=[9.999345819467292e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:17,638] [INFO] [timer.py:260:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=3.2959827335077105, CurrSamplesPerSec=3.285848919877005, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:23,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=0, lr=[9.999338650577128e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:23,724] [INFO] [timer.py:260:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=3.295985210455751, CurrSamplesPerSec=3.3011368577800324, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:29,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=0, lr=[9.999331442622897e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:29,817] [INFO] [timer.py:260:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=3.2959810220628127, CurrSamplesPerSec=3.290596081148032, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:35,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=0, lr=[9.999324195604654e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:35,900] [INFO] [timer.py:260:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=3.2959894467194744, CurrSamplesPerSec=3.291917100560229, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:41,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=0, lr=[9.999316909522459e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:41,987] [INFO] [timer.py:260:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=3.295991560986833, CurrSamplesPerSec=3.289282570379389, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:48,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=0, lr=[9.999309584376367e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:48,074] [INFO] [timer.py:260:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=3.2959944273282997, CurrSamplesPerSec=3.2945364458188577, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:01:54,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=0, lr=[9.999302220166433e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:01:54,162] [INFO] [timer.py:260:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=3.295999215940118, CurrSamplesPerSec=3.2925553920125603, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:02:00,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=0, lr=[9.99929481689272e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:02:00,246] [INFO] [timer.py:260:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=3.296008619483337, CurrSamplesPerSec=3.298364345331175, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 89.39002990722656, loss: 4.493005752563477
[2024-05-31 19:04:45,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=0, lr=[9.99928737455528e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:04:45,689] [INFO] [timer.py:260:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=3.2959937368121466, CurrSamplesPerSec=3.2893290027758075, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:04:51,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=0, lr=[9.999279893154174e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:04:51,777] [INFO] [timer.py:260:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=3.2959924653618056, CurrSamplesPerSec=3.2901908195895717, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:04:57,870] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=0, lr=[9.999272372689463e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:04:57,870] [INFO] [timer.py:260:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=3.2959838963576864, CurrSamplesPerSec=3.2901301680088233, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:03,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=0, lr=[9.9992648131612e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:03,961] [INFO] [timer.py:260:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=3.2959815496706426, CurrSamplesPerSec=3.2723618592284214, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:10,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=0, lr=[9.99925721456945e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:10,060] [INFO] [timer.py:260:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=3.2959648603293488, CurrSamplesPerSec=3.2908452245795923, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:16,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=0, lr=[9.999249576914267e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:16,154] [INFO] [timer.py:260:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=3.2959564458657162, CurrSamplesPerSec=3.2873657991387946, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:22,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=0, lr=[9.999241900195713e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:22,247] [INFO] [timer.py:260:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=3.2959504634835333, CurrSamplesPerSec=3.2867153526047526, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:28,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=0, lr=[9.99923418441385e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:28,343] [INFO] [timer.py:260:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=3.2959426579443023, CurrSamplesPerSec=3.293487431827435, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:34,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=0, lr=[9.999226429568736e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:34,443] [INFO] [timer.py:260:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=3.2959294984916006, CurrSamplesPerSec=3.286585294184482, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:05:40,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=0, lr=[9.99921863566043e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:05:40,542] [INFO] [timer.py:260:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=3.2959139955010825, CurrSamplesPerSec=3.2796556063854037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 88.44137573242188, loss: 4.482337474822998
saving model ... to step 3000
[2024-05-31 19:08:26,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=0, lr=[9.999210802688997e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:26,468] [INFO] [timer.py:260:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=3.2958912693860105, CurrSamplesPerSec=3.297016117970226, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:08:32,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=0, lr=[9.999202930654494e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:32,555] [INFO] [timer.py:260:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=3.29589833735344, CurrSamplesPerSec=3.2932663316582915, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:08:38,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=0, lr=[9.999195019556988e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:38,643] [INFO] [timer.py:260:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=3.295899112203887, CurrSamplesPerSec=3.293790038067453, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:08:44,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=0, lr=[9.999187069396534e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:44,732] [INFO] [timer.py:260:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=3.2958947758427266, CurrSamplesPerSec=3.2869317102051676, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:08:50,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=0, lr=[9.9991790801732e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:50,815] [INFO] [timer.py:260:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=3.295901897858911, CurrSamplesPerSec=3.3029747849461732, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:08:56,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=0, lr=[9.999171051887046e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:08:56,902] [INFO] [timer.py:260:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=3.295907835038022, CurrSamplesPerSec=3.295023021852888, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:09:02,978] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=0, lr=[9.999162984538133e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:09:02,978] [INFO] [timer.py:260:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=3.29592882167964, CurrSamplesPerSec=3.3013824028764183, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:09:09,066] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=0, lr=[9.999154878126527e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:09:09,067] [INFO] [timer.py:260:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=3.295928490325632, CurrSamplesPerSec=3.292118639544631, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:09:15,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=0, lr=[9.99914673265229e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:09:15,158] [INFO] [timer.py:260:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=3.2959257120499736, CurrSamplesPerSec=3.290057905214921, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:09:21,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=0, lr=[9.999138548115486e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:09:21,240] [INFO] [timer.py:260:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=3.2959349389240544, CurrSamplesPerSec=3.2933245130351314, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 87.46623229980469, loss: 4.471250534057617
[2024-05-31 19:12:06,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=0, lr=[9.999130324516177e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:06,657] [INFO] [timer.py:260:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=3.2959311448583803, CurrSamplesPerSec=3.301634481868303, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:12,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=0, lr=[9.999122061854431e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:12,750] [INFO] [timer.py:260:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=3.295925558087072, CurrSamplesPerSec=3.3009770782095424, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:18,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=0, lr=[9.999113760130309e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:18,839] [INFO] [timer.py:260:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=3.295926760594483, CurrSamplesPerSec=3.291384949557728, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:24,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=0, lr=[9.999105419343877e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:24,931] [INFO] [timer.py:260:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=3.2959241208279284, CurrSamplesPerSec=3.282730714670058, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:31,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=0, lr=[9.999097039495202e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:31,026] [INFO] [timer.py:260:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=3.2959152829207996, CurrSamplesPerSec=3.2811411034833977, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:37,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=0, lr=[9.999088620584348e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:37,121] [INFO] [timer.py:260:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=3.295907949775891, CurrSamplesPerSec=3.283892438003798, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:43,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=0, lr=[9.99908016261138e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:43,210] [INFO] [timer.py:260:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=3.2959121092212396, CurrSamplesPerSec=3.2931008492035576, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:49,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=0, lr=[9.999071665576367e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:49,300] [INFO] [timer.py:260:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=3.2959117096757966, CurrSamplesPerSec=3.290115973280923, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:12:55,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=0, lr=[9.999063129479372e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:12:55,391] [INFO] [timer.py:260:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=3.2959124991555644, CurrSamplesPerSec=3.286437220395903, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:13:01,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=0, lr=[9.999054554320463e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:13:01,477] [INFO] [timer.py:260:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=3.295921933495341, CurrSamplesPerSec=3.299337309189766, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 86.81045532226562, loss: 4.463723182678223
[2024-05-31 19:15:46,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=0, lr=[9.999045940099705e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:15:46,876] [INFO] [timer.py:260:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=3.2959239432265575, CurrSamplesPerSec=3.2970031595955374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:15:52,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=0, lr=[9.99903728681717e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:15:52,964] [INFO] [timer.py:260:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=3.295928032247202, CurrSamplesPerSec=3.3013863007121396, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:15:59,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=0, lr=[9.999028594472922e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:15:59,049] [INFO] [timer.py:260:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=3.2959338133711986, CurrSamplesPerSec=3.2954967950984413, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:05,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=0, lr=[9.99901986306703e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:05,139] [INFO] [timer.py:260:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=3.2959340292857164, CurrSamplesPerSec=3.294774539538749, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:11,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=0, lr=[9.999011092599562e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:11,219] [INFO] [timer.py:260:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=3.2959471523787536, CurrSamplesPerSec=3.2967997264656295, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:17,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=0, lr=[9.999002283070587e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:17,306] [INFO] [timer.py:260:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=3.2959555547593617, CurrSamplesPerSec=3.295644391642525, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:23,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=0, lr=[9.998993434480173e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:23,388] [INFO] [timer.py:260:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=3.2959687212597517, CurrSamplesPerSec=3.2990077344876663, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:29,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=0, lr=[9.998984546828389e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:29,471] [INFO] [timer.py:260:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=3.295980632602993, CurrSamplesPerSec=3.3109898502702713, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:35,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=0, lr=[9.998975620115306e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:35,555] [INFO] [timer.py:260:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=3.2959887089612767, CurrSamplesPerSec=3.2915786739368085, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:16:41,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=0, lr=[9.998966654340994e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:16:41,641] [INFO] [timer.py:260:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=3.2959934991738757, CurrSamplesPerSec=3.2930336267066553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 85.82131958007812, loss: 4.452260971069336
[2024-05-31 19:19:27,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=0, lr=[9.998957649505519e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:27,044] [INFO] [timer.py:260:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=3.2959785945438704, CurrSamplesPerSec=3.2938637582664567, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:19:33,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=0, lr=[9.998948605608955e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:33,128] [INFO] [timer.py:260:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=3.2959863300170182, CurrSamplesPerSec=3.297765285162508, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:19:39,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=0, lr=[9.998939522651374e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:39,219] [INFO] [timer.py:260:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=3.2959868726013783, CurrSamplesPerSec=3.2992218207961765, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:19:45,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=0, lr=[9.998930400632844e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:45,303] [INFO] [timer.py:260:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=3.2959955002921197, CurrSamplesPerSec=3.2997617011501124, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:19:51,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=0, lr=[9.998921239553436e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:51,387] [INFO] [timer.py:260:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=3.2960031469788693, CurrSamplesPerSec=3.2941289195938164, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:19:57,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=0, lr=[9.998912039413224e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:19:57,476] [INFO] [timer.py:260:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=3.296006800913682, CurrSamplesPerSec=3.287374817038403, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:20:03,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=0, lr=[9.998902800212278e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:20:03,560] [INFO] [timer.py:260:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=3.296013040568174, CurrSamplesPerSec=3.2933335636562933, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:20:09,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=0, lr=[9.99889352195067e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:20:09,650] [INFO] [timer.py:260:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=3.296010541357333, CurrSamplesPerSec=3.289447669300361, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:20:15,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=0, lr=[9.998884204628474e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:20:15,748] [INFO] [timer.py:260:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=3.295998218679083, CurrSamplesPerSec=3.2819344325790936, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:20:21,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=0, lr=[9.998874848245762e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:20:21,840] [INFO] [timer.py:260:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=3.2959941226228886, CurrSamplesPerSec=3.3047379447658685, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 85.1693115234375, loss: 4.444634437561035
[2024-05-31 19:23:07,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=0, lr=[9.998865452802607e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:07,269] [INFO] [timer.py:260:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=3.295991036332021, CurrSamplesPerSec=3.2910401765765385, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:13,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=0, lr=[9.998856018299083e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:13,354] [INFO] [timer.py:260:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=3.295999391577318, CurrSamplesPerSec=3.2902514734065127, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:19,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=0, lr=[9.998846544735263e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:19,436] [INFO] [timer.py:260:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=3.2960118549008235, CurrSamplesPerSec=3.2982631900323236, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:25,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=0, lr=[9.998837032111222e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:25,523] [INFO] [timer.py:260:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=3.296017014120161, CurrSamplesPerSec=3.294268631512807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:31,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=0, lr=[9.998827480427034e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:31,607] [INFO] [timer.py:260:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=3.2960198755714565, CurrSamplesPerSec=3.2959577544477274, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:37,687] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=0, lr=[9.998817889682772e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:37,688] [INFO] [timer.py:260:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=3.296032615483868, CurrSamplesPerSec=3.2970511060906915, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:43,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=0, lr=[9.998808259878514e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:43,771] [INFO] [timer.py:260:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=3.2960430316928298, CurrSamplesPerSec=3.3039192402324233, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:49,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=0, lr=[9.998798591014331e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:49,857] [INFO] [timer.py:260:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=3.2960492868449998, CurrSamplesPerSec=3.2982943140788192, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:23:55,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=0, lr=[9.998788883090303e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:23:55,942] [INFO] [timer.py:260:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=3.296053945217788, CurrSamplesPerSec=3.2892645136903553, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:24:02,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=0, lr=[9.998779136106505e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:24:02,026] [INFO] [timer.py:260:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=3.296059804306151, CurrSamplesPerSec=3.3036134690074364, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 84.60118103027344, loss: 4.4379425048828125
[2024-05-31 19:26:47,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=0, lr=[9.99876935006301e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:26:47,381] [INFO] [timer.py:260:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=3.2960494314286737, CurrSamplesPerSec=3.288726773188391, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:26:53,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=0, lr=[9.998759524959898e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:26:53,476] [INFO] [timer.py:260:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=3.2960400471099742, CurrSamplesPerSec=3.2997136757869, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:26:59,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=0, lr=[9.998749660797242e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:26:59,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=3.296049087538131, CurrSamplesPerSec=3.300234241422098, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:05,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=0, lr=[9.998739757575124e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:05,653] [INFO] [timer.py:260:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=3.2960411225987607, CurrSamplesPerSec=3.2925631460617706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:11,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=0, lr=[9.998729815293617e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:11,745] [INFO] [timer.py:260:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=3.296037433114636, CurrSamplesPerSec=3.2771840450052743, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:17,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=0, lr=[9.998719833952802e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:17,834] [INFO] [timer.py:260:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=3.296037732947332, CurrSamplesPerSec=3.2785289117307954, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:23,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=0, lr=[9.998709813552755e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:23,923] [INFO] [timer.py:260:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=3.296038890247544, CurrSamplesPerSec=3.2957466812138376, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:30,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=0, lr=[9.998699754093555e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:30,014] [INFO] [timer.py:260:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=3.296036686844922, CurrSamplesPerSec=3.2955822441178433, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:36,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=0, lr=[9.99868965557528e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:36,103] [INFO] [timer.py:260:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=3.2960368379017684, CurrSamplesPerSec=3.2892103448127132, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:27:42,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=0, lr=[9.998679517998009e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:27:42,194] [INFO] [timer.py:260:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=3.2960369388068385, CurrSamplesPerSec=3.29356243160994, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 83.99098205566406, loss: 4.4307026863098145
[2024-05-31 19:30:27,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=0, lr=[9.998669341361821e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:27,531] [INFO] [timer.py:260:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=3.296031073858756, CurrSamplesPerSec=3.2960419322961587, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:30:33,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=0, lr=[9.998659125666797e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:33,614] [INFO] [timer.py:260:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=3.2960356154973187, CurrSamplesPerSec=3.2991971670178133, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:30:39,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=0, lr=[9.998648870913014e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:39,700] [INFO] [timer.py:260:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=3.2960369197707635, CurrSamplesPerSec=3.296696075926981, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:30:45,786] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=0, lr=[9.998638577100557e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:45,787] [INFO] [timer.py:260:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=3.2960397501037115, CurrSamplesPerSec=3.293193931037948, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:30:51,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=0, lr=[9.998628244229502e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:51,875] [INFO] [timer.py:260:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=3.2960406886961975, CurrSamplesPerSec=3.2925204992430657, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:30:57,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=0, lr=[9.998617872299931e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:30:57,952] [INFO] [timer.py:260:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=3.296052576177396, CurrSamplesPerSec=3.299103745517056, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:31:04,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=0, lr=[9.998607461311924e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:31:04,040] [INFO] [timer.py:260:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=3.2960549509068344, CurrSamplesPerSec=3.286172008529012, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:31:10,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=0, lr=[9.998597011265565e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:31:10,125] [INFO] [timer.py:260:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=3.2960614240581676, CurrSamplesPerSec=3.297244202038656, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:31:16,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=0, lr=[9.998586522160934e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:31:16,216] [INFO] [timer.py:260:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=3.2960572060571853, CurrSamplesPerSec=3.296582067861912, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:31:22,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=0, lr=[9.998575993998115e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:31:22,307] [INFO] [timer.py:260:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=3.296055102699479, CurrSamplesPerSec=3.305656053053747, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 84.25616455078125, loss: 4.4338555335998535
[2024-05-31 19:34:07,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=0, lr=[9.998565426777185e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:07,691] [INFO] [timer.py:260:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=3.2960714007980147, CurrSamplesPerSec=3.303665511176434, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:13,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=0, lr=[9.998554820498233e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:13,776] [INFO] [timer.py:260:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=3.2960765803214502, CurrSamplesPerSec=3.2866895976447883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:19,855] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=0, lr=[9.998544175161336e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:19,855] [INFO] [timer.py:260:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=3.296090250350307, CurrSamplesPerSec=3.296942256598909, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:25,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=0, lr=[9.998533490766583e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:25,942] [INFO] [timer.py:260:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=3.29609473749469, CurrSamplesPerSec=3.2998759292521376, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:32,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=0, lr=[9.998522767314051e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:32,027] [INFO] [timer.py:260:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=3.296099010308873, CurrSamplesPerSec=3.2950553790787005, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:38,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=0, lr=[9.99851200480383e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:38,118] [INFO] [timer.py:260:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=3.2960985199950628, CurrSamplesPerSec=3.2952003472515474, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:44,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=0, lr=[9.998501203236001e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:44,211] [INFO] [timer.py:260:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=3.296093210302573, CurrSamplesPerSec=3.2585799556697435, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:50,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=0, lr=[9.99849036261065e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:50,297] [INFO] [timer.py:260:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=3.2960945290945807, CurrSamplesPerSec=3.2902643787624672, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:34:56,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=0, lr=[9.998479482927858e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:34:56,382] [INFO] [timer.py:260:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=3.2960981508063303, CurrSamplesPerSec=3.283661055854596, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:35:02,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=0, lr=[9.998468564187713e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:35:02,463] [INFO] [timer.py:260:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=3.2961096899436066, CurrSamplesPerSec=3.287552608590519, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 83.1196517944336, loss: 4.420275688171387
[2024-05-31 19:37:47,872] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=0, lr=[9.9984576063903e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:37:47,872] [INFO] [timer.py:260:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=3.296102817339197, CurrSamplesPerSec=3.2944277622999945, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:37:53,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=0, lr=[9.998446609535705e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:37:53,956] [INFO] [timer.py:260:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=3.2961071891141533, CurrSamplesPerSec=3.2970407391627665, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:00,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=0, lr=[9.998435573624015e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:00,042] [INFO] [timer.py:260:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=3.2961124079091615, CurrSamplesPerSec=3.2965885453815935, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:06,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=0, lr=[9.998424498655313e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:06,131] [INFO] [timer.py:260:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=3.2961113455604534, CurrSamplesPerSec=3.2807060906892267, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:12,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=0, lr=[9.998413384629685e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:12,219] [INFO] [timer.py:260:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=3.296112298745616, CurrSamplesPerSec=3.2889782126867413, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:18,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=0, lr=[9.998402231547225e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:18,300] [INFO] [timer.py:260:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=3.296118411751905, CurrSamplesPerSec=3.2951446883195037, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:24,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=0, lr=[9.99839103940801e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:24,381] [INFO] [timer.py:260:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=3.2961256731315536, CurrSamplesPerSec=3.300107005727954, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:30,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=0, lr=[9.998379808212135e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:30,465] [INFO] [timer.py:260:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=3.2961285093587356, CurrSamplesPerSec=3.2964421596497253, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:36,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=0, lr=[9.998368537959686e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:36,572] [INFO] [timer.py:260:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=3.296120990176303, CurrSamplesPerSec=3.292841023595806, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:38:42,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=0, lr=[9.99835722865075e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:38:42,662] [INFO] [timer.py:260:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=3.296120146098509, CurrSamplesPerSec=3.2906386781284103, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.62844848632812, loss: 4.414348602294922
[2024-05-31 19:41:28,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=0, lr=[9.998345880285416e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:28,068] [INFO] [timer.py:260:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=3.296106750379995, CurrSamplesPerSec=3.2906438414737, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:41:34,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=0, lr=[9.998334492863771e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:34,161] [INFO] [timer.py:260:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=3.296102636755615, CurrSamplesPerSec=3.2934757942362856, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:41:40,240] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=0, lr=[9.998323066385906e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:40,240] [INFO] [timer.py:260:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=3.2961138736075886, CurrSamplesPerSec=3.296127409588018, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:41:46,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=0, lr=[9.99831160085191e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:46,326] [INFO] [timer.py:260:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=3.296115264943826, CurrSamplesPerSec=3.301765734107468, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:41:52,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=0, lr=[9.998300096261875e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:52,410] [INFO] [timer.py:260:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=3.296121662478244, CurrSamplesPerSec=3.2960186210768807, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:41:58,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=0, lr=[9.998288552615885e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:41:58,492] [INFO] [timer.py:260:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=3.296128344461099, CurrSamplesPerSec=3.2985705657338436, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:42:04,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=0, lr=[9.998276969914034e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:42:04,581] [INFO] [timer.py:260:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=3.2961273198287917, CurrSamplesPerSec=3.302618477968588, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:42:10,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=0, lr=[9.998265348156413e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:42:10,665] [INFO] [timer.py:260:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=3.2961306884741153, CurrSamplesPerSec=3.2959409193939964, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:42:16,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=0, lr=[9.998253687343112e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:42:16,748] [INFO] [timer.py:260:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=3.2961395686584356, CurrSamplesPerSec=3.3041287587254895, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:42:22,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=0, lr=[9.99824198747422e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:42:22,835] [INFO] [timer.py:260:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=3.2961414145670838, CurrSamplesPerSec=3.2978677064339927, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.17500305175781, loss: 4.408845901489258
saving model ... to step 4000
[2024-05-31 19:45:08,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=0, lr=[9.998230248549832e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:08,735] [INFO] [timer.py:260:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=3.296125533762907, CurrSamplesPerSec=3.3007302946361117, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:14,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=0, lr=[9.998218470570038e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:14,820] [INFO] [timer.py:260:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=3.2961311828517883, CurrSamplesPerSec=3.2973297417003757, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:20,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=0, lr=[9.998206653534928e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:20,905] [INFO] [timer.py:260:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=3.2961349730795395, CurrSamplesPerSec=3.286602033800025, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:26,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=0, lr=[9.998194797444598e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:26,991] [INFO] [timer.py:260:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=3.296136449962178, CurrSamplesPerSec=3.2878012913522356, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:33,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=0, lr=[9.998182902299138e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:33,080] [INFO] [timer.py:260:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=3.296137000976824, CurrSamplesPerSec=3.2926807536191154, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:39,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=0, lr=[9.998170968098645e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:39,169] [INFO] [timer.py:260:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=3.29613636359629, CurrSamplesPerSec=3.2870089876800956, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:45,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=0, lr=[9.998158994843206e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:45,249] [INFO] [timer.py:260:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=3.2961443296433, CurrSamplesPerSec=3.2962828342048254, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:51,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=0, lr=[9.998146982532919e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:51,344] [INFO] [timer.py:260:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=3.296137383624941, CurrSamplesPerSec=3.2954657238263603, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:45:57,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=0, lr=[9.998134931167876e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:45:57,433] [INFO] [timer.py:260:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=3.2961386214298405, CurrSamplesPerSec=3.296278948410765, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:46:03,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=0, lr=[9.998122840748173e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:46:03,522] [INFO] [timer.py:260:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=3.2961408616956667, CurrSamplesPerSec=3.2889279217113105, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 82.19960021972656, loss: 4.409145355224609
[2024-05-31 19:48:48,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=0, lr=[9.998110711273902e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:48:48,972] [INFO] [timer.py:260:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=3.296134425071749, CurrSamplesPerSec=3.293881865486798, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:48:55,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=0, lr=[9.99809854274516e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:48:55,062] [INFO] [timer.py:260:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=3.296134939556484, CurrSamplesPerSec=3.290731620822843, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:01,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=0, lr=[9.99808633516204e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:01,146] [INFO] [timer.py:260:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=3.2961385162388273, CurrSamplesPerSec=3.303045015098484, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:07,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=0, lr=[9.998074088524639e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:07,239] [INFO] [timer.py:260:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=3.2961313720200205, CurrSamplesPerSec=3.2997019941531693, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:13,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=0, lr=[9.998061802833052e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:13,322] [INFO] [timer.py:260:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=3.296136352288579, CurrSamplesPerSec=3.2811411034833977, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:19,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=0, lr=[9.998049478087376e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:19,416] [INFO] [timer.py:260:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=3.2961325873690863, CurrSamplesPerSec=3.291332002195632, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:25,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=0, lr=[9.998037114287707e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:25,505] [INFO] [timer.py:260:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=3.2961346357495724, CurrSamplesPerSec=3.2843462988006036, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:31,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=0, lr=[9.99802471143414e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:31,589] [INFO] [timer.py:260:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=3.2961417073833803, CurrSamplesPerSec=3.2971133090273357, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:37,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=0, lr=[9.998012269526774e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:37,681] [INFO] [timer.py:260:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=3.2961365322147222, CurrSamplesPerSec=3.291273891198089, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:49:43,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=0, lr=[9.997999788565704e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:49:43,773] [INFO] [timer.py:260:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=3.296135841312162, CurrSamplesPerSec=3.2855207474527113, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 81.66374206542969, loss: 4.4026031494140625
[2024-05-31 19:52:29,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=0, lr=[9.997987268551031e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:29,157] [INFO] [timer.py:260:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=3.2961303165857654, CurrSamplesPerSec=3.286058727187188, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:52:35,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=0, lr=[9.997974709482849e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:35,246] [INFO] [timer.py:260:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=3.2961296019386115, CurrSamplesPerSec=3.2972804910500733, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:52:41,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=0, lr=[9.997962111361257e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:41,335] [INFO] [timer.py:260:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=3.2961307546654988, CurrSamplesPerSec=3.288298769760506, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:52:47,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=0, lr=[9.997949474186354e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:47,422] [INFO] [timer.py:260:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=3.2961344204335323, CurrSamplesPerSec=3.2918873885664257, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:52:53,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=0, lr=[9.997936797958242e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:53,510] [INFO] [timer.py:260:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=3.296132960301914, CurrSamplesPerSec=3.28305319037354, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:52:59,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=0, lr=[9.997924082677016e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:52:59,597] [INFO] [timer.py:260:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=3.2961330750165985, CurrSamplesPerSec=3.295623675540529, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:53:05,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=0, lr=[9.997911328342774e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:53:05,687] [INFO] [timer.py:260:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=3.296132225722403, CurrSamplesPerSec=3.298392877434738, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:53:11,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=0, lr=[9.997898534955619e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:53:11,775] [INFO] [timer.py:260:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=3.2961333303870037, CurrSamplesPerSec=3.2938973861198284, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:53:17,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=0, lr=[9.99788570251565e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:53:17,864] [INFO] [timer.py:260:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=3.296131683146132, CurrSamplesPerSec=3.3057107649675226, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:53:23,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=0, lr=[9.997872831022969e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:53:23,950] [INFO] [timer.py:260:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=3.296132536233044, CurrSamplesPerSec=3.2943785983018765, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 81.21552276611328, loss: 4.397101402282715
[2024-05-31 19:56:09,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=0, lr=[9.997859920477672e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:09,290] [INFO] [timer.py:260:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=3.2961279128543834, CurrSamplesPerSec=3.2992283086938277, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:15,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=0, lr=[9.997846970879866e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:15,381] [INFO] [timer.py:260:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=3.2961247716114146, CurrSamplesPerSec=3.290956254011396, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:21,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=0, lr=[9.997833982229646e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:21,466] [INFO] [timer.py:260:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=3.296128733161151, CurrSamplesPerSec=3.299400896138549, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:27,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=0, lr=[9.997820954527118e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:27,559] [INFO] [timer.py:260:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=3.296126491224245, CurrSamplesPerSec=3.286823527844485, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:33,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=0, lr=[9.997807887772381e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:33,647] [INFO] [timer.py:260:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=3.296127090865842, CurrSamplesPerSec=3.294122451736436, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:39,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=0, lr=[9.99779478196554e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:39,734] [INFO] [timer.py:260:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=3.296129563308808, CurrSamplesPerSec=3.2945519726212256, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:45,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=0, lr=[9.997781637106694e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:45,818] [INFO] [timer.py:260:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=3.2961351807672625, CurrSamplesPerSec=3.29234475431461, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:51,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=0, lr=[9.99776845319595e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:51,910] [INFO] [timer.py:260:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=3.2961326348429196, CurrSamplesPerSec=3.2863200584192334, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:56:57,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=0, lr=[9.997755230233406e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:56:57,999] [INFO] [timer.py:260:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=3.296132615555924, CurrSamplesPerSec=3.2953518008412988, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:57:04,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=0, lr=[9.997741968219169e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:57:04,092] [INFO] [timer.py:260:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=3.2961299527605536, CurrSamplesPerSec=3.2839040079672355, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.78878021240234, loss: 4.391831398010254
[2024-05-31 19:59:49,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=0, lr=[9.997728667153338e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:59:49,470] [INFO] [timer.py:260:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=3.2961215576509417, CurrSamplesPerSec=3.2862672738847265, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 19:59:55,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=0, lr=[9.997715327036025e-06], mom=[(0.9, 0.95)]
[2024-05-31 19:59:55,554] [INFO] [timer.py:260:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=3.2961267145255593, CurrSamplesPerSec=3.2971249723392524, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:01,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=0, lr=[9.997701947867326e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:01,642] [INFO] [timer.py:260:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=3.2961293733645447, CurrSamplesPerSec=3.3002108708652, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:07,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=0, lr=[9.997688529647352e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:07,729] [INFO] [timer.py:260:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=3.2961287549274942, CurrSamplesPerSec=3.2976978721012102, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:13,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=0, lr=[9.997675072376203e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:13,814] [INFO] [timer.py:260:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=3.296131827584264, CurrSamplesPerSec=3.2910182271846335, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:19,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=0, lr=[9.997661576053986e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:19,904] [INFO] [timer.py:260:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=3.296128408691159, CurrSamplesPerSec=3.2907768031957607, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:25,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=0, lr=[9.997648040680807e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:25,988] [INFO] [timer.py:260:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=3.296131658234189, CurrSamplesPerSec=3.3008212106068773, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:32,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=0, lr=[9.997634466256772e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:32,077] [INFO] [timer.py:260:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=3.2961294124638845, CurrSamplesPerSec=3.284817006506505, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:38,163] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=0, lr=[9.997620852781986e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:38,164] [INFO] [timer.py:260:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=3.2961299046468637, CurrSamplesPerSec=3.290081132195354, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:00:44,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=0, lr=[9.997607200256554e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:00:44,252] [INFO] [timer.py:260:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=3.2961291236824275, CurrSamplesPerSec=3.2977899175455025, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.646240234375, loss: 4.390067100524902
[2024-05-31 20:03:29,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=0, lr=[9.997593508680586e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:03:29,610] [INFO] [timer.py:260:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=3.2961215096255074, CurrSamplesPerSec=3.2847424044858466, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:03:35,706] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=0, lr=[9.997579778054187e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:03:35,707] [INFO] [timer.py:260:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=3.2961126740218147, CurrSamplesPerSec=3.2884431440067488, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:03:41,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=0, lr=[9.997566008377467e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:03:41,807] [INFO] [timer.py:260:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=3.296099476702052, CurrSamplesPerSec=3.294242758041112, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:03:47,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=0, lr=[9.997552199650529e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:03:47,893] [INFO] [timer.py:260:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=3.2961018359709655, CurrSamplesPerSec=3.300209572510633, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:03:53,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=0, lr=[9.997538351873483e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:03:53,981] [INFO] [timer.py:260:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=3.29610469204052, CurrSamplesPerSec=3.296183101723966, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:04:00,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=0, lr=[9.997524465046437e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:04:00,065] [INFO] [timer.py:260:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=3.296107527910986, CurrSamplesPerSec=3.2962478623880895, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:04:06,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=0, lr=[9.997510539169501e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:04:06,156] [INFO] [timer.py:260:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=3.2961034521485986, CurrSamplesPerSec=3.290722584497144, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:04:12,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=0, lr=[9.997496574242783e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:04:12,238] [INFO] [timer.py:260:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=3.296110021705785, CurrSamplesPerSec=3.297167738522262, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:04:18,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=0, lr=[9.997482570266392e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:04:18,322] [INFO] [timer.py:260:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=3.2961136483163016, CurrSamplesPerSec=3.2954618399585467, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:04:24,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=0, lr=[9.997468527240437e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:04:24,424] [INFO] [timer.py:260:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=3.2961026645788154, CurrSamplesPerSec=3.285958325254175, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.78715515136719, loss: 4.391810417175293
[2024-05-31 20:07:09,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=0, lr=[9.997454445165028e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:09,834] [INFO] [timer.py:260:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=3.2960980074379185, CurrSamplesPerSec=3.3008354978576424, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:15,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=0, lr=[9.997440324040273e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:15,913] [INFO] [timer.py:260:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=3.2961063508707054, CurrSamplesPerSec=3.306040377431959, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:21,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=0, lr=[9.997426163866286e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:21,996] [INFO] [timer.py:260:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=3.296112152536879, CurrSamplesPerSec=3.2929470171508965, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:28,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=0, lr=[9.997411964643176e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:28,081] [INFO] [timer.py:260:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=3.296117692685189, CurrSamplesPerSec=3.2913087575503734, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:34,163] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=0, lr=[9.997397726371054e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:34,163] [INFO] [timer.py:260:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=3.2961242425068336, CurrSamplesPerSec=3.290873626744374, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:40,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=0, lr=[9.997383449050031e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:40,261] [INFO] [timer.py:260:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=3.296116587190618, CurrSamplesPerSec=3.2949583093077006, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:46,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=0, lr=[9.997369132680219e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:46,345] [INFO] [timer.py:260:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=3.2961229012831343, CurrSamplesPerSec=3.294073296850359, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:52,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=0, lr=[9.99735477726173e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:52,427] [INFO] [timer.py:260:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=3.2961302778445876, CurrSamplesPerSec=3.290179205283987, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:07:58,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=0, lr=[9.997340382794676e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:07:58,515] [INFO] [timer.py:260:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=3.2961319235359543, CurrSamplesPerSec=3.2925631460617706, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:08:04,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=0, lr=[9.997325949279168e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:08:04,600] [INFO] [timer.py:260:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=3.2961376108778144, CurrSamplesPerSec=3.3002926692624883, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 80.1128921508789, loss: 4.383429527282715
[2024-05-31 20:10:49,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=0, lr=[9.997311476715322e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:10:49,927] [INFO] [timer.py:260:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=3.296131545911438, CurrSamplesPerSec=3.30012777823238, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:10:56,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=0, lr=[9.997296965103247e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:10:56,014] [INFO] [timer.py:260:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=3.2961334057481215, CurrSamplesPerSec=3.2864011696671644, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:02,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=0, lr=[9.99728241444306e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:02,098] [INFO] [timer.py:260:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=3.296138070729106, CurrSamplesPerSec=3.296382572721071, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:08,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=0, lr=[9.997267824734872e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:08,184] [INFO] [timer.py:260:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=3.296140469054684, CurrSamplesPerSec=3.2919468130903873, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:14,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=0, lr=[9.9972531959788e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:14,269] [INFO] [timer.py:260:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=3.296142148327964, CurrSamplesPerSec=3.294232408766233, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:20,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=0, lr=[9.997238528174955e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:20,355] [INFO] [timer.py:260:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=3.296144771632847, CurrSamplesPerSec=3.2930362121365575, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:26,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=0, lr=[9.997223821323454e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:26,443] [INFO] [timer.py:260:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=3.2961432520902427, CurrSamplesPerSec=3.2992373917934077, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:32,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=0, lr=[9.997209075424412e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:32,530] [INFO] [timer.py:260:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=3.296146228046621, CurrSamplesPerSec=3.298949352134566, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:38,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=0, lr=[9.997194290477942e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:38,614] [INFO] [timer.py:260:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=3.2961492813839444, CurrSamplesPerSec=3.294879363444651, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:11:44,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=0, lr=[9.997179466484162e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:11:44,700] [INFO] [timer.py:260:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=3.2961503352551422, CurrSamplesPerSec=3.289245167457811, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
ppl: 79.7759780883789, loss: 4.379216194152832
[2024-05-31 20:14:30,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=0, lr=[9.997164603443185e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:14:30,222] [INFO] [timer.py:260:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=3.2961470512867916, CurrSamplesPerSec=3.298518683959697, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:14:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=0, lr=[9.997149701355129e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:14:36,312] [INFO] [timer.py:260:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=3.2961470661643046, CurrSamplesPerSec=3.3009407077856103, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:14:42,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=0, lr=[9.997134760220111e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:14:42,405] [INFO] [timer.py:260:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=3.2961394650949254, CurrSamplesPerSec=3.2944562263380304, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:14:48,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=0, lr=[9.997119780038247e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:14:48,499] [INFO] [timer.py:260:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=3.296136292244316, CurrSamplesPerSec=3.2993502859190333, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:14:54,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=0, lr=[9.997104760809652e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:14:54,584] [INFO] [timer.py:260:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=3.2961373200880173, CurrSamplesPerSec=3.293064652133428, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:15:00,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=0, lr=[9.997089702534449e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:15:00,677] [INFO] [timer.py:260:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=3.2961322686515424, CurrSamplesPerSec=3.297216985804285, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:15:06,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=0, lr=[9.99707460521275e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:15:06,766] [INFO] [timer.py:260:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=3.2961315020142314, CurrSamplesPerSec=3.2877832509226135, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:15:12,855] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=0, lr=[9.997059468844675e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:15:12,856] [INFO] [timer.py:260:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=3.296130869946848, CurrSamplesPerSec=3.2807035245843297, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:15:18,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=0, lr=[9.997044293430343e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:15:18,950] [INFO] [timer.py:260:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=3.2961276729622626, CurrSamplesPerSec=3.29264198096859, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
[2024-05-31 20:15:25,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=0, lr=[9.997029078969871e-06], mom=[(0.9, 0.95)]
[2024-05-31 20:15:25,040] [INFO] [timer.py:260:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=3.2961251622581, CurrSamplesPerSec=3.298769028581361, MemAllocated=6.65GB, MaxMemAllocated=18.4GB
evaluating model ...
***** Evaluating perplexity, Epoch 1/50 *****
[2024-05-31 20:17:23,276] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1475670
[2024-05-31 20:17:23,277] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 1475671
[2024-05-31 20:17:23,514] [ERROR] [launch.py:325:sigkill_handler] ['/home/chanho/anaconda3/envs/COMEDY/bin/python', '-u', 'training/EPISODE/main.py', '--local_rank=1', '--model_name', 'gemma', '--model_name_or_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path', '--train_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--valid_data_path', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/valid_without_tag.json', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--data_output_path', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/data', '--max_seq_len', '2048', '--learning_rate', '1e-5', '--weight_decay', '0.1', '--num_train_epochs', '50', '--num_train_samples', '14255', '/home/chanho/Model/SHARE/Refactorizing/result/dataset/train_without_tag.json', '--gradient_accumulation_steps', '1', '--lr_scheduler_type', 'cosine', '--num_warmup_steps', '1000', '--seed', '42', '--zero_stage', '2', '--save_interval', '1000', '--eval_interval', '100', '--output_dir', '/home/chanho/Model/SHARE/Refactorizing/result/output_path/2024-05-31-17.17.55'] exits with return code = -9
